<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lecture 7 Game theory and replicator dynamics | Theoretical Community Ecology</title>
  <meta name="description" content="A graduate course in theoretical community ecology focusing on systems with multiple species." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Lecture 7 Game theory and replicator dynamics | Theoretical Community Ecology" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A graduate course in theoretical community ecology focusing on systems with multiple species." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lecture 7 Game theory and replicator dynamics | Theoretical Community Ecology" />
  
  <meta name="twitter:description" content="A graduate course in theoretical community ecology focusing on systems with multiple species." />
  

<meta name="author" content="Stefano Allesina" />


<meta name="date" content="2022-05-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="predicting-coexistence-in-ecological-communities.html"/>
<link rel="next" href="metapopulation-dynamics-on-networks.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Theoretical Community Ecology</a></li>

<li class="divider"></li>
<li><a href="index.html#preliminaries">Preliminaries<span></span></a>
<ul>
<li><a href="index.html#approach-and-target-audience">Approach and target audience<span></span></a></li>
<li><a href="index.html#topics">Topics<span></span></a></li>
<li><a href="index.html#notation">Notation<span></span></a></li>
<li><a href="index.html#grading-and-code-of-conduct">Grading and code of conduct<span></span></a>
<ul>
<li><a href="index.html#homework-80">Homework (80%)<span></span></a></li>
<li><a href="index.html#review-20">Review (20%)<span></span></a></li>
<li><a href="index.html#accommodation-for-students-with-disabilities">Accommodation for students with disabilities<span></span></a></li>
</ul></li>
<li><a href="index.html#a-note-about-biographies">A note about biographies<span></span></a></li>
<li><a href="index.html#sources">Sources<span></span></a></li>
<li><a href="index.html#acknowledgements">Acknowledgements<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html"><i class="fa fa-check"></i><b>1</b> Models for a single population<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#types-of-dynamical-systems"><i class="fa fa-check"></i><b>1.1</b> Types of dynamical systems<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#initial-value-problems"><i class="fa fa-check"></i><b>1.2</b> Initial-value problems<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#solvable-model-exponential-growth"><i class="fa fa-check"></i><b>1.3</b> Solvable model: Exponential growth<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#solvable-model-logistic-growth"><i class="fa fa-check"></i><b>1.4</b> Solvable model: Logistic growth<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#qualitative-analysis-of-models-for-a-single-population"><i class="fa fa-check"></i><b>1.5</b> Qualitative analysis of models for a single population<span></span></a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#stability-using-derivatives"><i class="fa fa-check"></i><b>1.5.1</b> Stability using derivatives<span></span></a></li>
<li class="chapter" data-level="1.5.2" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#what-are-we-doing-when-probing-stability-using-derivatives"><i class="fa fa-check"></i><b>1.5.2</b> What are we doing when probing stability using derivatives?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#bifurcations"><i class="fa fa-check"></i><b>1.6</b> Bifurcations<span></span></a></li>
<li class="chapter" data-level="1.7" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#long-term-behavior-of-1-d-systems"><i class="fa fa-check"></i><b>1.7</b> Long term behavior of 1-D systems<span></span></a></li>
<li class="chapter" data-level="1.8" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#lyapunov-functions"><i class="fa fa-check"></i><b>1.8</b> Lyapunov functions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html"><i class="fa fa-check"></i><b>2</b> Models for two populations<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#qualitative-analysis-of-models-for-two-populations"><i class="fa fa-check"></i><b>2.1</b> Qualitative analysis of models for two populations<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#isoclines-of-null-growth"><i class="fa fa-check"></i><b>2.1.1</b> Isoclines of null growth<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#local-stability-analysis"><i class="fa fa-check"></i><b>2.2</b> Local stability analysis<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#stability-analysis-of-the-lotka-volterra-predator-prey-model"><i class="fa fa-check"></i><b>2.3</b> Stability analysis of the Lotka-Volterra Predator-Prey model<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#constant-of-motion-for-lotka-volterra-predator-prey"><i class="fa fa-check"></i><b>2.3.1</b> Constant of motion for Lotka-Volterra Predator-Prey<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#analysis-of-predator-prey-model-with-logistic-growth-for-the-prey"><i class="fa fa-check"></i><b>2.3.2</b> Analysis of Predator-Prey model with logistic growth for the prey<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html"><i class="fa fa-check"></i><b>3</b> Generalized Lotka-Volterra model<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#formulation"><i class="fa fa-check"></i><b>3.1</b> Formulation<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#a-single-population"><i class="fa fa-check"></i><b>3.2</b> A single population<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#metapopulation-dynamics"><i class="fa fa-check"></i><b>3.2.1</b> Metapopulation dynamics<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#s-i-s-model"><i class="fa fa-check"></i><b>3.2.2</b> S-I-S model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#multi-species-dynamics"><i class="fa fa-check"></i><b>3.3</b> Multi-species dynamics<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#existence-of-an-equilibrium"><i class="fa fa-check"></i><b>3.3.1</b> Existence of an equilibrium<span></span></a></li>
<li class="chapter" data-level="3.3.2" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#stability-of-the-coexistence-equilibrium"><i class="fa fa-check"></i><b>3.3.2</b> Stability of the coexistence equilibrium<span></span></a></li>
<li class="chapter" data-level="3.3.3" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#types-of-dynamics"><i class="fa fa-check"></i><b>3.3.3</b> Types of dynamics<span></span></a></li>
<li class="chapter" data-level="3.3.4" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#the-equilibrium-is-the-time-average"><i class="fa fa-check"></i><b>3.3.4</b> The equilibrium is the time-average<span></span></a></li>
<li class="chapter" data-level="3.3.5" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#lyapunov-diagonal-stability-and-global-stability"><i class="fa fa-check"></i><b>3.3.5</b> Lyapunov diagonal stability and global stability<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#macarthurs-consumer-resource-model"><i class="fa fa-check"></i><b>3.4</b> MacArthur’s consumer-resource model<span></span></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#existence-of-an-equilibrium-1"><i class="fa fa-check"></i><b>3.4.1</b> Existence of an equilibrium<span></span></a></li>
<li class="chapter" data-level="3.4.2" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#global-stability-1"><i class="fa fa-check"></i><b>3.4.2</b> Global stability<span></span></a></li>
<li class="chapter" data-level="3.4.3" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#separation-of-time-scales"><i class="fa fa-check"></i><b>3.4.3</b> Separation of time-scales<span></span></a></li>
<li class="chapter" data-level="3.4.4" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#lyapunov-function-for-symmetric-lotka-volterra"><i class="fa fa-check"></i><b>3.4.4</b> Lyapunov function for symmetric Lotka-Volterra<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#further-readings"><i class="fa fa-check"></i><b>3.5</b> Further readings<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html"><i class="fa fa-check"></i><b>4</b> Stability of large ecological communities<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#complexity-and-stability"><i class="fa fa-check"></i><b>4.1</b> Complexity and stability<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#the-stability-of-random-ecosystems"><i class="fa fa-check"></i><b>4.2</b> The stability of random ecosystems<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#accounting-for-interaction-types"><i class="fa fa-check"></i><b>4.3</b> Accounting for interaction types<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#symmetric-matrices"><i class="fa fa-check"></i><b>4.4</b> Symmetric matrices<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#covariance-matrices"><i class="fa fa-check"></i><b>4.5</b> Covariance matrices<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#small-rank-perturbations"><i class="fa fa-check"></i><b>4.6</b> Small-rank perturbations<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#structured-matrices"><i class="fa fa-check"></i><b>4.7</b> Structured matrices<span></span></a></li>
<li class="chapter" data-level="4.8" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#further-readings-1"><i class="fa fa-check"></i><b>4.8</b> Further readings<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ecological-assembly.html"><a href="ecological-assembly.html"><i class="fa fa-check"></i><b>5</b> Ecological assembly<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="ecological-assembly.html"><a href="ecological-assembly.html#assembly"><i class="fa fa-check"></i><b>5.1</b> Assembly<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ecological-assembly.html"><a href="ecological-assembly.html#what-makes-the-study-of-assembly-difficult"><i class="fa fa-check"></i><b>5.1.1</b> What makes the study of assembly difficult?<span></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="ecological-assembly.html"><a href="ecological-assembly.html#ecological-assembly-without-tears"><i class="fa fa-check"></i><b>5.1.2</b> Ecological assembly without tears<span></span></a></li>
<li class="chapter" data-level="5.1.3" data-path="ecological-assembly.html"><a href="ecological-assembly.html#top-down-and-bottom-up-assembly"><i class="fa fa-check"></i><b>5.1.3</b> Top-down and bottom-up assembly<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ecological-assembly.html"><a href="ecological-assembly.html#modeling-invasions"><i class="fa fa-check"></i><b>5.2</b> Modeling invasions<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ecological-assembly.html"><a href="ecological-assembly.html#invasions-in-multispecies-communities"><i class="fa fa-check"></i><b>5.2.1</b> Invasions in multispecies communities<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="ecological-assembly.html"><a href="ecological-assembly.html#lyapunov-stability-and-saturated-equilibria"><i class="fa fa-check"></i><b>5.2.2</b> Lyapunov stability and saturated equilibria<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ecological-assembly.html"><a href="ecological-assembly.html#top-down-assembly"><i class="fa fa-check"></i><b>5.3</b> Top-down assembly<span></span></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ecological-assembly.html"><a href="ecological-assembly.html#a-trivial-case"><i class="fa fa-check"></i><b>5.3.1</b> A trivial case<span></span></a></li>
<li class="chapter" data-level="5.3.2" data-path="ecological-assembly.html"><a href="ecological-assembly.html#simulating-final-composition"><i class="fa fa-check"></i><b>5.3.2</b> Simulating final composition<span></span></a></li>
<li class="chapter" data-level="5.3.3" data-path="ecological-assembly.html"><a href="ecological-assembly.html#a-random-zoo"><i class="fa fa-check"></i><b>5.3.3</b> A random zoo<span></span></a></li>
<li class="chapter" data-level="5.3.4" data-path="ecological-assembly.html"><a href="ecological-assembly.html#a-random-zoo-in-the-wild"><i class="fa fa-check"></i><b>5.3.4</b> A random zoo in the wild<span></span></a></li>
<li class="chapter" data-level="5.3.5" data-path="ecological-assembly.html"><a href="ecological-assembly.html#assembly-and-saturated-equilibrium"><i class="fa fa-check"></i><b>5.3.5</b> Assembly and saturated equilibrium<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ecological-assembly.html"><a href="ecological-assembly.html#network-spandrels"><i class="fa fa-check"></i><b>5.4</b> Network spandrels<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="ecological-assembly.html"><a href="ecological-assembly.html#bottom-up-assembly"><i class="fa fa-check"></i><b>5.5</b> Bottom-up assembly<span></span></a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="ecological-assembly.html"><a href="ecological-assembly.html#an-assembly-graph"><i class="fa fa-check"></i><b>5.5.1</b> An assembly graph<span></span></a></li>
<li class="chapter" data-level="5.5.2" data-path="ecological-assembly.html"><a href="ecological-assembly.html#how-many-invasions"><i class="fa fa-check"></i><b>5.5.2</b> How many invasions?<span></span></a></li>
<li class="chapter" data-level="5.5.3" data-path="ecological-assembly.html"><a href="ecological-assembly.html#properties-of-the-assembly-graph"><i class="fa fa-check"></i><b>5.5.3</b> Properties of the assembly graph<span></span></a></li>
<li class="chapter" data-level="5.5.4" data-path="ecological-assembly.html"><a href="ecological-assembly.html#assembly-graphs-for-glv"><i class="fa fa-check"></i><b>5.5.4</b> Assembly graphs for GLV<span></span></a></li>
<li class="chapter" data-level="5.5.5" data-path="ecological-assembly.html"><a href="ecological-assembly.html#relationship-with-lyapunov-functions"><i class="fa fa-check"></i><b>5.5.5</b> Relationship with Lyapunov functions<span></span></a></li>
<li class="chapter" data-level="5.5.6" data-path="ecological-assembly.html"><a href="ecological-assembly.html#how-many-assembly-endpoints"><i class="fa fa-check"></i><b>5.5.6</b> How many assembly endpoints?<span></span></a></li>
<li class="chapter" data-level="5.5.7" data-path="ecological-assembly.html"><a href="ecological-assembly.html#build-your-own-assembly-graph"><i class="fa fa-check"></i><b>5.5.7</b> Build your own assembly graph!<span></span></a></li>
<li class="chapter" data-level="5.5.8" data-path="ecological-assembly.html"><a href="ecological-assembly.html#conclusions"><i class="fa fa-check"></i><b>5.5.8</b> Conclusions<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html"><i class="fa fa-check"></i><b>6</b> Predicting coexistence in ecological communities<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#background-diversity-and-ecosystem-functioning"><i class="fa fa-check"></i><b>6.1</b> Background: Diversity and Ecosystem Functioning<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#synthetic-communities-using-the-glv-model"><i class="fa fa-check"></i><b>6.2</b> Synthetic communities using the GLV model<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#total-biomass"><i class="fa fa-check"></i><b>6.3</b> Total biomass<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#hyperplanes"><i class="fa fa-check"></i><b>6.4</b> Hyperplanes<span></span></a></li>
<li class="chapter" data-level="6.5" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#fitting-real-data"><i class="fa fa-check"></i><b>6.5</b> Fitting real data<span></span></a></li>
<li class="chapter" data-level="6.6" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#predicting-real-data-out-of-fit"><i class="fa fa-check"></i><b>6.6</b> Predicting real data out of fit<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html"><i class="fa fa-check"></i><b>7</b> Game theory and replicator dynamics<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#game-theory"><i class="fa fa-check"></i><b>7.1</b> Game theory<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#two-player-matrix-games"><i class="fa fa-check"></i><b>7.2</b> Two-player matrix games<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#example-the-prisoners-dilemma"><i class="fa fa-check"></i><b>7.2.1</b> Example: the prisoner’s dilemma<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#mixed-strategies"><i class="fa fa-check"></i><b>7.3</b> Mixed strategies<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#nash-equilibria"><i class="fa fa-check"></i><b>7.4</b> Nash Equilibria<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#evolutionary-stable-strategies"><i class="fa fa-check"></i><b>7.5</b> Evolutionary stable strategies<span></span></a></li>
<li class="chapter" data-level="7.6" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#replicator-dynamics"><i class="fa fa-check"></i><b>7.6</b> Replicator dynamics<span></span></a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#invariants"><i class="fa fa-check"></i><b>7.6.1</b> Invariants<span></span></a></li>
<li class="chapter" data-level="7.6.2" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#rock-paper-scissor"><i class="fa fa-check"></i><b>7.6.2</b> Rock-paper-scissor<span></span></a></li>
<li class="chapter" data-level="7.6.3" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#equivalence-with-glv"><i class="fa fa-check"></i><b>7.6.3</b> Equivalence with GLV<span></span></a></li>
<li class="chapter" data-level="7.6.4" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#hypertournament-games"><i class="fa fa-check"></i><b>7.6.4</b> Hypertournament games<span></span></a></li>
<li class="chapter" data-level="7.6.5" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#lyapunov-function"><i class="fa fa-check"></i><b>7.6.5</b> Lyapunov function<span></span></a></li>
<li class="chapter" data-level="7.6.6" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#higher-order-interactions"><i class="fa fa-check"></i><b>7.6.6</b> Higher-order interactions<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html"><i class="fa fa-check"></i><b>8</b> Metapopulation dynamics on networks<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#metapopulations"><i class="fa fa-check"></i><b>8.1</b> Metapopulations<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#hanski-ovaskainen-2000"><i class="fa fa-check"></i><b>8.2</b> Hanski Ovaskainen 2000<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#sis-on-a-contact-network"><i class="fa fa-check"></i><b>8.3</b> SIS on a contact network<span></span></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#the-full-model"><i class="fa fa-check"></i><b>8.3.1</b> The full model<span></span></a></li>
<li class="chapter" data-level="8.3.2" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#the-mean-field-approximation"><i class="fa fa-check"></i><b>8.3.2</b> The mean-field approximation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#metapopulations-on-randomly-distributed-patches"><i class="fa fa-check"></i><b>8.4</b> Metapopulations on randomly distributed patches<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html"><i class="fa fa-check"></i><b>9</b> Quasi-polynomial systems<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#global-stability-2"><i class="fa fa-check"></i><b>9.1</b> Global stability<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#from-qp-to-glv"><i class="fa fa-check"></i><b>9.2</b> From QP to GLV<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#stability-of-glv"><i class="fa fa-check"></i><b>9.3</b> Stability of GLV<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#stability-for-glv-embeddings"><i class="fa fa-check"></i><b>9.4</b> Stability for GLV embeddings<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#numerical-analysis"><i class="fa fa-check"></i><b>9.5</b> Numerical analysis<span></span></a></li>
<li class="chapter" data-level="9.6" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#systems-with-many-equations"><i class="fa fa-check"></i><b>9.6</b> Systems with many equations<span></span></a></li>
<li class="chapter" data-level="9.7" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#glv-embedding-for-non-qp-systems"><i class="fa fa-check"></i><b>9.7</b> GLV embedding for non-QP systems<span></span></a></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Theoretical Community Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="game-theory-and-replicator-dynamics" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Lecture 7</span> Game theory and replicator dynamics<a href="game-theory-and-replicator-dynamics.html#game-theory-and-replicator-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="game-theory" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Game theory<a href="game-theory-and-replicator-dynamics.html#game-theory" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We briefly introduce the study of mathematical models of games, and their relations to the GLV model. While the origin of game theory can be traced back to the 1700s, modern game theory started with von Neumann’s paper <em>On the Theory of Games of Strategy</em>, published in 1928, and with the subsequent 1944 book with Morgensten <em>Theory of Games and Economic Behavior</em>. John Nash’s paper <span class="citation">(<a href="#ref-nash1950equilibrium" role="doc-biblioref">Nash 1950</a>)</span> introduced the notion of a <strong>Nash Equilibrium</strong> (NE), and proved that any non-cooperative game has at least one such equilibrium. Originally, game theory was studied by economists and mathematicians, but with a series of papers in the early 1970s, and the subsequent book <em>Evolution and the Theory of Games</em> <span class="citation">(<a href="#ref-smith1982evolution" role="doc-biblioref">Maynard Smith 1982</a>)</span>, John Maynard Smith showed how the same tools could be used to study evolutionary dynamics, introducing the influential concept of an <strong>Evolutionary Stable Strategy</strong> (ESS). Evolutionary game theory was greatly advanced through the introduction of the <strong>Replicator Equation</strong> (RE), which, as we will see later, has strong connection with the GLV model. For a detailaed introduction to evolutionary game theory see <span class="citation">Hofbauer and Sigmund (<a href="#ref-hofbauer1998evolutionary" role="doc-biblioref">1998</a>)</span>.</p>
<div class="boxhistory">
<p><strong>History: John Maynard Smith (1920-2004)</strong></p>
<p><img src="img/Maynard_Smith.jpg" width="35%" style="display: block; margin: auto;" /></p>
<p>Born in London, when he was at Eaton he decided to study (independently) the work of JBS Haldane. He set out to Cambridge to study engineering, and subsequently worked as an engineer designing military aircrafts. In 1947, he had a change of hearth and decided to study <em>Drosophila</em> genetics at U.C.L. under Haldane. In 1973, based on his interaction with George Price, he formalized the concept of “Evolutionarily Stable Strategy”, which became central to evolutionary game theory. His book <em>Evolution and the Theory of Games</em> (1982) was an immediate success and contributed to the birth of the field.</p>
</div>
<div class="boxhistory">
<p><strong>History: George R. Price (1922-1975)</strong></p>
<p><img src="img/Price.jpg" width="35%" style="display: block; margin: auto;" /></p>
<p>One of the most remarkable characters in the history of biology, he was born in New York. He studied chemistry at U. Chicago, receiving a Ph.D. in 1946 (for work connected to the Manhattan Project). He went on to take a variery of jobs: teaching chemistry at Harvard, consulting at Argonne, researching at Bell Lab, writing popular science, working on medical research at U. Minnesota, and consulting for IBM on computer graphics.</p>
<p>In 1966, he was operated for a tumor, and the operation resulted in a partial paralysis. With the money from his medical insurance, he moved to the UK to start a new life.</p>
<p>Without any training in population genetics or statistics, he devised the Price equation, based on his readings of Hamilton’s papers on kin selection. This feat landed him a job at Galton Lab at UCL, despite his lack of credentials. His collaborations with Hamilton and Maynard-Smith led to the development of evolutionary game theory.</p>
<p>A strong atheist from an early age, in 1970 Price had a religious experience, converted to Christianity and started (inspired by his own equation) to perform acts of random kindness to complete strangers. Having given up all his possessions, and possibly due to his stopping of thyroid treatment, Price grew depressed and committed suicide in 1975.</p>
<p>The book <em>The Price of Altruism: George Price and the Search for the Origins of Kindness</em> (Oren Harman, 2010) narrates the incredible story of his life.</p>
</div>
</div>
<div id="two-player-matrix-games" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Two-player matrix games<a href="game-theory-and-replicator-dynamics.html#two-player-matrix-games" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We start by anayzing games in which two players face each other, each choosing one strategy out of a set. Importantly, we consider static games in which each player makes their decision without having knowledge of the decision of the other player. Player 1 chooses a <strong>pure strategy</strong> <span class="math inline">\(s_1\)</span> from the set of pure strategies <span class="math inline">\(S_1\)</span>, while player 2 chooses <span class="math inline">\(s_2 \in S_2\)</span>. We call <span class="math inline">\(\pi_k (s_1, s_2)\)</span> the <strong>payoff</strong> for player <span class="math inline">\(k\)</span> when player 1 chooses <span class="math inline">\(s_1\)</span> and player 2 <span class="math inline">\(s_2\)</span>. In a matrix game, we can arrange the payoffs for each player in a matrix. We call <span class="math inline">\(A\)</span> the matrix of payoffs for player one and <span class="math inline">\(B\)</span> that for player two.</p>
<div id="example-the-prisoners-dilemma" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Example: the prisoner’s dilemma<a href="game-theory-and-replicator-dynamics.html#example-the-prisoners-dilemma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Two prisoners allegedly committed a crime, but the police do not have enough evidence to convict them. They therefore approach each prisoner separately, proposing a deal: if the prisoner confesses (“defect” the other prisoner), then their sentence will be reduced. In particular: i) if both confess (both “defect”), they are sentenced to 4 years in prison; ii) if one confesses (“defect”) and the other keeps quiet (“cooperate” with the other prisoner), then the one who has confessed is let free, and the other sentenced to 5 years; iii) if both keep quiet (“cooperate”), then they are both sentenced to two years of detention for some accessory crime.</p>
<p>In matrix form, we have (rows for pl 1 strategy C/D; cols for pl 2 strategy):</p>
<p><span class="math display">\[
A = \begin{pmatrix}
-2 &amp; -5\\
0 &amp; -4
\end{pmatrix} \quad
B = \begin{pmatrix}
-2 &amp; -5\\
0 &amp; -4
\end{pmatrix}
\]</span></p>
<p>What is the best strategy player 1 can play—without knowing whether player 2 will confess or not? If player 2 were to keep quiet, player 1 should confess and be let free; if player 2 confesses, on the other hand, player 1 should also confess and get a reduced sentence. As such, each player would rationally choose to confess, thereby getting sentenced to four years in prison; note that if they could trust the other player, they could cooperate to get a much reduced sentence.</p>
<p>The defect/defect is called a <strong>Nash Equilibrium</strong>: no player can improve their payoff by changing only their own strategy.</p>
<div class="boxpaper">
<p>One of the most interesting problems in this area is the study of the evolution of cooperation. Here is a very minimal bibliography:</p>
<p><strong>Key paper: <span class="citation">Axelrod and Hamilton (<a href="#ref-axelrod1981evolution" role="doc-biblioref">1981</a>)</span></strong></p>
<p>The seminal paper in this area. Interestingly, it details the outcome of a computer-based tournament in which several programs iteratively play the prisoner’s dilemma against each other.</p>
<p><strong>Key paper: <span class="citation">Clutton-Brock (<a href="#ref-clutton2009cooperation" role="doc-biblioref">2009</a>)</span></strong></p>
<p>An opinionated review on cooperation between non-kin in animal societies. The opening <em>“As Darwin appreciated, cooperative behaviour—actions adapted to assist others that involve costs to the fitness of participants—poses a fundamental problem to the traditional theory of natural selection”</em> succinlty summarizes why the evolution of cooperation is such a central problem in biology.</p>
<p><strong>Key paper: <span class="citation">Nowak and May (<a href="#ref-nowak1992evolutionary" role="doc-biblioref">1992</a>)</span></strong></p>
<p>Nowak and May examine the case in which populations of “cooperators” and “defectors” play the prisoner’s dilemma in a spatial setting. Despite the simple setting and the deterministic nature of the simulation, they find long-term coexistence of the different populations, giving rise to amazing spatial patterns.</p>
<p><strong>Key paper: <span class="citation">Nowak and Sigmund (<a href="#ref-nowak2005evolution" role="doc-biblioref">2005</a>)</span></strong></p>
<p>Cooperation can evolve via indirect reciprocity (I help you in the hope that someone will help me) when players have a “reputation” to defend.</p>
</div>
</div>
</div>
<div id="mixed-strategies" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Mixed strategies<a href="game-theory-and-replicator-dynamics.html#mixed-strategies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Above, the player could choose one out of two strategies. A generalization of this situation is one in which players play <strong>mixed strategies</strong>, i.e., play a given strategy at random according to a set of probabilities. Call <span class="math inline">\(x_i\)</span> the probability that player 1 plays strategy <span class="math inline">\(i\)</span>; then <span class="math inline">\(x_i \geq 0\)</span>, and <span class="math inline">\(\sum_i x_i = 1\)</span>. Similarly, <span class="math inline">\(y_i\)</span> is the probability that player 2 plays strategy <span class="math inline">\(i\)</span>. A natural choice for the payoff of player 1 is therefore:</p>
<p><span class="math display">\[
\sum_{i=1}^m \sum_{j = 1}^n x_i y_j \pi_1 (s_i, s_j) = x^T A y
\]</span></p>
<p>which amounts to the expected payoff for player 1. Similarly, we have <span class="math inline">\(y^T B x\)</span> for player 2.</p>
<p>A mixed strategy <span class="math inline">\(x\)</span> is dominated by mixed strategy <span class="math inline">\(\tilde{x}\)</span> if <span class="math inline">\(\tilde{x}^T A y \geq x^T A y\)</span> for every <span class="math inline">\(y\)</span>. The condition can be written as <span class="math inline">\((\tilde{x} - x)^T A y \geq 0\)</span>.</p>
</div>
<div id="nash-equilibria" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Nash Equilibria<a href="game-theory-and-replicator-dynamics.html#nash-equilibria" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A pair of mixed strategies <span class="math inline">\(\tilde{x}\)</span> and <span class="math inline">\(\tilde{y}\)</span> is called a Nash Equilibrium for a two person matrix game if:</p>
<p><span class="math display">\[
\begin{aligned}
\tilde{x}^T A \tilde{y} \geq x^T A \tilde{y} &amp;\quad \text{for all } x\\
\tilde{y}^T B \tilde{x} \geq y^T B \tilde{x} &amp;\quad \text{for all } y
\end{aligned}
\]</span></p>
<p>Nash proved that every non-cooperative game has at least one Nash Equilibrium.</p>
</div>
<div id="evolutionary-stable-strategies" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Evolutionary stable strategies<a href="game-theory-and-replicator-dynamics.html#evolutionary-stable-strategies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the context of evolution, one can consider <span class="math inline">\(x\)</span> to be the proportion of individuals (e.g., of different species, or phenotypes) displaying different characteristics. When playing against each other, they win or lose, and their payoffs are invested in reproduction. Because the different “strategies” (populations, phenotypes) play against each other, the payoff matrix is the same for all players, and encoded in matrix <span class="math inline">\(A\)</span>.</p>
<p>In this context, a strategy <span class="math inline">\(x\)</span> is called an evolutionary stable strategy if two conditions are met:</p>
<p><span class="math display">\[
x^T A x \geq y^T A x \quad \text{for all } y
\]</span></p>
<p>meaning that <span class="math inline">\(x\)</span> plays against itself not worse than any other strategy, and</p>
<p><span class="math display">\[
\text{If } y \neq x \text{ then } y^T A x = x^T A x \text{ implies } x^T A y &gt; y^T A y
\]</span></p>
<p>meaning that if <span class="math inline">\(y\)</span> plays as well as <span class="math inline">\(x\)</span> against <span class="math inline">\(x\)</span>, then <span class="math inline">\(x\)</span> plays against <span class="math inline">\(y\)</span> better than <span class="math inline">\(y\)</span> against itself.</p>
<p>Next, we connect NE and ESS with dynamical systems.</p>
</div>
<div id="replicator-dynamics" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Replicator dynamics<a href="game-theory-and-replicator-dynamics.html#replicator-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The replicator equation for this type of games can be written as:</p>
<p><span class="math display">\[
\dfrac{d x_i}{dt} = x_i \left( \sum_j A_{ij} x_j - \sum_{jk} x_j A_{jk} x_k \right)
\]</span></p>
<p>If we define <span class="math inline">\(f = A x\)</span> as a vector reporting the “fitness” of each population at time <span class="math inline">\(t\)</span>, and <span class="math inline">\(\bar{f} = \sum_{jk} x_j A_{jk} x_k = x^T A x\)</span> as the average fitness at time <span class="math inline">\(t\)</span> we can write the replicator equation more compactly as:</p>
<p><span class="math display">\[
\dfrac{d x_i}{dt} = x_i (f_i - \bar{f})
\]</span></p>
<p>The RE is essentially equivalent to a GLV model in which we track frequencies instead of abundances.</p>
<p>Importantly, we can see <span class="math inline">\(x\)</span> as a “mixed strategy” for the symmetric game encoded in <span class="math inline">\(A\)</span>. In this context, <strong>an equilibrium of the replicator equation is a Nash Equilibrium for the game</strong>; similarly, <strong>a stable equilibrium for the replicator equation is an Evolutionary Stable Strategy</strong>.</p>
<div id="invariants" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Invariants<a href="game-theory-and-replicator-dynamics.html#invariants" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Adding a constant to each column of <span class="math inline">\(A\)</span> does not alter the dynamics. We have <span class="math inline">\(B = A + e b^T\)</span>, where <span class="math inline">\(e\)</span> is a vector of ones. Then:</p>
<p><span class="math display">\[
\begin{aligned}
x_i \left( \sum_j B_{ij} x_j - \sum_{kj} x_k B_{kj} x_j \right) &amp; = x_i \left( \sum_j (A_{ij} + b_j) x_j - \sum_{kj} x_k (A_{kj} + b_j) x_j \right)\\
&amp;= x_i \left(\sum_j A_{ij} x_j + \sum_j b_j x_j  - \sum_{kj} x_k A_{kj} x_j - \sum_{kj} x_k b_{j} x_j \right)\\
&amp;= x_i \left(\sum_j A_{ij} x_j + \sum_j b_j x_j  - \sum_{kj} x_k A_{kj} x_j - \sum_{j} b_{j} x_j \right)\\
&amp;= x_i \left(\sum_j A_{ij} x_j - \sum_{kj} x_k A_{kj} x_j \right)\\
\end{aligned}
\]</span></p>
<p>Similarly, multiplying each column of <span class="math inline">\(A\)</span> by a (possibly different) positive constant does not alter dynamics (it just rescales time). As such, if <span class="math inline">\(A_2 = A_1 D + eb^T\)</span> the replicator equations formed using <span class="math inline">\(A_1\)</span> and <span class="math inline">\(A_2\)</span> are equivalent.</p>
</div>
<div id="rock-paper-scissor" class="section level3 hasAnchor" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Rock-paper-scissor<a href="game-theory-and-replicator-dynamics.html#rock-paper-scissor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s try our hand at a simple zero-sum (i.e., <span class="math inline">\(A = -A^T\)</span>) replicator equation. We have three populations (“rock”, “paper”, and “scissors”) with payoff matrix:</p>
<p><span class="math display">\[
A = \begin{pmatrix}
0 &amp; -1 &amp; 1\\
1 &amp; 0 &amp; -1\\
-1 &amp; 1 &amp; 0
\end{pmatrix}
\]</span></p>
<p>We start the population at a random initial condition, and track dynamics:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="game-theory-and-replicator-dynamics.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the differential equation</span></span>
<span id="cb66-2"><a href="game-theory-and-replicator-dynamics.html#cb66-2" aria-hidden="true" tabindex="-1"></a>RE <span class="ot">&lt;-</span><span class="cf">function</span>(t, x, parameters){</span>
<span id="cb66-3"><a href="game-theory-and-replicator-dynamics.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(x, parameters)), {</span>
<span id="cb66-4"><a href="game-theory-and-replicator-dynamics.html#cb66-4" aria-hidden="true" tabindex="-1"></a>    x[x <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># prevent numerical problems</span></span>
<span id="cb66-5"><a href="game-theory-and-replicator-dynamics.html#cb66-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">/</span> <span class="fu">sum</span>(x) <span class="co"># keep on simplex</span></span>
<span id="cb66-6"><a href="game-theory-and-replicator-dynamics.html#cb66-6" aria-hidden="true" tabindex="-1"></a>    dxdt <span class="ot">&lt;-</span> x <span class="sc">*</span> (A <span class="sc">%*%</span> x <span class="sc">-</span> <span class="fu">sum</span>(x <span class="sc">*</span> A <span class="sc">%*%</span> x))</span>
<span id="cb66-7"><a href="game-theory-and-replicator-dynamics.html#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(dxdt)</span>
<span id="cb66-8"><a href="game-theory-and-replicator-dynamics.html#cb66-8" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb66-9"><a href="game-theory-and-replicator-dynamics.html#cb66-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-10"><a href="game-theory-and-replicator-dynamics.html#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="game-theory-and-replicator-dynamics.html#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co"># general function to integrate RE</span></span>
<span id="cb66-12"><a href="game-theory-and-replicator-dynamics.html#cb66-12" aria-hidden="true" tabindex="-1"></a>integrate_RE <span class="ot">&lt;-</span> <span class="cf">function</span>(A, x0, <span class="at">maxtime =</span> <span class="dv">40</span>, <span class="at">steptime =</span> <span class="fl">0.05</span>){</span>
<span id="cb66-13"><a href="game-theory-and-replicator-dynamics.html#cb66-13" aria-hidden="true" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, maxtime, <span class="at">by =</span> steptime)</span>
<span id="cb66-14"><a href="game-theory-and-replicator-dynamics.html#cb66-14" aria-hidden="true" tabindex="-1"></a>  parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">A =</span> A)</span>
<span id="cb66-15"><a href="game-theory-and-replicator-dynamics.html#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># solve numerically</span></span>
<span id="cb66-16"><a href="game-theory-and-replicator-dynamics.html#cb66-16" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y =</span> x0, <span class="at">times =</span> times, </span>
<span id="cb66-17"><a href="game-theory-and-replicator-dynamics.html#cb66-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">func =</span> RE, <span class="at">parms =</span> parameters, </span>
<span id="cb66-18"><a href="game-theory-and-replicator-dynamics.html#cb66-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">method =</span> <span class="st">&quot;ode45&quot;</span>)</span>
<span id="cb66-19"><a href="game-theory-and-replicator-dynamics.html#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot and make into tidy form</span></span>
<span id="cb66-20"><a href="game-theory-and-replicator-dynamics.html#cb66-20" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">plot_ODE_output</span>(out)</span>
<span id="cb66-21"><a href="game-theory-and-replicator-dynamics.html#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb66-22"><a href="game-theory-and-replicator-dynamics.html#cb66-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-23"><a href="game-theory-and-replicator-dynamics.html#cb66-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-24"><a href="game-theory-and-replicator-dynamics.html#cb66-24" aria-hidden="true" tabindex="-1"></a><span class="co"># payoff matrix</span></span>
<span id="cb66-25"><a href="game-theory-and-replicator-dynamics.html#cb66-25" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb66-26"><a href="game-theory-and-replicator-dynamics.html#cb66-26" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb66-27"><a href="game-theory-and-replicator-dynamics.html#cb66-27" aria-hidden="true" tabindex="-1"></a>              <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-28"><a href="game-theory-and-replicator-dynamics.html#cb66-28" aria-hidden="true" tabindex="-1"></a><span class="co"># initial conditions</span></span>
<span id="cb66-29"><a href="game-theory-and-replicator-dynamics.html#cb66-29" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb66-30"><a href="game-theory-and-replicator-dynamics.html#cb66-30" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> x0 <span class="sc">/</span> <span class="fu">sum</span>(x0)</span>
<span id="cb66-31"><a href="game-theory-and-replicator-dynamics.html#cb66-31" aria-hidden="true" tabindex="-1"></a>rps <span class="ot">&lt;-</span> <span class="fu">integrate_RE</span>(A, x0)</span></code></pre></div>
<p><img src="Theoretical_Community_Ecology_files/figure-html/refuctions-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>What if we start all populations at the same density?</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="game-theory-and-replicator-dynamics.html#cb67-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb67-2"><a href="game-theory-and-replicator-dynamics.html#cb67-2" aria-hidden="true" tabindex="-1"></a>rps <span class="ot">&lt;-</span> <span class="fu">integrate_RE</span>(A, x0)</span></code></pre></div>
<p><img src="Theoretical_Community_Ecology_files/figure-html/rps2-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>And if they are close to the 1/3?</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="game-theory-and-replicator-dynamics.html#cb68-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">3</span>) <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb68-2"><a href="game-theory-and-replicator-dynamics.html#cb68-2" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> x0 <span class="sc">/</span> <span class="fu">sum</span>(x0)</span>
<span id="cb68-3"><a href="game-theory-and-replicator-dynamics.html#cb68-3" aria-hidden="true" tabindex="-1"></a>rps <span class="ot">&lt;-</span> <span class="fu">integrate_RE</span>(A, x0)</span></code></pre></div>
<p><img src="Theoretical_Community_Ecology_files/figure-html/rps3-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="equivalence-with-glv" class="section level3 hasAnchor" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> Equivalence with GLV<a href="game-theory-and-replicator-dynamics.html#equivalence-with-glv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For a given <span class="math inline">\(n-\)</span>species GLV system, there is an equivalent <span class="math inline">\((n+1)-\)</span>dimensional replicator equation with zeros in the last row of the matrix.</p>
<p>Take the GLV model with <span class="math inline">\(n\)</span> species:</p>
<p><span class="math display">\[
\dfrac{d x}{dt} = D(x)(r + A x)
\]</span></p>
<p>and add a “new species” <span class="math inline">\(x_{n + 1}\)</span> such that <span class="math inline">\(x_{n+1}(0) = 1\)</span>; define <span class="math inline">\(\tilde{x} = \{x, x_{n+1} \}\)</span> and the matrix:</p>
<p><span class="math display">\[
\tilde{A}=\begin{pmatrix}
A &amp; r\\
0 &amp; 0
\end{pmatrix}
\]</span></p>
<p>we then have a new <span class="math inline">\(n+1\)</span> dimensional GLV system:</p>
<p><span class="math display">\[
\dfrac{d \tilde{x}}{dt} = D(\tilde{x}) \tilde{A} \tilde{x}
\]</span></p>
<p>Now we want to move from abundances to frequencies/proportions. Note that we drop all the tilde signs for easier typing. Define:</p>
<p><span class="math display">\[
y_i = \dfrac{x_i}{\sum_j x_j}
\]</span></p>
<p>Then,</p>
<p><span class="math display">\[
\begin{aligned}
\dfrac{d y_i}{dt} &amp;= \sum_k \dfrac{\partial y_i}{\partial x_k} \dfrac{d x_k}{dt}\\
&amp;= \dfrac{1}{\sum_j x_j}\dfrac{d x_i}{dt}-\dfrac{1}{(\sum_j x_j)^2} x_i \sum_k \dfrac{d x_k}{dt}\\
&amp;= \dfrac{1}{\sum_j x_j} x_i \sum_l A_{il}x_l - \dfrac{1}{(\sum_j x_j)^2} x_i \sum_k \left( x_k \sum_l A_{kl} x_l\right)\\
&amp;= y_i \sum_l A_{il}x_l- y_i \sum_k \left( y_k \sum_l A_{kl} x_l\right)\\
&amp;=(\sum_j x_j) y_i \left( \sum_l A_{il}y_l - \sum_{k,l} A_{kl} y_k y_l\right)
\end{aligned}
\]</span></p>
<p>Finally, you rescale time using <span class="math inline">\(\sum_j x_j\)</span> to obtain the replicator equation. To show this is indeed the case, let’s take our functions for integrating GLV:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="game-theory-and-replicator-dynamics.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generalized Lotka-Volterra model</span></span>
<span id="cb69-2"><a href="game-theory-and-replicator-dynamics.html#cb69-2" aria-hidden="true" tabindex="-1"></a>GLV <span class="ot">&lt;-</span> <span class="cf">function</span>(t, x, parameters){</span>
<span id="cb69-3"><a href="game-theory-and-replicator-dynamics.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(x, parameters)), {</span>
<span id="cb69-4"><a href="game-theory-and-replicator-dynamics.html#cb69-4" aria-hidden="true" tabindex="-1"></a>    x[x <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># prevent numerical problems</span></span>
<span id="cb69-5"><a href="game-theory-and-replicator-dynamics.html#cb69-5" aria-hidden="true" tabindex="-1"></a>    dxdt <span class="ot">&lt;-</span> x <span class="sc">*</span> (r <span class="sc">+</span> A <span class="sc">%*%</span> x)</span>
<span id="cb69-6"><a href="game-theory-and-replicator-dynamics.html#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(dxdt)</span>
<span id="cb69-7"><a href="game-theory-and-replicator-dynamics.html#cb69-7" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb69-8"><a href="game-theory-and-replicator-dynamics.html#cb69-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-9"><a href="game-theory-and-replicator-dynamics.html#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co"># general function to integrate GLV</span></span>
<span id="cb69-10"><a href="game-theory-and-replicator-dynamics.html#cb69-10" aria-hidden="true" tabindex="-1"></a>integrate_GLV <span class="ot">&lt;-</span> <span class="cf">function</span>(r, A, x0, <span class="at">maxtime =</span> <span class="dv">100</span>, <span class="at">steptime =</span> <span class="fl">0.5</span>){</span>
<span id="cb69-11"><a href="game-theory-and-replicator-dynamics.html#cb69-11" aria-hidden="true" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, maxtime, <span class="at">by =</span> steptime)</span>
<span id="cb69-12"><a href="game-theory-and-replicator-dynamics.html#cb69-12" aria-hidden="true" tabindex="-1"></a>  parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">r =</span> r, <span class="at">A =</span> A)</span>
<span id="cb69-13"><a href="game-theory-and-replicator-dynamics.html#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># solve numerically</span></span>
<span id="cb69-14"><a href="game-theory-and-replicator-dynamics.html#cb69-14" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y =</span> x0, <span class="at">times =</span> times, </span>
<span id="cb69-15"><a href="game-theory-and-replicator-dynamics.html#cb69-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">func =</span> GLV, <span class="at">parms =</span> parameters, </span>
<span id="cb69-16"><a href="game-theory-and-replicator-dynamics.html#cb69-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">method =</span> <span class="st">&quot;ode45&quot;</span>)</span>
<span id="cb69-17"><a href="game-theory-and-replicator-dynamics.html#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot and make into tidy form</span></span>
<span id="cb69-18"><a href="game-theory-and-replicator-dynamics.html#cb69-18" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">plot_ODE_output</span>(out)</span>
<span id="cb69-19"><a href="game-theory-and-replicator-dynamics.html#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb69-20"><a href="game-theory-and-replicator-dynamics.html#cb69-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And integrate the simple system:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="game-theory-and-replicator-dynamics.html#cb70-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb70-2"><a href="game-theory-and-replicator-dynamics.html#cb70-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>,</span>
<span id="cb70-3"><a href="game-theory-and-replicator-dynamics.html#cb70-3" aria-hidden="true" tabindex="-1"></a>              <span class="sc">-</span><span class="fl">0.7</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>,</span>
<span id="cb70-4"><a href="game-theory-and-replicator-dynamics.html#cb70-4" aria-hidden="true" tabindex="-1"></a>              <span class="sc">-</span><span class="fl">0.3</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-5"><a href="game-theory-and-replicator-dynamics.html#cb70-5" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb70-6"><a href="game-theory-and-replicator-dynamics.html#cb70-6" aria-hidden="true" tabindex="-1"></a>glvex <span class="ot">&lt;-</span> <span class="fu">integrate_GLV</span>(r, A, x0)</span></code></pre></div>
<p><img src="Theoretical_Community_Ecology_files/figure-html/exampleglvtore1-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>And now build the corresponding replicator equation. The matrix of payoffs <span class="math inline">\(\tilde{A}\)</span> becomes:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="game-theory-and-replicator-dynamics.html#cb71-1" aria-hidden="true" tabindex="-1"></a>Atilde <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb71-2"><a href="game-theory-and-replicator-dynamics.html#cb71-2" aria-hidden="true" tabindex="-1"></a>Atilde[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> A</span>
<span id="cb71-3"><a href="game-theory-and-replicator-dynamics.html#cb71-3" aria-hidden="true" tabindex="-1"></a>Atilde[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">4</span>] <span class="ot">&lt;-</span> r</span></code></pre></div>
<p><span class="math display">\[
\begin{bmatrix}-1&amp;0.5&amp;0.1&amp;1 \\-0.7&amp;-2&amp;0&amp;2 \\-0.3&amp;0&amp;-5&amp;3 \\0&amp;0&amp;0&amp;0 \\\end{bmatrix}
\]</span></p>
<p>Integrate the dynamics:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="game-theory-and-replicator-dynamics.html#cb72-1" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">c</span>(x0, <span class="dv">1</span>) <span class="co"># add an extra &quot;species&quot;</span></span>
<span id="cb72-2"><a href="game-theory-and-replicator-dynamics.html#cb72-2" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> y0 <span class="sc">/</span> <span class="fu">sum</span>(y0) <span class="co"># project on the simplex</span></span>
<span id="cb72-3"><a href="game-theory-and-replicator-dynamics.html#cb72-3" aria-hidden="true" tabindex="-1"></a>reex <span class="ot">&lt;-</span> <span class="fu">integrate_RE</span>(Atilde, y0)</span></code></pre></div>
<p><img src="Theoretical_Community_Ecology_files/figure-html/redynamicsfromglv2-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Now let’s look at the equilibrium of the GLV model:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="game-theory-and-replicator-dynamics.html#cb73-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(glvex <span class="sc">%&gt;%</span> <span class="fu">filter</span>(time <span class="sc">==</span> <span class="dv">100</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">time</th>
<th align="left">species</th>
<th align="right">density</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">100</td>
<td align="left">sp_1</td>
<td align="right">1.3209145</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="left">sp_2</td>
<td align="right">0.5376799</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="left">sp_3</td>
<td align="right">0.5207451</td>
</tr>
</tbody>
</table>
<p>And recover it from the RE equation (just divide by the density of the extra “species”):</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="game-theory-and-replicator-dynamics.html#cb74-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(reex <span class="sc">%&gt;%</span> <span class="fu">filter</span>(time <span class="sc">==</span> <span class="dv">40</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">time</th>
<th align="left">species</th>
<th align="right">density</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">40</td>
<td align="left">sp_1</td>
<td align="right">0.3908793</td>
</tr>
<tr class="even">
<td align="right">40</td>
<td align="left">sp_2</td>
<td align="right">0.1591076</td>
</tr>
<tr class="odd">
<td align="right">40</td>
<td align="left">sp_3</td>
<td align="right">0.1540969</td>
</tr>
<tr class="even">
<td align="right">40</td>
<td align="left">sp_4</td>
<td align="right">0.2959162</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="game-theory-and-replicator-dynamics.html#cb75-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(reex <span class="sc">%&gt;%</span> <span class="fu">filter</span>(time <span class="sc">==</span> <span class="dv">40</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="game-theory-and-replicator-dynamics.html#cb75-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mutate</span>(<span class="at">density =</span> density <span class="sc">/</span> <span class="fu">tail</span>(density, <span class="dv">1</span>)) )</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">time</th>
<th align="left">species</th>
<th align="right">density</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">40</td>
<td align="left">sp_1</td>
<td align="right">1.3209123</td>
</tr>
<tr class="even">
<td align="right">40</td>
<td align="left">sp_2</td>
<td align="right">0.5376779</td>
</tr>
<tr class="odd">
<td align="right">40</td>
<td align="left">sp_3</td>
<td align="right">0.5207453</td>
</tr>
<tr class="even">
<td align="right">40</td>
<td align="left">sp_4</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<p>Not only the equilibria are the same, but also the dynamics are the same once time has been properly rescaled. Similarly, for each RE system we can always recover a matrix with zero in the last row by applying the transformations detailed above, and therefore recover the corresponding GLV. For example, take the matrix for the RPS above, and make each coefficient in the last row zero by adding the appropriate constant to each column. Then one recovers some sort of a predator-prey system:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="game-theory-and-replicator-dynamics.html#cb76-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb76-2"><a href="game-theory-and-replicator-dynamics.html#cb76-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>,</span>
<span id="cb76-3"><a href="game-theory-and-replicator-dynamics.html#cb76-3" aria-hidden="true" tabindex="-1"></a>              <span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-4"><a href="game-theory-and-replicator-dynamics.html#cb76-4" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">1.1</span>)</span>
<span id="cb76-5"><a href="game-theory-and-replicator-dynamics.html#cb76-5" aria-hidden="true" tabindex="-1"></a>glvex <span class="ot">&lt;-</span> <span class="fu">integrate_GLV</span>(r, A, x0, <span class="at">maxtime =</span> <span class="dv">15</span>, <span class="at">steptime =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<p><img src="Theoretical_Community_Ecology_files/figure-html/exampleretoglv1-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>in which the species oscillate around one.</p>
<div class="boxpaper">
<p><strong>Key paper: <span class="citation">Page and Nowak (<a href="#ref-page2002unifying" role="doc-biblioref">2002</a>)</span></strong></p>
<p>In this brief paper, Page and Nowak show that the replicator-mutator equation and the Price equation are two ways of tracking general evolutionary dynamics. They discuss the connections with GLV and adaptive dynamics.</p>
</div>
</div>
<div id="hypertournament-games" class="section level3 hasAnchor" number="7.6.4">
<h3><span class="header-section-number">7.6.4</span> Hypertournament games<a href="game-theory-and-replicator-dynamics.html#hypertournament-games" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The rock-paper-scissor game above is a simple case of a “hypertournament” game. Take the zero-sum payoff matrix <span class="math inline">\(A = -A^T\)</span>. Then, we have</p>
<p><span class="math display">\[
\sum_i \sum_j A_{ij} x_i x_j = 0
\]</span></p>
<p>and the RE simplifies to</p>
<p><span class="math display">\[
\dfrac{d x}{dt} = D(x) A x
\]</span></p>
<p>At equilibrium, either some elements of <span class="math inline">\(x\)</span> are zero, or</p>
<p><span class="math display">\[
A x^\star = 0
\]</span></p>
<p>meaning that if a feasible equilibrium <span class="math inline">\(x^\star\)</span> exists, it is an eigenvector of <span class="math inline">\(A\)</span> corresponding to a zero eigenvalue.</p>
<div id="number-of-coexisting-species" class="section level4 hasAnchor" number="7.6.4.1">
<h4><span class="header-section-number">7.6.4.1</span> Number of coexisting species<a href="game-theory-and-replicator-dynamics.html#number-of-coexisting-species" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We now show how the equations above can arise when modeling ecological dynamics. Suppose that a forest is composed of a fixed number of trees. Each time a tree dies (with rate <span class="math inline">\(d = 1\)</span> for all species), a gap in the canopy opens, and species will compete to colonize it. Let’s assume that two seeds (sampled with probability proportional to the density of the species) land in the empty patch, and that they compete to fill the gap. Call <span class="math inline">\(H_{ij}\)</span> the probability that <span class="math inline">\(i\)</span> wins when competing with <span class="math inline">\(j\)</span>; we have <span class="math inline">\(H_{ij} + H_{ji} = 1\)</span>. We can write the dynamics <span class="citation">(<a href="#ref-grilli2017higher" role="doc-biblioref">Grilli et al. 2017</a>)</span> as:</p>
<p><span class="math display">\[
\begin{aligned}
  \dfrac{d x_i}{dt} &amp;= x_i \left(\sum_j 2 H_{ij} x_j - 1 \right) \\
  &amp;=x_i \sum_j (2 H_{ij} x_j - x_j) \\
  &amp;= x_i \sum_j (H_{ij} x_j  + (1 - H_{ji}) x_j - x_j) \\
  &amp;= x_i \sum_j (H_{ij} - H_{ji}) x_j \\
  &amp;= x_i  \sum_j A_{ij} x_j
\end{aligned}
\]</span></p>
<p>I.e., we recover the RE for a zero-sum game. What happens if we draw <span class="math inline">\(H\)</span> (and therefore <span class="math inline">\(A\)</span>) at random? <span class="citation">Allesina and Levine (<a href="#ref-allesina2011competitive" role="doc-biblioref">2011</a>)</span> and <span class="citation">Grilli et al. (<a href="#ref-grilli2017higher" role="doc-biblioref">2017</a>)</span> applied the results of <span class="citation">Fisher and Reeves (<a href="#ref-fisher1995optimal" role="doc-biblioref">1995</a>)</span> and <span class="citation">Brandl (<a href="#ref-brandl2017distribution" role="doc-biblioref">2017</a>)</span> to show that, when <span class="math inline">\(n\)</span> species compete, the probability of observing <span class="math inline">\(k\)</span> coexisting is <span class="math inline">\(p(k|n) = \binom{n}{k} 2^{1-n}\)</span> when <span class="math inline">\(k\)</span> is odd, and <span class="math inline">\(p(k|n) = 0\)</span> when <span class="math inline">\(k\)</span> is even.</p>
<p>Importantly, to find the set of coexisting species we do not need to integrate dynamics. One can use linear programming to solve for the set of species that will coexist.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="game-theory-and-replicator-dynamics.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span>
<span id="cb77-2"><a href="game-theory-and-replicator-dynamics.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a random matrix H such that H_ij + H_ji = 1</span></span>
<span id="cb77-3"><a href="game-theory-and-replicator-dynamics.html#cb77-3" aria-hidden="true" tabindex="-1"></a>random_H <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb77-4"><a href="game-theory-and-replicator-dynamics.html#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># build random hypertournament H</span></span>
<span id="cb77-5"><a href="game-theory-and-replicator-dynamics.html#cb77-5" aria-hidden="true" tabindex="-1"></a>  H <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n <span class="sc">*</span> n), n, n)</span>
<span id="cb77-6"><a href="game-theory-and-replicator-dynamics.html#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(H <span class="sc">/</span> (H <span class="sc">+</span> <span class="fu">t</span>(H)))</span>
<span id="cb77-7"><a href="game-theory-and-replicator-dynamics.html#cb77-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-8"><a href="game-theory-and-replicator-dynamics.html#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the optimal strategy for the two-person game encoded in H</span></span>
<span id="cb77-9"><a href="game-theory-and-replicator-dynamics.html#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># using linear programming.</span></span>
<span id="cb77-10"><a href="game-theory-and-replicator-dynamics.html#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="co"># This is also the coexistence equilibrium of the dynamical system.</span></span>
<span id="cb77-11"><a href="game-theory-and-replicator-dynamics.html#cb77-11" aria-hidden="true" tabindex="-1"></a>find_optimal_strategy <span class="ot">&lt;-</span> <span class="cf">function</span>(H){</span>
<span id="cb77-12"><a href="game-theory-and-replicator-dynamics.html#cb77-12" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(H)[<span class="dv">1</span>]</span>
<span id="cb77-13"><a href="game-theory-and-replicator-dynamics.html#cb77-13" aria-hidden="true" tabindex="-1"></a>  f.obj <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, n)</span>
<span id="cb77-14"><a href="game-theory-and-replicator-dynamics.html#cb77-14" aria-hidden="true" tabindex="-1"></a>  f.con <span class="ot">&lt;-</span> H</span>
<span id="cb77-15"><a href="game-theory-and-replicator-dynamics.html#cb77-15" aria-hidden="true" tabindex="-1"></a>  f.rhs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, n)</span>
<span id="cb77-16"><a href="game-theory-and-replicator-dynamics.html#cb77-16" aria-hidden="true" tabindex="-1"></a>  f.dir <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;&lt;=&quot;</span>, n)</span>
<span id="cb77-17"><a href="game-theory-and-replicator-dynamics.html#cb77-17" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">lp</span> (<span class="st">&quot;max&quot;</span>, f.obj, f.con, f.dir, f.rhs)</span>
<span id="cb77-18"><a href="game-theory-and-replicator-dynamics.html#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z<span class="sc">$</span>solution <span class="sc">/</span> <span class="fu">sum</span>(z<span class="sc">$</span>solution))</span>
<span id="cb77-19"><a href="game-theory-and-replicator-dynamics.html#cb77-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now let’s try to count how many species suvive when starting with 10:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="game-theory-and-replicator-dynamics.html#cb78-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb78-2"><a href="game-theory-and-replicator-dynamics.html#cb78-2" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb78-3"><a href="game-theory-and-replicator-dynamics.html#cb78-3" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">simulation =</span> <span class="dv">1</span><span class="sc">:</span>num_simulations, <span class="at">coexisting =</span> <span class="dv">0</span>)</span>
<span id="cb78-4"><a href="game-theory-and-replicator-dynamics.html#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_simulations){</span>
<span id="cb78-5"><a href="game-theory-and-replicator-dynamics.html#cb78-5" aria-hidden="true" tabindex="-1"></a>  H <span class="ot">&lt;-</span> <span class="fu">random_H</span>(n)</span>
<span id="cb78-6"><a href="game-theory-and-replicator-dynamics.html#cb78-6" aria-hidden="true" tabindex="-1"></a>  coexisting <span class="ot">&lt;-</span> <span class="fu">find_optimal_strategy</span>(H)</span>
<span id="cb78-7"><a href="game-theory-and-replicator-dynamics.html#cb78-7" aria-hidden="true" tabindex="-1"></a>  results[i,<span class="st">&quot;coexisting&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>((coexisting <span class="sc">&gt;</span> <span class="dv">0</span>)<span class="sc">*</span><span class="dv">1</span>)</span>
<span id="cb78-8"><a href="game-theory-and-replicator-dynamics.html#cb78-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-9"><a href="game-theory-and-replicator-dynamics.html#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and plot</span></span>
<span id="cb78-10"><a href="game-theory-and-replicator-dynamics.html#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> results) <span class="sc">+</span> </span>
<span id="cb78-11"><a href="game-theory-and-replicator-dynamics.html#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> coexisting) <span class="sc">+</span> </span>
<span id="cb78-12"><a href="game-theory-and-replicator-dynamics.html#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb78-13"><a href="game-theory-and-replicator-dynamics.html#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="Theoretical_Community_Ecology_files/figure-html/coexistlphist-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="lyapunov-function" class="section level3 hasAnchor" number="7.6.5">
<h3><span class="header-section-number">7.6.5</span> Lyapunov function<a href="game-theory-and-replicator-dynamics.html#lyapunov-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the rock-paper-scissor example above, species cycled neutrally around the unique equilibrium point. To show that this is in fact the behavior of this type of RE, we write a Lyapunov function. By finding a constant of motion we can show that the species will follow closed orbits.</p>
<p>Suppose <span class="math inline">\(x_{i}^\star &gt; 0\)</span> is the equilibrium for the system. We write:</p>
<p><span class="math display">\[
V(x) = -\sum_i x_i^\star \log \frac{x_i}{x_i^\star} .
\]</span></p>
<p>Because of <a href="https://en.wikipedia.org/wiki/Gibbs%27_inequality">Gibbs’ inequality</a>, <span class="math inline">\(V(x) \geq 0\)</span> for any <span class="math inline">\(x\)</span>, and is equal to zero only if <span class="math inline">\(x = x^\star\)</span>. Note also that at equilibrium <span class="math inline">\(2 \sum_j H_{ij} x_j^\star = 1\)</span>. We write:</p>
<p><span class="math display">\[
\begin{aligned}
  \dfrac{d V}{d t} &amp;= \sum_i \dfrac{\partial V}{\partial x_i}
  \dfrac{d x_i}{d t}\\
  &amp;= - \sum_i \frac{x_i^\star}{x_i} \dfrac{d x_i}{d t} \\
  &amp;= -2 \sum_{i,j} x_i^\star H_{ij}x_j + \sum_i x_i^\star\\
  &amp;= -2 \sum_{i,j} x_i^\star H_{ij}x_j + 1\\
  &amp;= \sum_j \left(-2 \sum_i H_{ij}x_i^\star \right) x_j + 1\\
  &amp;= \sum_j \left(-2 \sum_i (1 - H_{ji}) x_i^\star \right) x_j + 1\\
  &amp;= \sum_j \left(-2 \sum_i x_i^\star + 2 \sum_i H_{ji} x_i^\star \right) x_j
  + 1 \\
  &amp;= \sum_j \left(-2 + 1 \right) x_j  + 1 \\
  &amp;=- \sum_j x_j + 1\\
  &amp;= 0
\end{aligned}
\]</span></p>
<p>We have found a constant of motion, meaning that the system will follow closed orbits. Hence, unless we start the system precisely at <span class="math inline">\(x^\star\)</span>, the abundances will cycle neutrally around the equilibrium.</p>
<p>Let’s try with a larger system:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="game-theory-and-replicator-dynamics.html#cb79-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb79-2"><a href="game-theory-and-replicator-dynamics.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># search for random H yielding all species coexisting</span></span>
<span id="cb79-3"><a href="game-theory-and-replicator-dynamics.html#cb79-3" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb79-4"><a href="game-theory-and-replicator-dynamics.html#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="cn">TRUE</span>){</span>
<span id="cb79-5"><a href="game-theory-and-replicator-dynamics.html#cb79-5" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb79-6"><a href="game-theory-and-replicator-dynamics.html#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(i)</span>
<span id="cb79-7"><a href="game-theory-and-replicator-dynamics.html#cb79-7" aria-hidden="true" tabindex="-1"></a>  H <span class="ot">&lt;-</span> <span class="fu">random_H</span>(n)</span>
<span id="cb79-8"><a href="game-theory-and-replicator-dynamics.html#cb79-8" aria-hidden="true" tabindex="-1"></a>  x_star <span class="ot">&lt;-</span> <span class="fu">find_optimal_strategy</span>(H)</span>
<span id="cb79-9"><a href="game-theory-and-replicator-dynamics.html#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">all</span>(x_star <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="cf">break</span></span>
<span id="cb79-10"><a href="game-theory-and-replicator-dynamics.html#cb79-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-11"><a href="game-theory-and-replicator-dynamics.html#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="co"># payoff matrix</span></span>
<span id="cb79-12"><a href="game-theory-and-replicator-dynamics.html#cb79-12" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> H <span class="sc">-</span> <span class="fu">t</span>(H)</span>
<span id="cb79-13"><a href="game-theory-and-replicator-dynamics.html#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="co"># initial conditions close to equilibrium</span></span>
<span id="cb79-14"><a href="game-theory-and-replicator-dynamics.html#cb79-14" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> x_star <span class="sc">+</span> <span class="fu">runif</span>(n) <span class="sc">*</span> <span class="fl">0.2</span></span>
<span id="cb79-15"><a href="game-theory-and-replicator-dynamics.html#cb79-15" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> x0 <span class="sc">/</span> <span class="fu">sum</span>(x0)</span>
<span id="cb79-16"><a href="game-theory-and-replicator-dynamics.html#cb79-16" aria-hidden="true" tabindex="-1"></a>fivespp <span class="ot">&lt;-</span> <span class="fu">integrate_RE</span>(A, x0, <span class="at">maxtime =</span> <span class="dv">400</span>, <span class="at">steptime =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="Theoretical_Community_Ecology_files/figure-html/reneutral-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="boxhomework">
<p><strong>Homework 7a</strong></p>
<p>Analyze the replicator equation when the matrix <span class="math inline">\(A\)</span> is:</p>
<p><span class="math display">\[
A = \begin{pmatrix}
0 &amp; -\alpha &amp; 1\\
1 &amp; 0 &amp; -\alpha\\
-\alpha &amp; 1 &amp; 0
\end{pmatrix}
\]</span></p>
<p>for the cases in which a) <span class="math inline">\(\alpha &gt; 1\)</span>, b) <span class="math inline">\(\alpha &lt; 1\)</span>. Write code to simulate the system, and prove stability/instability depending on the value of <span class="math inline">\(\alpha\)</span>.</p>
</div>
<div class="boxhomework">
<p><strong>Homework 7b</strong></p>
<p>As seen above, generally zero-sum matrix games will lead to an odd number of species coexisting.</p>
<ul>
<li>Can you build a matrix leading to four species/strategies coexisting?</li>
<li>Now simulate the dynamics several times, starting from different initial conditions—do species cycle around the same equilibrium? Why?</li>
</ul>
</div>
</div>
<div id="higher-order-interactions" class="section level3 hasAnchor" number="7.6.6">
<h3><span class="header-section-number">7.6.6</span> Higher-order interactions<a href="game-theory-and-replicator-dynamics.html#higher-order-interactions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can extend the game above to the case in which three (or more) seeds compete to fill each patch. <span class="citation">Grilli et al. (<a href="#ref-grilli2017higher" role="doc-biblioref">2017</a>)</span> showed that in this case, one can write the replicator equation:</p>
<p><span class="math display">\[
\dfrac{d x_i}{dt} = x_i \sum_{j,k} A_{ijk} x_j x_k
\]</span></p>
<p>where the tensor <span class="math inline">\(A\)</span> (a three-dimensional matrix) encodes the effect of a pair of species (<span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span>) on the density of <span class="math inline">\(i\)</span>. Importantly, one can choose the tensor such that the equilibrium is the same as for the two-player replicator equation: take <span class="math inline">\(A_{ijk} = 2 H_{ij} H_{ik} - H_{ji} H_{jk} - H_{ki} H_{kj}\)</span>, which can be derived from first principles by writing the stochastic dynamics. What is surprising is that, while the equilibrium is unchanged, the dynamics are now globally stable:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="game-theory-and-replicator-dynamics.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now payoff is a tensor</span></span>
<span id="cb80-2"><a href="game-theory-and-replicator-dynamics.html#cb80-2" aria-hidden="true" tabindex="-1"></a>RE_3 <span class="ot">&lt;-</span> <span class="cf">function</span>(t, x, parameters){</span>
<span id="cb80-3"><a href="game-theory-and-replicator-dynamics.html#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(x, parameters)), {</span>
<span id="cb80-4"><a href="game-theory-and-replicator-dynamics.html#cb80-4" aria-hidden="true" tabindex="-1"></a>    x[x <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># prevent numerical problems</span></span>
<span id="cb80-5"><a href="game-theory-and-replicator-dynamics.html#cb80-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">/</span> <span class="fu">sum</span>(x) <span class="co"># keep on simplex</span></span>
<span id="cb80-6"><a href="game-theory-and-replicator-dynamics.html#cb80-6" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb80-7"><a href="game-theory-and-replicator-dynamics.html#cb80-7" aria-hidden="true" tabindex="-1"></a>    dxidt <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb80-8"><a href="game-theory-and-replicator-dynamics.html#cb80-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb80-9"><a href="game-theory-and-replicator-dynamics.html#cb80-9" aria-hidden="true" tabindex="-1"></a>      dxidt[i] <span class="ot">&lt;-</span> x[i] <span class="sc">*</span> x <span class="sc">%*%</span> P3[i,,] <span class="sc">%*%</span> x</span>
<span id="cb80-10"><a href="game-theory-and-replicator-dynamics.html#cb80-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-11"><a href="game-theory-and-replicator-dynamics.html#cb80-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(dxidt)</span>
<span id="cb80-12"><a href="game-theory-and-replicator-dynamics.html#cb80-12" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb80-13"><a href="game-theory-and-replicator-dynamics.html#cb80-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-14"><a href="game-theory-and-replicator-dynamics.html#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="co"># general function to integrate RE_3</span></span>
<span id="cb80-15"><a href="game-theory-and-replicator-dynamics.html#cb80-15" aria-hidden="true" tabindex="-1"></a>integrate_RE_3 <span class="ot">&lt;-</span> <span class="cf">function</span>(H, x0, <span class="at">maxtime =</span> <span class="dv">40</span>, <span class="at">steptime =</span> <span class="fl">0.05</span>){</span>
<span id="cb80-16"><a href="game-theory-and-replicator-dynamics.html#cb80-16" aria-hidden="true" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, maxtime, <span class="at">by =</span> steptime)</span>
<span id="cb80-17"><a href="game-theory-and-replicator-dynamics.html#cb80-17" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(H)</span>
<span id="cb80-18"><a href="game-theory-and-replicator-dynamics.html#cb80-18" aria-hidden="true" tabindex="-1"></a>  P3 <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="fu">c</span>(n, n, n))</span>
<span id="cb80-19"><a href="game-theory-and-replicator-dynamics.html#cb80-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb80-20"><a href="game-theory-and-replicator-dynamics.html#cb80-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb80-21"><a href="game-theory-and-replicator-dynamics.html#cb80-21" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb80-22"><a href="game-theory-and-replicator-dynamics.html#cb80-22" aria-hidden="true" tabindex="-1"></a>        P3[i,j,k] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> H[i,j] <span class="sc">*</span> H[i,k] <span class="sc">-</span>  H[j,i] <span class="sc">*</span> H[j,k] <span class="sc">-</span> H[k,i] <span class="sc">*</span> H[k,j]</span>
<span id="cb80-23"><a href="game-theory-and-replicator-dynamics.html#cb80-23" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb80-24"><a href="game-theory-and-replicator-dynamics.html#cb80-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-25"><a href="game-theory-and-replicator-dynamics.html#cb80-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-26"><a href="game-theory-and-replicator-dynamics.html#cb80-26" aria-hidden="true" tabindex="-1"></a>  parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">P3 =</span> P3)</span>
<span id="cb80-27"><a href="game-theory-and-replicator-dynamics.html#cb80-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># solve numerically</span></span>
<span id="cb80-28"><a href="game-theory-and-replicator-dynamics.html#cb80-28" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y =</span> x0, <span class="at">times =</span> times, </span>
<span id="cb80-29"><a href="game-theory-and-replicator-dynamics.html#cb80-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">func =</span> RE_3, <span class="at">parms =</span> parameters, </span>
<span id="cb80-30"><a href="game-theory-and-replicator-dynamics.html#cb80-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">method =</span> <span class="st">&quot;ode45&quot;</span>)</span>
<span id="cb80-31"><a href="game-theory-and-replicator-dynamics.html#cb80-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot and make into tidy form</span></span>
<span id="cb80-32"><a href="game-theory-and-replicator-dynamics.html#cb80-32" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">plot_ODE_output</span>(out)</span>
<span id="cb80-33"><a href="game-theory-and-replicator-dynamics.html#cb80-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb80-34"><a href="game-theory-and-replicator-dynamics.html#cb80-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-35"><a href="game-theory-and-replicator-dynamics.html#cb80-35" aria-hidden="true" tabindex="-1"></a><span class="co"># integrate the system above</span></span>
<span id="cb80-36"><a href="game-theory-and-replicator-dynamics.html#cb80-36" aria-hidden="true" tabindex="-1"></a>fivespp <span class="ot">&lt;-</span> <span class="fu">integrate_RE_3</span>(H, x0, <span class="at">maxtime =</span> <span class="dv">800</span>, <span class="at">steptime =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="Theoretical_Community_Ecology_files/figure-html/rehoi-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>And the rock-paper-scissors:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="game-theory-and-replicator-dynamics.html#cb81-1" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb81-2"><a href="game-theory-and-replicator-dynamics.html#cb81-2" aria-hidden="true" tabindex="-1"></a>              <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>,</span>
<span id="cb81-3"><a href="game-theory-and-replicator-dynamics.html#cb81-3" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-4"><a href="game-theory-and-replicator-dynamics.html#cb81-4" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb81-5"><a href="game-theory-and-replicator-dynamics.html#cb81-5" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> x0 <span class="sc">/</span> <span class="fu">sum</span>(x0)</span>
<span id="cb81-6"><a href="game-theory-and-replicator-dynamics.html#cb81-6" aria-hidden="true" tabindex="-1"></a>rps <span class="ot">&lt;-</span> <span class="fu">integrate_RE_3</span>(H, x0, <span class="at">maxtime =</span> <span class="dv">50</span>, <span class="at">steptime =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="Theoretical_Community_Ecology_files/figure-html/rpshoi-1.png" width="480" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-allesina2011competitive" class="csl-entry">
Allesina, S., and J. M. Levine. 2011. A competitive network theory of species diversity. Proceedings of the National Academy of Sciences 108:5638–5642.
</div>
<div id="ref-axelrod1981evolution" class="csl-entry">
Axelrod, R., and W. D. Hamilton. 1981. The evolution of cooperation. science 211:1390–1396.
</div>
<div id="ref-brandl2017distribution" class="csl-entry">
Brandl, F. 2017. The distribution of optimal strategies in symmetric zero-sum games. Games and Economic Behavior 104:674–680.
</div>
<div id="ref-clutton2009cooperation" class="csl-entry">
Clutton-Brock, T. 2009. Cooperation between non-kin in animal societies. Nature 462:51–57.
</div>
<div id="ref-fisher1995optimal" class="csl-entry">
Fisher, D. C., and R. B. Reeves. 1995. Optimal strategies for random tournament games. Linear Algebra and its Applications 217:83–85.
</div>
<div id="ref-grilli2017higher" class="csl-entry">
Grilli, J., G. Barabás, M. J. Michalska-Smith, and S. Allesina. 2017. Higher-order interactions stabilize dynamics in competitive network models. Nature 548:210.
</div>
<div id="ref-hofbauer1998evolutionary" class="csl-entry">
Hofbauer, J., and K. Sigmund. 1998. Evolutionary games and population dynamics. Cambridge University Press.
</div>
<div id="ref-smith1982evolution" class="csl-entry">
Maynard Smith, J. 1982. Evolution and the theory of games. Cambridge university press.
</div>
<div id="ref-nash1950equilibrium" class="csl-entry">
Nash, J. F. 1950. Equilibrium points in n-person games. Proceedings of the National Academy of Sciences 36:48–49.
</div>
<div id="ref-nowak1992evolutionary" class="csl-entry">
Nowak, M. A., and R. M. May. 1992. Evolutionary games and spatial chaos. Nature 359:826–829.
</div>
<div id="ref-nowak2005evolution" class="csl-entry">
Nowak, M. A., and K. Sigmund. 2005. Evolution of indirect reciprocity. Nature 437:1291–1298.
</div>
<div id="ref-page2002unifying" class="csl-entry">
Page, K. M., and M. A. Nowak. 2002. Unifying evolutionary dynamics. Journal of theoretical biology 219:93–98.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="predicting-coexistence-in-ecological-communities.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metapopulation-dynamics-on-networks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Theoretical_Community_Ecology.pdf", "Theoretical_Community_Ecology.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
