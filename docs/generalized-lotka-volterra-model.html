<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lecture 3 Generalized Lotka-Volterra model | Theoretical Community Ecology</title>
  <meta name="description" content="A graduate course in theoretical community ecology focusing on systems with multiple species." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Lecture 3 Generalized Lotka-Volterra model | Theoretical Community Ecology" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A graduate course in theoretical community ecology focusing on systems with multiple species." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lecture 3 Generalized Lotka-Volterra model | Theoretical Community Ecology" />
  
  <meta name="twitter:description" content="A graduate course in theoretical community ecology focusing on systems with multiple species." />
  

<meta name="author" content="Stefano Allesina" />


<meta name="date" content="2022-04-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="models-for-two-populations.html"/>
<link rel="next" href="stability-of-large-ecological-communities.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Theoretical Community Ecology</a></li>

<li class="divider"></li>
<li><a href="index.html#preliminaries">Preliminaries<span></span></a>
<ul>
<li><a href="index.html#approach-and-target-audience">Approach and target audience<span></span></a></li>
<li><a href="index.html#topics">Topics<span></span></a></li>
<li><a href="index.html#notation">Notation<span></span></a></li>
<li><a href="index.html#grading-and-code-of-conduct">Grading and code of conduct<span></span></a>
<ul>
<li><a href="index.html#homework-80">Homework (80%)<span></span></a></li>
<li><a href="index.html#review-20">Review (20%)<span></span></a></li>
<li><a href="index.html#accommodation-for-students-with-disabilities">Accommodation for students with disabilities<span></span></a></li>
</ul></li>
<li><a href="index.html#a-note-about-biographies">A note about biographies<span></span></a></li>
<li><a href="index.html#sources">Sources<span></span></a></li>
<li><a href="index.html#acknowledgements">Acknowledgements<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html"><i class="fa fa-check"></i><b>1</b> Models for a single population<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#types-of-dynamical-systems"><i class="fa fa-check"></i><b>1.1</b> Types of dynamical systems<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#initial-value-problems"><i class="fa fa-check"></i><b>1.2</b> Initial-value problems<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#solvable-model-exponential-growth"><i class="fa fa-check"></i><b>1.3</b> Solvable model: Exponential growth<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#solvable-model-logistic-growth"><i class="fa fa-check"></i><b>1.4</b> Solvable model: Logistic growth<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#qualitative-analysis-of-models-for-a-single-population"><i class="fa fa-check"></i><b>1.5</b> Qualitative analysis of models for a single population<span></span></a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#stability-using-derivatives"><i class="fa fa-check"></i><b>1.5.1</b> Stability using derivatives<span></span></a></li>
<li class="chapter" data-level="1.5.2" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#what-are-we-doing-when-probing-stability-using-derivatives"><i class="fa fa-check"></i><b>1.5.2</b> What are we doing when probing stability using derivatives?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#bifurcations"><i class="fa fa-check"></i><b>1.6</b> Bifurcations<span></span></a></li>
<li class="chapter" data-level="1.7" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#long-term-behavior-of-1-d-systems"><i class="fa fa-check"></i><b>1.7</b> Long term behavior of 1-D systems<span></span></a></li>
<li class="chapter" data-level="1.8" data-path="models-for-a-single-population.html"><a href="models-for-a-single-population.html#lyapunov-functions"><i class="fa fa-check"></i><b>1.8</b> Lyapunov functions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html"><i class="fa fa-check"></i><b>2</b> Models for two populations<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#qualitative-analysis-of-models-for-two-populations"><i class="fa fa-check"></i><b>2.1</b> Qualitative analysis of models for two populations<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#isoclines-of-null-growth"><i class="fa fa-check"></i><b>2.1.1</b> Isoclines of null growth<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#local-stability-analysis"><i class="fa fa-check"></i><b>2.2</b> Local stability analysis<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#stability-analysis-of-the-lotka-volterra-predator-prey-model"><i class="fa fa-check"></i><b>2.3</b> Stability analysis of the Lotka-Volterra Predator-Prey model<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#constant-of-motion-for-lotka-volterra-predator-prey"><i class="fa fa-check"></i><b>2.3.1</b> Constant of motion for Lotka-Volterra Predator-Prey<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="models-for-two-populations.html"><a href="models-for-two-populations.html#analysis-of-predator-prey-model-with-logistic-growth-for-the-prey"><i class="fa fa-check"></i><b>2.3.2</b> Analysis of Predator-Prey model with logistic growth for the prey<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html"><i class="fa fa-check"></i><b>3</b> Generalized Lotka-Volterra model<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#formulation"><i class="fa fa-check"></i><b>3.1</b> Formulation<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#a-single-population"><i class="fa fa-check"></i><b>3.2</b> A single population<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#metapopulation-dynamics"><i class="fa fa-check"></i><b>3.2.1</b> Metapopulation dynamics<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#s-i-s-model"><i class="fa fa-check"></i><b>3.2.2</b> S-I-S model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#multi-species-dynamics"><i class="fa fa-check"></i><b>3.3</b> Multi-species dynamics<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#existence-of-an-equilibrium"><i class="fa fa-check"></i><b>3.3.1</b> Existence of an equilibrium<span></span></a></li>
<li class="chapter" data-level="3.3.2" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#stability-of-the-coexistence-equilibrium"><i class="fa fa-check"></i><b>3.3.2</b> Stability of the coexistence equilibrium<span></span></a></li>
<li class="chapter" data-level="3.3.3" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#types-of-dynamics"><i class="fa fa-check"></i><b>3.3.3</b> Types of dynamics<span></span></a></li>
<li class="chapter" data-level="3.3.4" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#the-equilibrium-is-the-time-average"><i class="fa fa-check"></i><b>3.3.4</b> The equilibrium is the time-average<span></span></a></li>
<li class="chapter" data-level="3.3.5" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#lyapunov-diagonal-stability-and-global-stability"><i class="fa fa-check"></i><b>3.3.5</b> Lyapunov diagonal stability and global stability<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#macarthurs-consumer-resource-model"><i class="fa fa-check"></i><b>3.4</b> MacArthur’s consumer-resource model<span></span></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#existence-of-an-equilibrium-1"><i class="fa fa-check"></i><b>3.4.1</b> Existence of an equilibrium<span></span></a></li>
<li class="chapter" data-level="3.4.2" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#global-stability-1"><i class="fa fa-check"></i><b>3.4.2</b> Global stability<span></span></a></li>
<li class="chapter" data-level="3.4.3" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#separation-of-time-scales"><i class="fa fa-check"></i><b>3.4.3</b> Separation of time-scales<span></span></a></li>
<li class="chapter" data-level="3.4.4" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#lyapunov-function-for-symmetric-lotka-volterra"><i class="fa fa-check"></i><b>3.4.4</b> Lyapunov function for symmetric Lotka-Volterra<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="generalized-lotka-volterra-model.html"><a href="generalized-lotka-volterra-model.html#further-readings"><i class="fa fa-check"></i><b>3.5</b> Further readings<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html"><i class="fa fa-check"></i><b>4</b> Stability of large ecological communities<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#complexity-and-stability"><i class="fa fa-check"></i><b>4.1</b> Complexity and stability<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#the-stability-of-random-ecosystems"><i class="fa fa-check"></i><b>4.2</b> The stability of random ecosystems<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#accounting-for-interaction-types"><i class="fa fa-check"></i><b>4.3</b> Accounting for interaction types<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#symmetric-matrices"><i class="fa fa-check"></i><b>4.4</b> Symmetric matrices<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#covariance-matrices"><i class="fa fa-check"></i><b>4.5</b> Covariance matrices<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#small-rank-perturbations"><i class="fa fa-check"></i><b>4.6</b> Small-rank perturbations<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#structured-matrices"><i class="fa fa-check"></i><b>4.7</b> Structured matrices<span></span></a></li>
<li class="chapter" data-level="4.8" data-path="stability-of-large-ecological-communities.html"><a href="stability-of-large-ecological-communities.html#further-readings-1"><i class="fa fa-check"></i><b>4.8</b> Further readings<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ecological-assembly.html"><a href="ecological-assembly.html"><i class="fa fa-check"></i><b>5</b> Ecological assembly<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="ecological-assembly.html"><a href="ecological-assembly.html#assembly"><i class="fa fa-check"></i><b>5.1</b> Assembly<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ecological-assembly.html"><a href="ecological-assembly.html#what-makes-the-study-of-assembly-difficult"><i class="fa fa-check"></i><b>5.1.1</b> What makes the study of assembly difficult?<span></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="ecological-assembly.html"><a href="ecological-assembly.html#ecological-assembly-without-tears"><i class="fa fa-check"></i><b>5.1.2</b> Ecological assembly without tears<span></span></a></li>
<li class="chapter" data-level="5.1.3" data-path="ecological-assembly.html"><a href="ecological-assembly.html#top-down-and-bottom-up-assembly"><i class="fa fa-check"></i><b>5.1.3</b> Top-down and bottom-up assembly<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ecological-assembly.html"><a href="ecological-assembly.html#modeling-invasions"><i class="fa fa-check"></i><b>5.2</b> Modeling invasions<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ecological-assembly.html"><a href="ecological-assembly.html#invasions-in-multispecies-communities"><i class="fa fa-check"></i><b>5.2.1</b> Invasions in multispecies communities<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="ecological-assembly.html"><a href="ecological-assembly.html#lyapunov-stability-and-saturated-equilibria"><i class="fa fa-check"></i><b>5.2.2</b> Lyapunov stability and saturated equilibria<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ecological-assembly.html"><a href="ecological-assembly.html#top-down-assembly"><i class="fa fa-check"></i><b>5.3</b> Top-down assembly<span></span></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ecological-assembly.html"><a href="ecological-assembly.html#a-trivial-case"><i class="fa fa-check"></i><b>5.3.1</b> A trivial case<span></span></a></li>
<li class="chapter" data-level="5.3.2" data-path="ecological-assembly.html"><a href="ecological-assembly.html#simulating-final-composition"><i class="fa fa-check"></i><b>5.3.2</b> Simulating final composition<span></span></a></li>
<li class="chapter" data-level="5.3.3" data-path="ecological-assembly.html"><a href="ecological-assembly.html#a-random-zoo"><i class="fa fa-check"></i><b>5.3.3</b> A random zoo<span></span></a></li>
<li class="chapter" data-level="5.3.4" data-path="ecological-assembly.html"><a href="ecological-assembly.html#a-random-zoo-in-the-wild"><i class="fa fa-check"></i><b>5.3.4</b> A random zoo in the wild<span></span></a></li>
<li class="chapter" data-level="5.3.5" data-path="ecological-assembly.html"><a href="ecological-assembly.html#assembly-and-saturated-equilibrium"><i class="fa fa-check"></i><b>5.3.5</b> Assembly and saturated equilibrium<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ecological-assembly.html"><a href="ecological-assembly.html#network-spandrels"><i class="fa fa-check"></i><b>5.4</b> Network spandrels<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="ecological-assembly.html"><a href="ecological-assembly.html#bottom-up-assembly"><i class="fa fa-check"></i><b>5.5</b> Bottom-up assembly<span></span></a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="ecological-assembly.html"><a href="ecological-assembly.html#an-assembly-graph"><i class="fa fa-check"></i><b>5.5.1</b> An assembly graph<span></span></a></li>
<li class="chapter" data-level="5.5.2" data-path="ecological-assembly.html"><a href="ecological-assembly.html#how-many-invasions"><i class="fa fa-check"></i><b>5.5.2</b> How many invasions?<span></span></a></li>
<li class="chapter" data-level="5.5.3" data-path="ecological-assembly.html"><a href="ecological-assembly.html#properties-of-the-assembly-graph"><i class="fa fa-check"></i><b>5.5.3</b> Properties of the assembly graph<span></span></a></li>
<li class="chapter" data-level="5.5.4" data-path="ecological-assembly.html"><a href="ecological-assembly.html#assembly-graphs-for-glv"><i class="fa fa-check"></i><b>5.5.4</b> Assembly graphs for GLV<span></span></a></li>
<li class="chapter" data-level="5.5.5" data-path="ecological-assembly.html"><a href="ecological-assembly.html#relationship-with-lyapunov-functions"><i class="fa fa-check"></i><b>5.5.5</b> Relationship with Lyapunov functions<span></span></a></li>
<li class="chapter" data-level="5.5.6" data-path="ecological-assembly.html"><a href="ecological-assembly.html#how-many-assembly-endpoints"><i class="fa fa-check"></i><b>5.5.6</b> How many assembly endpoints?<span></span></a></li>
<li class="chapter" data-level="5.5.7" data-path="ecological-assembly.html"><a href="ecological-assembly.html#build-your-own-assembly-graph"><i class="fa fa-check"></i><b>5.5.7</b> Build your own assembly graph!<span></span></a></li>
<li class="chapter" data-level="5.5.8" data-path="ecological-assembly.html"><a href="ecological-assembly.html#conclusions"><i class="fa fa-check"></i><b>5.5.8</b> Conclusions<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html"><i class="fa fa-check"></i><b>6</b> Predicting coexistence in ecological communities<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#background-diversity-and-ecosystem-functioning"><i class="fa fa-check"></i><b>6.1</b> Background: Diversity and Ecosystem Functioning<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#synthetic-communities-using-the-glv-model"><i class="fa fa-check"></i><b>6.2</b> Synthetic communities using the GLV model<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#total-biomass"><i class="fa fa-check"></i><b>6.3</b> Total biomass<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#hyperplanes"><i class="fa fa-check"></i><b>6.4</b> Hyperplanes<span></span></a></li>
<li class="chapter" data-level="6.5" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#fitting-real-data"><i class="fa fa-check"></i><b>6.5</b> Fitting real data<span></span></a></li>
<li class="chapter" data-level="6.6" data-path="predicting-coexistence-in-ecological-communities.html"><a href="predicting-coexistence-in-ecological-communities.html#predicting-real-data-out-of-fit"><i class="fa fa-check"></i><b>6.6</b> Predicting real data out of fit<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html"><i class="fa fa-check"></i><b>7</b> Game theory and replicator dynamics<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#game-theory"><i class="fa fa-check"></i><b>7.1</b> Game theory<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#two-player-matrix-games"><i class="fa fa-check"></i><b>7.2</b> Two-player matrix games<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#example-the-prisoners-dilemma"><i class="fa fa-check"></i><b>7.2.1</b> Example: the prisoner’s dilemma<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#mixed-strategies"><i class="fa fa-check"></i><b>7.3</b> Mixed strategies<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#nash-equilibria"><i class="fa fa-check"></i><b>7.4</b> Nash Equilibria<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#evolutionary-stable-strategies"><i class="fa fa-check"></i><b>7.5</b> Evolutionary stable strategies<span></span></a></li>
<li class="chapter" data-level="7.6" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#replicator-dynamics"><i class="fa fa-check"></i><b>7.6</b> Replicator dynamics<span></span></a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#invariants"><i class="fa fa-check"></i><b>7.6.1</b> Invariants<span></span></a></li>
<li class="chapter" data-level="7.6.2" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#rock-paper-scissor"><i class="fa fa-check"></i><b>7.6.2</b> Rock-paper-scissor<span></span></a></li>
<li class="chapter" data-level="7.6.3" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#equivalence-with-glv"><i class="fa fa-check"></i><b>7.6.3</b> Equivalence with GLV<span></span></a></li>
<li class="chapter" data-level="7.6.4" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#hypertournament-games"><i class="fa fa-check"></i><b>7.6.4</b> Hypertournament games<span></span></a></li>
<li class="chapter" data-level="7.6.5" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#lyapunov-function"><i class="fa fa-check"></i><b>7.6.5</b> Lyapunov function<span></span></a></li>
<li class="chapter" data-level="7.6.6" data-path="game-theory-and-replicator-dynamics.html"><a href="game-theory-and-replicator-dynamics.html#higher-order-interactions"><i class="fa fa-check"></i><b>7.6.6</b> Higher-order interactions<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html"><i class="fa fa-check"></i><b>8</b> Metapopulation dynamics on networks<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#metapopulations"><i class="fa fa-check"></i><b>8.1</b> Metapopulations<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#hanski-ovaskainen-2000"><i class="fa fa-check"></i><b>8.2</b> Hanski Ovaskainen 2000<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#sis-on-a-contact-network"><i class="fa fa-check"></i><b>8.3</b> SIS on a contact network<span></span></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#the-full-model"><i class="fa fa-check"></i><b>8.3.1</b> The full model<span></span></a></li>
<li class="chapter" data-level="8.3.2" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#the-mean-field-approximation"><i class="fa fa-check"></i><b>8.3.2</b> The mean-field approximation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="metapopulation-dynamics-on-networks.html"><a href="metapopulation-dynamics-on-networks.html#metapopulations-on-randomly-distributed-patches"><i class="fa fa-check"></i><b>8.4</b> Metapopulations on randomly distributed patches<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html"><i class="fa fa-check"></i><b>9</b> Quasi-polynomial systems<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#global-stability-2"><i class="fa fa-check"></i><b>9.1</b> Global stability<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#from-qp-to-glv"><i class="fa fa-check"></i><b>9.2</b> From QP to GLV<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#stability-of-glv"><i class="fa fa-check"></i><b>9.3</b> Stability of GLV<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#stability-for-glv-embeddings"><i class="fa fa-check"></i><b>9.4</b> Stability for GLV embeddings<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#numerical-analysis"><i class="fa fa-check"></i><b>9.5</b> Numerical analysis<span></span></a></li>
<li class="chapter" data-level="9.6" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#systems-with-many-equations"><i class="fa fa-check"></i><b>9.6</b> Systems with many equations<span></span></a></li>
<li class="chapter" data-level="9.7" data-path="quasi-polynomial-systems.html"><a href="quasi-polynomial-systems.html#glv-embedding-for-non-qp-systems"><i class="fa fa-check"></i><b>9.7</b> GLV embedding for non-QP systems<span></span></a></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Theoretical Community Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="generalized-lotka-volterra-model" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Lecture 3</span> Generalized Lotka-Volterra model<a href="generalized-lotka-volterra-model.html#generalized-lotka-volterra-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Lesson plan</strong>:</p>
<ol style="list-style-type: decimal">
<li>We start by discussing the Generalized Lotka-Volterra model, which we are going to see over and over again in the remainder of the lectures.</li>
<li>We discuss the existence of a “coexistence” equilibrium, as well as its local stability.</li>
<li>We show that the GLV model can give rise to all sort of dynamics, including limit cycles and chaos.</li>
<li>Despite this fact, the persistence of all species requires the existence of a feasible equilibrium, which is the time-average of the species’ densities.</li>
<li>We introduce D-stability, allowing us to write a Lyapunov function to determine global stability in GLV models.</li>
<li>We conclude by analyzing the MacArthur’s consumer-resource model, highlighting its deep connection to GLV.</li>
</ol>
<div id="formulation" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Formulation<a href="generalized-lotka-volterra-model.html#formulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can write the Generalized Lotka-Volterra model in a compact form as:</p>
<p><span class="math display">\[
\dfrac{dx(t)}{dt} = D(x(t))(r + A x(t))
\]</span></p>
<p>where <span class="math inline">\(x(t)\)</span> is a (column) vector of length <span class="math inline">\(n\)</span> containing the densities of all populations <span class="math inline">\(1, \ldots, n\)</span> at time <span class="math inline">\(t\)</span>, <span class="math inline">\(r\)</span> is a vector of “intrinsic growth rates” (or death rates, when negative), measuring the growth (decline) of population <span class="math inline">\(i\)</span> when grown alone at low density, and <span class="math inline">\(A\)</span> is a <span class="math inline">\(n \times n\)</span> matrix of interaction coefficients. We use <span class="math inline">\(D(x)\)</span> to denote the diagonal matrix with <span class="math inline">\(x\)</span> on the diagonal.</p>
</div>
<div id="a-single-population" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> A single population<a href="generalized-lotka-volterra-model.html#a-single-population" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The simplest case to study is that of a single population, in which case the equation becomes that of the logistic growth:</p>
<p><span class="math display">\[
\dfrac{dx(t)}{dt} = x(t)(\rho + \alpha x(t))
\]</span>
Note that whenever <span class="math inline">\(\rho &gt; 0\)</span> and <span class="math inline">\(\alpha &lt; 0\)</span> there exists a feasible equilibrium <span class="math inline">\(x^\star = \rho / \alpha\)</span>. The equilibrium is globally stable (as shown using either a quadratic Lyapunov function, or the <span class="math inline">\(V = x - x^\star - x^\star \log (x / x^\star)\)</span>). As we’ve seen before, this is a separable ODE, with solution:</p>
<p><span class="math display">\[
x(t) = \frac{\rho\, {x_0}\, e^{\rho t}}{\rho- \alpha\, {x_0} \left(e^{\rho t}-1\right)}
\]</span></p>
<div id="metapopulation-dynamics" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Metapopulation dynamics<a href="generalized-lotka-volterra-model.html#metapopulation-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider a fragmented landscape in which habitable patches are connected by dispersal (for simplicity, suppose that all patches are reachable from any other). Call <span class="math inline">\(p(t)\)</span> the proportion of patches occupied by the species of interest at time <span class="math inline">\(t\)</span>, and assume that a) an empty patch (the proportion of empty patches is <span class="math inline">\(1 - p(t)\)</span>) is colonized by the populations in other patches with rate <span class="math inline">\(\gamma\, p(t)\)</span>, where <span class="math inline">\(\gamma\)</span> is the “colonization rate”, and b) that occupied patches become empty at rate <span class="math inline">\(\epsilon\, p(t)\)</span> (“extinction rate”). We want to model the proportion of patches occupied by the population at time <span class="math inline">\(t\)</span> <span class="citation">(<a href="#ref-levins1969some" role="doc-biblioref">Levins 1969</a>)</span>:</p>
<p><span class="math display">\[
\dfrac{d p(t)}{dt} = \gamma\, p(t)(1 - p(t)) - \epsilon\, p(t) = p(t) ((\gamma - \epsilon) - \gamma\,  p(t))
\]</span></p>
<p>which is equivalent to the logistic equation above with <span class="math inline">\(\rho = \gamma -\epsilon\)</span> and <span class="math inline">\(\alpha = -\gamma\)</span>. As such, asymptotically the proportion of patches occupied by the population will be <span class="math inline">\(-\rho/\alpha = (\gamma -\epsilon) / \gamma = 1 - \epsilon / \gamma\)</span>.</p>
</div>
<div id="s-i-s-model" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> S-I-S model<a href="generalized-lotka-volterra-model.html#s-i-s-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider a population of individuals, each of which can be in one of two states: susceptible to a disease, or infective/infected. Call <span class="math inline">\(S(t)\)</span> the proportion of susceptible individuals at time <span class="math inline">\(t\)</span>, and <span class="math inline">\(I(t)\)</span> the proportion of infected individuals, with <span class="math inline">\(S(t) + I(t) = 1\)</span>. When individuals meet, an infected individual can transmit the disease to susceptibles with rate <span class="math inline">\(\beta\)</span>; infected individuals recover from the disease with rate <span class="math inline">\(\gamma\)</span>, and return susceptible. We can write the system of equations:</p>
<p><span class="math display">\[
\begin{cases}
\dfrac{d S(t)}{dt} = -\beta S(t) I(t) + \gamma I(t)\\
\dfrac{d I(t)}{dt} = \beta S(t) I(t) - \gamma I(t)
\end{cases}
\]</span></p>
<p>Note that the equations sum to zero, because the quantity <span class="math inline">\(S(t)+I(t)=1\)</span> is conserved through the dynamics. Take the second equation, and substitute <span class="math inline">\(S(t) = 1 - I(t)\)</span>; rearranging:</p>
<p><span class="math display">\[
\dfrac{d I(t)}{dt} = \beta (1-I(t)) I(t) - \gamma I(t) = I(t)(\beta - \gamma -\beta I(t))
\]</span></p>
<p>which is again the equation for the logistic growth with <span class="math inline">\(\rho = \beta - \gamma\)</span> and <span class="math inline">\(\alpha = -\beta\)</span>. As such, provided that <span class="math inline">\(\beta -\gamma &gt; 0\)</span>, asymptotically a fraction <span class="math inline">\((\beta - \gamma) / \beta\)</span> of individuals will be infected. The condition <span class="math inline">\(\beta -\gamma &gt; 0 \to \beta &gt; \gamma \to \beta/ \gamma &gt; 1\)</span> is often written as <span class="math inline">\(\mathcal R_0 = \beta/ \gamma &gt; 1\)</span>.</p>
</div>
</div>
<div id="multi-species-dynamics" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Multi-species dynamics<a href="generalized-lotka-volterra-model.html#multi-species-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="existence-of-an-equilibrium" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Existence of an equilibrium<a href="generalized-lotka-volterra-model.html#existence-of-an-equilibrium" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Returning to the multi-species system, and in analogy with the single species model, we can look for stationary points (fixed points, equilibria). If the matrix <span class="math inline">\(A\)</span> is not singular, then we can look for a solution of <span class="math inline">\(r + Ax = 0\)</span> that has positive components (called a <strong>feasible equilibrium</strong>). <strong>If such point exists, it is unique</strong> and is the solution of <span class="math inline">\(Ax^\star = -r\)</span>, <span class="math inline">\(x^\star = -A^{-1}r\)</span>.</p>
<p>Suppose that the GLV has no feasible equilibrium. Then all trajectories (if bounded; some could grow to infinity) reach the boundary of <span class="math inline">\(\mathbb R^n_{0+}\)</span>. Practically, this means that <strong>to ensure coexistence of all species, it is necessary to have an equilibrium in the interior <span class="math inline">\(\mathbb R^n_{+}\)</span></strong>. For a proof, see Theorem 5.2.1 in <span class="citation">Hofbauer and Sigmund (<a href="#ref-hofbauer1998evolutionary" role="doc-biblioref">1998</a>)</span>.</p>
</div>
<div id="stability-of-the-coexistence-equilibrium" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Stability of the coexistence equilibrium<a href="generalized-lotka-volterra-model.html#stability-of-the-coexistence-equilibrium" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose that a feasible equilibrium <span class="math inline">\(x^\star\)</span> exists. For the GLV model, the Jacobian is easy to compute:</p>
<p><span class="math display">\[
J_{ij} = \frac{\partial f_i}{\partial x_j} = A_{ij} x_i
\]</span></p>
<p>and</p>
<p><span class="math display">\[
J_{ii} = \frac{\partial f_i}{\partial x_i} = r_i + \sum_j A_{ij} x_j + A_{ii} x_i
\]</span></p>
<p>At equilibrium <span class="math inline">\(r_i + \sum_j A_{ij} x_j = 0\)</span>, and therefore:</p>
<p><span class="math display">\[
M = \left. {J} \right|_{ {x}^\star} = D(x^\star)A
\]</span></p>
<p>If the eigenvalues of <span class="math inline">\(M\)</span> have all negative real part, then <span class="math inline">\(x^\star\)</span> is locally asymptotically stable.</p>
<div class="boxmath">
<p><strong>D-stability and Lyapunov-Diagonal Stability</strong></p>
<p>A matrix <span class="math inline">\(A\)</span> is called <em>stable</em> if all its eigenvalues have negative real part. A matrix <span class="math inline">\(A\)</span> is called <em>D-stable</em> if <span class="math inline">\(D(x) A\)</span> is stable for every choice of <span class="math inline">\(x\)</span> such <span class="math inline">\(x_i &gt; 0\; \forall i\)</span>. While conditions for <em>D-stability</em> are not known for matrices of size greater than 3, a <strong>sufficient</strong> condition for <em>D-stability</em> is that there exists a diagonal matrix <span class="math inline">\(D\)</span> with positive elements on the diagonal such that <span class="math inline">\(DA + A^T D\)</span> is negative definite (i.e., has negative eigenvalues).</p>
<p><strong>Consequences for Lotka-Volterra dynamics</strong></p>
<ul>
<li>If a matrix <span class="math inline">\(A\)</span> is stable and symmetric, it is <em>D-stable</em> (just take <span class="math inline">\(D = I\)</span>).</li>
<li>Take a GLV system with a stable, non symmetric matrix <span class="math inline">\(A\)</span> such that <span class="math inline">\(A + A^T\)</span> is negative definite. Then any feasible equilibrium is locally stable: we have <span class="math inline">\(M = D(x^\star)A\)</span>, but if <span class="math inline">\(A\)</span> is <em>D-stable</em> then <span class="math inline">\(M\)</span> is stable.</li>
</ul>
</div>
</div>
<div id="types-of-dynamics" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Types of dynamics<a href="generalized-lotka-volterra-model.html#types-of-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As we’ve seen before, for a single population, there are only three types of dynamics that can be displayed by a GLV model with a single species: either the population grows to infinity, shrinks to zero, or asymptotically reaches a steady state.</p>
<p><span class="citation">Smale (<a href="#ref-smale1976differential" role="doc-biblioref">1976</a>)</span> and <span class="citation">Hirsch (<a href="#ref-hirsch1982systems" role="doc-biblioref">1982</a>)</span> showed that limit cycles are possible for three or more species, and that any dynamics can be found for competitive GLV systems with five or more species.</p>
<p>A few examples taken from <span class="citation">Barabás et al. (<a href="#ref-barabas2016effect" role="doc-biblioref">2016</a>)</span>. First, a competitive system in which a feasible equilibrium does not exist, leading to the extinction of a species. Take</p>
<p><span class="math display">\[
r = \begin{pmatrix}
1\\
1\\
1
\end{pmatrix}\;\;A = -\begin{pmatrix}
10 &amp; 9 &amp; 5 \\
9 &amp; 10 &amp; 9\\
5 &amp; 9 &amp; 10
\end{pmatrix}
\]</span></p>
<p>The coexistence equilibrium is not feasible:</p>
<p><span class="math display">\[
-A^{-1}r = \begin{pmatrix}
-\dfrac{1}{12}\\
\dfrac{1}{4}\\
-\dfrac{1}{12}\\
\end{pmatrix}
\]</span></p>
<p>and as such dynamics either explode or lead to a boundary equilibrium:</p>
<p><img src="Theoretical_Community_Ecology_files/figure-html/glvex1-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Showing that species 2 goes extinct. Then, a case in which the equilibrium exists, and is attractive (stable). Take:</p>
<p><span class="math display">\[
r = \begin{pmatrix}
10\\
10\\
10
\end{pmatrix}\;\;A = -\begin{pmatrix}
10 &amp; 7 &amp; 12 \\
15 &amp; 10 &amp; 8\\
7 &amp; 11 &amp; 10
\end{pmatrix}
\]</span></p>
<p>Now the coexistence equilibrium is feasible:</p>
<p><span class="math display">\[
-A^{-1}r = \dfrac{1}{301}\begin{pmatrix}
50\\
110\\
145\\
\end{pmatrix}
\]</span></p>
<p>and locally stable (the eigenvalues of <span class="math inline">\(D(x^\star) A)\)</span> have negative real part). Hence, there are initial conditions for which we will eventually converge to the equilibrium:</p>
<p><img src="Theoretical_Community_Ecology_files/figure-html/glvex2-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>With three competitors we can find stable limit cycles (this requires a feasible, unstable equilibrium):</p>
<p><img src="Theoretical_Community_Ecology_files/figure-html/glvex3-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>And with four or more species we can have chaos (also here we need a feasible, unstable coexistence equilibrium):</p>
<p><img src="Theoretical_Community_Ecology_files/figure-html/glvex4-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="the-equilibrium-is-the-time-average" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> The equilibrium is the time-average<a href="generalized-lotka-volterra-model.html#the-equilibrium-is-the-time-average" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose that <span class="math inline">\(x(t)\)</span> has a periodic orbit of period <span class="math inline">\(T\)</span> (i.e., we assume <span class="math inline">\(x(0) = x(T)\)</span>). Further, assume that the GLV has a feasible, interior equilibrium <span class="math inline">\(x^\star\)</span>. We want to calculate the average density for each species:</p>
<p><span class="math display">\[
\frac{1}{T} \int_0^T x(t) dt
\]</span></p>
<p>First, we assume that <span class="math inline">\(x(t) &gt; 0\)</span> and write the dynamics of its logarithm:</p>
<p><span class="math display">\[
\dfrac{d \log(x_i(t))}{dt} = \dfrac{1}{x_i(t)}\dfrac{d x_i(t)}{dt} = r_i + \sum_j A_{ij} x_j(t)
\]</span></p>
<p>In vector form:</p>
<p><span class="math display">\[
\dfrac{d \log x(t)}{d t} = r + A x(t)
\]</span></p>
<p>Compute the average on both sides:</p>
<p><span class="math display">\[
\frac{1}{T}\int_0^T \frac{d \log(x(t))}{dt} dt= \frac{1}{T}\int_0^T \left(r + Ax \right) dt
\]</span></p>
<p>yielding:</p>
<p><span class="math display">\[
\frac{1}{T}(\log(x(T)) - \log(x(0))) = 0 = r + A \left( \frac{1}{T} \int_0^T x(t) dt \right)
\]</span>
Note that the l.h.s. is zero because <span class="math inline">\(x(0) = x(T)\)</span>. Now rearrange:</p>
<p><span class="math display">\[
-r = A \left( \frac{1}{T} \int_0^T x(t) dt \right)
\]</span></p>
<p>Multiplying by the matrix inverse:</p>
<p><span class="math display">\[
-A^{-1} r = x^\star =  \frac{1}{T} \int_0^T x(t) dt
\]</span></p>
<p>showing that <strong>the average density is</strong> in fact <strong>the equilibrium</strong>. With a similar argument, one can prove that if the trajectory stays in a compact space (i.e., in case of chaotic attractors), then long-time average is still <span class="math inline">\(x^\star\)</span>.</p>
</div>
<div id="lyapunov-diagonal-stability-and-global-stability" class="section level3 hasAnchor" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> Lyapunov diagonal stability and global stability<a href="generalized-lotka-volterra-model.html#lyapunov-diagonal-stability-and-global-stability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose that there is a positive diagonal matrix <span class="math inline">\(D(w)\)</span> such that <span class="math inline">\(D(w) A + A^T D(w)\)</span> is negative definite (i.e., has only negative eigenvalues; the eigenvalues are real because the matrix is symmetric). Then <span class="math inline">\(A\)</span> is <strong>Lyapunov-diagonally stable</strong>. If this is the case, then <span class="math inline">\(A\)</span> is stable, and any <span class="math inline">\(D(w) A\)</span> with <span class="math inline">\(D(w)\)</span> positive is also stable (called <span class="math inline">\(D-\)</span>stability).</p>
<p>Further, suppose that the GLV system with parameters <span class="math inline">\(A\)</span> and <span class="math inline">\(r\)</span> has a feasible equilibrium point <span class="math inline">\(x^\star\)</span>. Then the function:</p>
<p><span class="math display">\[
V(x(t)) = 1^T D(w) \left( x(t) -x^\star -D(x^\star)\log (x(t) / x^\star)\right)
\]</span></p>
<p>is a Lyapunov function for the GLV system. It is clear that <span class="math inline">\(V(x(t))\)</span> is positive everywhere in the positive orthant besides at equilibrium. Then, we need to show that the function decreases along the trajectories of the system.</p>
<p>To prove this point, we start from <span class="math inline">\(r = -A x^\star\)</span>. Substituting, we can write the GLV system as <span class="math inline">\(dx(t)/dt = D(x)A(x - x^\star)\)</span>; similarly, we can write <span class="math inline">\(d \log x(t)/dt = A(x - x^\star)\)</span>. Taking the derivative of <span class="math inline">\(V\)</span> with respect to time:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{d V(x(t))}{dt} &amp;= 1^T D(w) \left(\frac{d x(t)}{dt} - D(x^\star) \frac{d \log x(t)}{dt} \right)\\
&amp;= 1^T D(w) \left(D(x)(A (x - x^\star)  - D(x^\star) A (x - x^\star) \right)\\
&amp;= 1^T D(w) \left(D(x - x^\star)  A (x - x^\star) \right)\\
&amp;= 1^T \left(D(x - x^\star)  D(w) A (x - x^\star) \right)\\
&amp;= (x - x^\star)^T D(w) A (x - x^\star)\\
&amp;= \frac{1}{2}(x - x^\star)^T  (D(w) A + A^T D(w)) (x - x^\star)\\
\end{aligned}
\]</span></p>
<p>A matrix <span class="math inline">\(B\)</span> is negative definite if <span class="math inline">\(y^T B y &lt; 0\)</span> for all <span class="math inline">\(y \neq 0\)</span>. As such, if <span class="math inline">\(D(w) A + A^T D(w)\)</span>, then <span class="math inline">\(\frac{d V(x(t))}{dt} \leq 0\)</span>, i.e., will decrease in time (starting from any <span class="math inline">\(x(0)\)</span>) until the equilibrium <span class="math inline">\(x^\star\)</span> is reached.</p>
<p>The results above show that <strong>if <span class="math inline">\(A\)</span> is Lyapunov diagonally-stable and a feasible equilibrium <span class="math inline">\(x^\star\)</span> exists, then all trajectories starting at a positive density will converge to the equilibrium</strong>. This property is often used to prove <strong>global stability</strong>.</p>
</div>
</div>
<div id="macarthurs-consumer-resource-model" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> MacArthur’s consumer-resource model<a href="generalized-lotka-volterra-model.html#macarthurs-consumer-resource-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="boxhistory">
<p><strong>History: Robert H. MacArthur (1930-1972)</strong></p>
<p><img src="img/MacArthur.jpg" width="25%" style="display: block; margin: auto;" /></p>
<p>Robert MacArthur was born in Toronto, and moved to Vermont when his father (a geneticist) became a professor at Marlboro College.</p>
<p>He studied mathematics first at Marlboro College and then at Brown University. He enrolled as a PhD student in mathematics at Yale, but quickly switched to studying ecology with George Evelyn Hutchinson.</p>
<p>He was a professor first at the University of Pennsylvania and then at Princeton University. In his brief career (he died at age 42) he revolutionized ecology, by making it into a rigorous, predictive science based on general principles.</p>
<p>He is recognized for developing the <em>Theory of Island Biogeography</em> (with E. O. Wilson, <span class="citation">MacArthur and Wilson (<a href="#ref-macarthur2001theory" role="doc-biblioref">2001</a>)</span>), the investigation of limiting similarity (with R. Levins, <span class="citation">MacArthur and Levins (<a href="#ref-macarthur1967limiting" role="doc-biblioref">1967</a>)</span>), the contributions to the complexity-stability debate (<span class="citation">MacArthur (<a href="#ref-macarthur1955fluctuations" role="doc-biblioref">1955</a>)</span>, see next lecture). The consumer-resource model he proposed in 1969 now bears his name (published also in <span class="citation">MacArthur (<a href="#ref-macarthur1970species" role="doc-biblioref">1970</a>)</span> in a longer form—the first paper in the journal Theoretical Population Biology!).</p>
</div>
<p>MacArthur considered a system with two classes of equations: those describing the dynamics of consumers <span class="math inline">\((x_i)\)</span> and resources (<span class="math inline">\(y_i\)</span>). Resources do not interact with each other (only with themselves), and consumers interact only through the sharing of resources. Several parameterizations are possible—here we choose a simple formulation that retains the main features of the model (see <span class="citation">Case and Casten (<a href="#ref-case1979global" role="doc-biblioref">1979</a>)</span> for a slightly more general model):</p>
<p><span class="math display">\[
\begin{cases}
\dfrac{d y_i}{dt} = y_i \left(r_i - b_i\, y_i - \sum_j P_{ij}\, x_j \right)\\
\dfrac{d x_j}{dt} = x_j \left(- m_j + \sum_i v_j\, P_{ij}\, y_i \right)\\
\end{cases}
\]</span></p>
<p>In the absence of consumers, each resource grows logistically. In the absence of resources, consumers go extinct. In the model, all parameters are taken to be positive: <span class="math inline">\(r_i\)</span> is the growth rate for resource <span class="math inline">\(i\)</span>, <span class="math inline">\(b_i\)</span> models its self-regulation; <span class="math inline">\(m_j\)</span> is the death rate of consumer <span class="math inline">\(j\)</span>, and <span class="math inline">\(v_j\)</span> models the efficiency of transformation of resources into consumers. The matrix <span class="math inline">\(P\)</span> is in general rectangular (<span class="math inline">\(n \times k\)</span>, where <span class="math inline">\(n\)</span> is the number of resources and <span class="math inline">\(k\)</span> that of consumers).</p>
<div class="boxmath">
<p><strong>Block matrices</strong></p>
<p>Any matrix can be rewritten as a series of smaller matrices stitched together. For square matrices, it is often convenient to partition a matrix into blocks such that diagonal blocks are square matrices and off-diagonal blocks are (in general) rectangular.</p>
<p>For example:</p>
<p><span class="math display">\[
M = \begin{pmatrix}
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5\\
6 &amp; 7 &amp; 8 &amp; 9 &amp; 10\\
11 &amp; 12 &amp; 13 &amp; 14 &amp; 15\\
16 &amp; 17 &amp; 18 &amp; 19 &amp; 20\\
21 &amp; 22 &amp; 23 &amp; 24 &amp; 25\\
\end{pmatrix}
\]</span></p>
<p>Can be written as:</p>
<p><span class="math display">\[
M = \begin{pmatrix}
M_{11} &amp; M_{12}\\
M_{21} &amp; M_{22}
\end{pmatrix}
\]</span>
with:</p>
<p><span class="math display">\[
M_{11} = \begin{pmatrix}
1 &amp; 2 \\
6 &amp; 7
\end{pmatrix}
\;
M_{21} = \begin{pmatrix}
3 &amp; 4 &amp; 5\\
8 &amp; 9 &amp; 10\\
\end{pmatrix}
\;\ldots
\]</span></p>
<p><strong>Multiplication of block matrices</strong></p>
<p>The multiplication of two block matrices with square diagonal blocks is very easy:</p>
<p><span class="math display">\[
\begin{pmatrix}
A_{11} &amp; A_{12}\\
A_{21} &amp; A_{22}
\end{pmatrix} \begin{pmatrix}
B_{11} &amp; B_{12}\\
B_{21} &amp; B_{22}
\end{pmatrix} = \begin{pmatrix}
A_{11}B_{11}  + A_{12} B_{21}&amp; A_{11}B_{12} + A_{12} B_{22}\\
A_{21}B_{11} + A_{22} B_{21} &amp;A_{21}B_{12} + A_{22} B_{22}
\end{pmatrix}
\]</span></p>
<p><strong>Determinant of block matrices</strong></p>
<p>Take</p>
<p><span class="math display">\[
A = \begin{pmatrix}
A_{11} &amp; A_{12}\\
A_{21} &amp; A_{22}
\end{pmatrix}
\]</span></p>
<p>and assume that <span class="math inline">\(A_{22}\)</span> is invertible. Then <span class="math inline">\(\det(A) = \det(A_{22})\det(A_{11} - A_{12}A_{22}^{-1} A_{21})\)</span></p>
<p><strong>Inverse of block matrix</strong></p>
<p>Similarly, if <span class="math inline">\(A_{22}\)</span> is invertible, and <span class="math inline">\(\det(A) \neq 0\)</span> (and hence the Schur complement <span class="math inline">\(A_{11} - A_{12}A_{22}^{-1} A_{21}\)</span> is nonsingular) then</p>
<p><span class="math display">\[
A^{-1} = \begin{pmatrix}
S &amp; -S A_{12}A_{22}^{-1}\\
-A_{22}^{-1} A_{21} S &amp; A_{22}^{-1} +  A_{22}^{-1} A_{21}SA_{21}A_{22}^{-1}
\end{pmatrix}
\]</span></p>
<p>where <span class="math inline">\(S = (A_{11} - A_{12}A_{22}^{-1} A_{21})^{-1}\)</span></p>
</div>
<p>We can rewrite the system as a generalized Lotka-Volterra model (see <span class="citation">Case and Casten (<a href="#ref-case1979global" role="doc-biblioref">1979</a>)</span>). We define:</p>
<p><span class="math display">\[
z = (y,x)^T\;\;s = (r, -m)^T
\]</span></p>
<p>And the block structured matrix <span class="math inline">\(A\)</span>:</p>
<p><span class="math display">\[
A = \begin{pmatrix}
A_{11} &amp; A_{12}\\
A_{21} &amp; A_{22}
\end{pmatrix}\; \text{with}\; A_{11} = -D(b),\; A_{12}=-P,\; A_{21} = D(v)P^T, A_{22} = 0_{k,k}
\]</span></p>
<p>where <span class="math inline">\(0_{k,k}\)</span> is a <span class="math inline">\(k \times k\)</span> matrix of zeros. Now the system becomes:</p>
<p><span class="math display">\[
\dfrac{d z}{d t} = D(z)(s + Az)
\]</span></p>
<div id="existence-of-an-equilibrium-1" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Existence of an equilibrium<a href="generalized-lotka-volterra-model.html#existence-of-an-equilibrium-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For simplicity, we concentrate on the study of the feasibility and stability of the coexistence equilibrium. If an equilibrium <span class="math inline">\(z^\star \neq 0\)</span> exists, it is the solution of <span class="math inline">\(A z^\star = -s\)</span>, which requires matrix <span class="math inline">\(A\)</span> to be non-singular. Matrix <span class="math inline">\(A\)</span> is non-singular only if <span class="math inline">\(w = 0\)</span> is the only solution of <span class="math inline">\(Aw = 0\)</span>. We prove that <span class="math inline">\(A\)</span> is non-singular whenever <span class="math inline">\(A_{12}\)</span> is of rank <span class="math inline">\(k\)</span>, and <span class="math inline">\(A_{11}\)</span> is negative definite. We do so by contradiction. First, because the matrix <span class="math inline">\(A\)</span> has a special structure, we can split <span class="math inline">\(w\)</span> into <span class="math inline">\((w_1, w_2)^T\)</span>, and write:</p>
<p><span class="math display">\[
A \begin{pmatrix} w_1\\ w_2 \end{pmatrix} = \begin{pmatrix} A_{11}w_1 + A_{12} w_2\\ A_{21}w_1 \end{pmatrix} = \begin{pmatrix} 0_n\\ 0_k \end{pmatrix}
\]</span></p>
<p>We therefore have <span class="math inline">\(A_{21} w_1 = 0\)</span> and <span class="math inline">\(A_{11}w_1 + A_{12} w_2 = 0\)</span>.</p>
<ul>
<li>Suppose that <span class="math inline">\(w_1 =0\)</span> and <span class="math inline">\(w_2 \neq 0\)</span>; then we find <span class="math inline">\(A_{12} w_2 = 0\)</span> with <span class="math inline">\(w_2 \neq 0\)</span>, which is not possible when <span class="math inline">\(A_{12}\)</span> has rank <span class="math inline">\(k\)</span>.</li>
<li>Now suppose that <span class="math inline">\(w_1 \neq 0\)</span> and <span class="math inline">\(w_2 = 0\)</span>, but this implies <span class="math inline">\(A_{11}w_1 = 0\)</span> with <span class="math inline">\(w_1 \neq 0\)</span>, which is impossible given that <span class="math inline">\(A_{11}\)</span> is clearly of full rank (rank <span class="math inline">\(n\)</span>).</li>
<li>We are left with the case in which both <span class="math inline">\(w_1 \neq 0\)</span> and <span class="math inline">\(w_2 \neq 0\)</span>. We have <span class="math inline">\(A_{21} w_1 = 0\)</span>, but <span class="math inline">\(A_{21} w_1= D(v)P^T w_1 = 0\)</span>, which implies <span class="math inline">\(P^T w_1 = 0\)</span> because all <span class="math inline">\(v_i &gt; 0\)</span>. Then, multiply the first set of equations by <span class="math inline">\(w_1^T\)</span> and the second by <span class="math inline">\(w_2^T\)</span>. We obtain <span class="math inline">\(w_1^T A_{11} w_1 - w_1^T P w_2 = 0\)</span> and <span class="math inline">\(w_2^T D(v)P^T w_1 = 0 = w_2^T P^T w_1\)</span>. But then <span class="math inline">\(w_1^T P w_2 = 0\)</span>, leaving us with <span class="math inline">\(w_1^T A_{11} w_1 = 0\)</span> with <span class="math inline">\(w_1 \neq 0\)</span>, which is again a contradiction because <span class="math inline">\(A_{11}\)</span> is clearly negative definite (and as such <span class="math inline">\(w_1^T A_{11} w_1 \leq 0\)</span>, with equality implying <span class="math inline">\(w_1 = 0\)</span>).</li>
</ul>
<p>We have proven that <span class="math inline">\(A\)</span> is non-singular, and therefore a unique equilibrium point for the system exists (the equilibrium for the moment needs not to be feasible) whenever <span class="math inline">\(A_{11} = -D(b)\)</span> is negative definite (which is always the case whenever resources are self-regulating) and, importantly, <span class="math inline">\(A_{12}\)</span> has rank <span class="math inline">\(k\)</span> (the number of consumers). This in turn implies that <strong>the number of resources must be larger (or equal) than the number of consumers</strong>. A similar argument is developed in the classic <span class="citation">Levin (<a href="#ref-levin1970community" role="doc-biblioref">1970</a>)</span>.</p>
<div class="boxpaper">
<p><strong>Key paper: <span class="citation">Levin (<a href="#ref-levin1970community" role="doc-biblioref">1970</a>)</span></strong></p>
<p>Starting from fairly generic assumptions, the principle of competitive exclusion is generalized: <em>No stable equilibrium can be attained in an ecological community in which some <span class="math inline">\(r\)</span> components are limited by less than <span class="math inline">\(r\)</span> limiting factors. In particular, no stable equilibrium is possible if some <span class="math inline">\(r\)</span> species are limited by less than <span class="math inline">\(r\)</span> factors.</em></p>
</div>
</div>
<div id="global-stability-1" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Global stability<a href="generalized-lotka-volterra-model.html#global-stability-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we prove that if a feasible equilibrium for the system exists, it is globally stable. First, we choose a diagonal matrix <span class="math inline">\(G\)</span></p>
<p><span class="math display">\[
G = \begin{pmatrix}
I_n &amp; 0_{n,k}\\
0_{k,n} &amp; D(v)^{-1}
\end{pmatrix}
\]</span></p>
<p>We have:</p>
<p><span class="math display">\[
B = GA = \begin{pmatrix}
-D(b) &amp; -P\\
P^T &amp; 0_{k,k}
\end{pmatrix}
\]</span></p>
<p><span class="math inline">\(B\)</span> is therefore negative semi-definite:</p>
<p><span class="math display">\[
\frac{1}{2}(B + B^T) = \begin{pmatrix}
-D(b) &amp; 0_{n,k}\\
0_{k,n} &amp; 0_{k,k}
\end{pmatrix}
\]</span></p>
<p>with eigenvalues <span class="math inline">\(-b\)</span> and <span class="math inline">\(0\)</span> (with multiplicity <span class="math inline">\(k\)</span>). Therefore,</p>
<p><span class="math display">\[
\begin{align}
\frac{d V(z(t))}{dt} &amp;= 1^T G \left(\frac{d z(t)}{dt} - D(z^\star) \frac{d \log z(t)}{dt} \right)\\
&amp;= \frac{1}{2}(z - z^\star)^T  (GA + A^T G) (z - z^\star)\\
&amp;= \frac{1}{2}(z - z^\star)^T  (B + B^T) (z - z^\star)\\
&amp;= (y - y^\star)^T  (-D(b)) (y - y^\star)
\end{align}
\]</span></p>
<p>which is zero only when the resources are at equilibrium. We can invoke LaSalle’s invariance principle to prove that any feasible equilibrium is stable.</p>
<div class="boxhomework">
<p><strong>Homework 3a</strong></p>
<p>Prove the local stability of the feasible coexistence equilibrium.</p>
</div>
</div>
<div id="separation-of-time-scales" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Separation of time-scales<a href="generalized-lotka-volterra-model.html#separation-of-time-scales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the original article, <span class="citation">MacArthur (<a href="#ref-macarthur1970species" role="doc-biblioref">1970</a>)</span> takes an interesting shortcut, which can shed light on the behavior of the GLV when the matrix of interactions is symmetric (i.e., <span class="math inline">\(A = A^T\)</span>). Consider the Consumer-Resource model above, and assume that resources equilibrate quickly compared to the dynamics of the consumers. In practice, this means that the system operates on two different time scales, such that the consumers perceive resources to be constantly at equilibrium.</p>
<p>We solve the equations for the resources:</p>
<p><span class="math display">\[
\begin{align}
r - D(b)\, y - P\, x &amp;=0\\
y = D(b)^{-1} (r - P\,x)
\end{align}
\]</span></p>
<p>Substituting in the equations for the consumers, we obtain:</p>
<p><span class="math display">\[
\begin{aligned}
\dfrac{d x}{dt} &amp;= D(x) \left(- m + D(v) P^T\, y \right)\\
&amp;= D(x) \left(- m + D(v) P^T\, D(b)^{-1} (r - P\,x) \right)\\
&amp;= D(x) \left([D(v) P^T\, D(b)^{-1} r - m] - [D(v) P^T\, D(b)^{-1} P]\,x\right)\\
&amp;= D(x) D(v)\left([P^T\, D(b)^{-1} r - D(v)^{-1}m] - [P^T\, D(b)^{-1} P]\,x\right)\\
&amp;= D(x) D(v)\left(s - B\,x\right)
\end{aligned}
\]</span></p>
<p>Which is again GLV, with growth rates <span class="math inline">\(s = P^T\, D(b)^{-1} r - D(v)^{-1}m\)</span> and interaction matrix <span class="math inline">\(B = P^T D(b)^{-1} P\)</span>, which, importantly, is symmetric (note also that if <span class="math inline">\(P\)</span> is of rank <span class="math inline">\(k\)</span> and <span class="math inline">\(b &gt; 0\)</span>, then <span class="math inline">\(B\)</span> is of full rank).</p>
</div>
<div id="lyapunov-function-for-symmetric-lotka-volterra" class="section level3 hasAnchor" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Lyapunov function for symmetric Lotka-Volterra<a href="generalized-lotka-volterra-model.html#lyapunov-function-for-symmetric-lotka-volterra" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have the equations:</p>
<p><span class="math display">\[
\dfrac{d x_i}{d t} = x_i v_i \left(s_i - \sum_{j} B_{ij} x_j \right)
\]</span></p>
<p>At equilibrium, we have <span class="math inline">\(x^\star = B^{-1} s\)</span>. Consider the function:</p>
<p><span class="math display">\[
V(x(t)) = 2 \sum_i s_i x_i - \sum_{ij} B_{ij} x_i x_j
\]</span></p>
<p>Note that <span class="math inline">\(\sum_i s_i x_i &gt; 0\)</span> and that whenever <span class="math inline">\(B\)</span> is stable (and because it’s symmetric, negative definite), <span class="math inline">\(- \sum_{ij} B_{ij} x_i x_j &gt; 0\)</span>. At equilibrium, we have:</p>
<p><span class="math display">\[
V( x^\star ) = \sum_i \left(s_i x_i^\star + \left(s_i x_i^\star - \sum_j B_{ij} x_j^\star \right) \right) = \sum_i s_i x_i^\star
\]</span></p>
<p>It is of particular interest the case in which <span class="math inline">\(s_i = 1\)</span> for all <span class="math inline">\(i\)</span> and <span class="math inline">\(V(x^\star)\)</span> is simply the total biomass of the system at equilibrium.</p>
<p>Now, let’s take the derivative of <span class="math inline">\(V(x(t))\)</span> with respect to <span class="math inline">\(x_i\)</span>:</p>
<p><span class="math display">\[
\dfrac{\partial V}{\partial x_i} = 2 s_i - 2 \sum_j B_{ij} x_j
\]</span></p>
<p>The <span class="math inline">\(2\)</span> in front of the <span class="math inline">\(B_{ij}\)</span> stems from the fact that we are summing over both <span class="math inline">\(B_{ij} x_i x_j\)</span> and <span class="math inline">\(B_{ji} x_j x_i\)</span>. But then:</p>
<p><span class="math display">\[
\dfrac{d x_i}{d t} = x_i v_i \left(s_i -\sum_j B_{ij} x_j\right) = x_i v_i \frac{1}{2}\dfrac{\partial V}{\partial x_i}
\]</span></p>
<p>And therefore, by chain rule:</p>
<p><span class="math display">\[
\dfrac{d V} {d t} = \sum_i \dfrac{\partial V}{\partial x_i} \dfrac{d x_i}{d t} = \sum_i x_i v_i \frac{1}{2}\left(\dfrac{\partial V}{\partial x_i} \right)^2
\]</span></p>
<p>which is always non-negative, and is zero at equilibrium. Therefore, <span class="math inline">\(V(x(t))\)</span> is maximized through the dynamics. This holds even more generally, as we will see in the next lecture and in the following homework. In a way, symmetric, competitive dynamics are “optimizing” <span class="math inline">\(V\)</span>, by following a gradient. This argument can be further expanded, showing that many ecological models can be interpreted as optimization processes (<span class="citation">Marsland III et al. (<a href="#ref-marsland2019minimum" role="doc-biblioref">2019</a>)</span>).</p>
<div class="boxhomework">
<p><strong>Homework 3b</strong></p>
<p>Consider a five-species system with symmetric, stable <span class="math inline">\(B\)</span> (with all positive coefficients) and positive <span class="math inline">\(s\)</span>, yielding the feasible equilibrium <span class="math inline">\(x^\star\)</span>.</p>
<ul>
<li>Find random parameters satisfying 1) <span class="math inline">\(B_{ij} = B_{ji} &gt; 0\; \forall i,j\)</span>; 2) <span class="math inline">\(B\)</span> is stable; 3) <span class="math inline">\(s_i &gt; 0 \; \forall i\)</span>; 4) <span class="math inline">\(B^{-1}s = x^\star &gt; 0\)</span>. These parameters define your pool of species.</li>
<li>For each possible subset of species in the pool, (i.e., for all combinations ranging from a single species [5 cases], to two species [10 cases], <span class="math inline">\(\ldots\)</span>, to all species together [1 case]), compute the corresponding equilibrium. Is it feasible? Is it stable?</li>
<li>Take two subset of species such that a) both are feasible and stable; b) subset 1 contains subset 2 (i.e., all species in 2 are in 1, but not the converse); c) the value of <span class="math inline">\(V(x^\star)\)</span> for subset 1 is larger than that for subset 2. Try invading subset 2 with the species by introducing at the equilibrium of subset 2 the species that are in subset 1 but not in 2—starting all of them at low density. What happens?</li>
</ul>
</div>
</div>
</div>
<div id="further-readings" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Further readings<a href="generalized-lotka-volterra-model.html#further-readings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>On the theory of GLV:</p>
<ul>
<li><p><span class="citation">Hofbauer and Sigmund (<a href="#ref-hofbauer1998evolutionary" role="doc-biblioref">1998</a>)</span> is a wonderful introduction to dynamical systems in ecology and population genetics, with a nice introduction to evolutionary game theory.</p></li>
<li><p><span class="citation">Hadeler et al. (<a href="#ref-hadeler2017topics" role="doc-biblioref">2017</a>)</span> contains a more mathematically-oriented treatment of the material covered in the first part of this lecture.</p></li>
<li><p><span class="citation">Baigent (<a href="#ref-baigent2016lotka" role="doc-biblioref">2016</a>)</span> is a mathematical introduction to Lotka-Volterra dynamics.</p></li>
</ul>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-baigent2016lotka" class="csl-entry">
Baigent, S. A. 2016. Lotka-volterra dynamics: An introduction. World Scientific.
</div>
<div id="ref-barabas2016effect" class="csl-entry">
Barabás, G., M. J. Michalska-Smith, and S. Allesina. 2016. The effect of intra-and interspecific competition on coexistence in multispecies communities. The American Naturalist 188:E1–E12.
</div>
<div id="ref-case1979global" class="csl-entry">
Case, T. J., and R. G. Casten. 1979. Global stability and multiple domains of attraction in ecological systems. The American Naturalist 113:705–714.
</div>
<div id="ref-hadeler2017topics" class="csl-entry">
Hadeler, K. P., M. C. Mackey, and A. Stevens. 2017. Topics in mathematical biology. Springer.
</div>
<div id="ref-hirsch1982systems" class="csl-entry">
Hirsch, M. W. 1982. Systems of differential equations which are competitive or cooperative: I. Limit sets. SIAM Journal on Mathematical Analysis 13:167–179.
</div>
<div id="ref-hofbauer1998evolutionary" class="csl-entry">
Hofbauer, J., and K. Sigmund. 1998. Evolutionary games and population dynamics. Cambridge University Press.
</div>
<div id="ref-levin1970community" class="csl-entry">
Levin, S. A. 1970. Community equilibria and stability, and an extension of the competitive exclusion principle. The American Naturalist 104:413–423.
</div>
<div id="ref-levins1969some" class="csl-entry">
Levins, R. 1969. Some demographic and genetic consequences of environmental heterogeneity for biological control. American Entomologist 15:237–240.
</div>
<div id="ref-macarthur1955fluctuations" class="csl-entry">
MacArthur, R. 1955. Fluctuations of animal populations and a measure of community stability. Ecology 36:533–536.
</div>
<div id="ref-macarthur1970species" class="csl-entry">
MacArthur, R. 1970. Species packing and competitive equilibrium for many species. Theoretical population biology 1:1–11.
</div>
<div id="ref-macarthur2001theory" class="csl-entry">
MacArthur, R. H., and E. O. Wilson. 2001. The theory of island biogeography. Princeton university press.
</div>
<div id="ref-macarthur1967limiting" class="csl-entry">
MacArthur, R., and R. Levins. 1967. The limiting similarity, convergence, and divergence of coexisting species. The american naturalist 101:377–385.
</div>
<div id="ref-marsland2019minimum" class="csl-entry">
Marsland III, R., W. Cui, and P. Mehta. 2019. The minimum environmental perturbation principle: A new perspective on niche theory. arXiv preprint arXiv:1901.09673.
</div>
<div id="ref-smale1976differential" class="csl-entry">
Smale, S. 1976. On the differential equations of species in competition. Journal of Mathematical Biology 3:5–7.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="models-for-two-populations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stability-of-large-ecological-communities.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Theoretical_Community_Ecology.pdf", "Theoretical_Community_Ecology.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
