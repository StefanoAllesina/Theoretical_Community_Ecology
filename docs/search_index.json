[
["index.html", "Theoretical Community Ecology Preliminaries Approach and target audience Topics Notation Grading and code of conduct Sources", " Theoretical Community Ecology Stefano Allesina 2020-09-30 Preliminaries Approach and target audience The material was prepared for the graduate class Theoretical Community Ecology taught at the University of Chicago — AY 2020/2021. Following the material requires some familiarity with calculus (multivariable integration, derivatives, chain rule) and linear algebra (vector spaces, eigenvalues, eigenvectors). Also, a good working knowledge of R (writing functions, working with the packages deSolve and tidyverse) is needed to follow the code. The approach taken throughout the course is to alternate between code/simulations and mathematical derivations. While several theorems are (informally) stated, proofs are included only when elementary and/or informative of the underlying biological processes. The class builds upon material typically presented in classes on population, community and theoretical ecology. Topics Focus on continuous time, time-invariant models Multispecies dynamics Metapopulations Evolutionary Game Theory Models for Infectious Diseases Notation Unless specified or for obvious exceptions, Greek letters stand for scalars (i.e., real or complex numbers), lower case roman letters for vectors, and capital roman letters for matrices (as such \\(a_i\\) or \\(A_{ij}\\) are scalars). We typically work in \\(\\mathbb{R}^n\\) (the \\(n\\)-dimensional Euclidean space), \\(\\mathbb{R}^n_+\\) (i.e., the positive orthant of \\(\\mathbb{R}^n\\)), or \\(\\mathbb{R}^n_{0+}\\) (non-negative orthant). \\(D(x)\\) is a diagonal matrix with \\(x\\) on the diagonal, sometimes written \\(D(x) = X\\). The matrix \\(A^T\\) is the transpose of \\(A\\). Whenever it is clear what I mean, I will drop the dependency on time of certain variables. The Generalized Lotka-Volterra model: \\[ \\dfrac{d x_i(t)}{d t} = x_i(t) \\left(a_i + \\sum_{j} B_{ij} x_j(t) \\right) \\] can be written in compact form as: \\[ \\dfrac{d x}{d t} = X (a + B x) \\] Grading and code of conduct You should follow the rules and regulations set out by University policy. I am expecting all students to a) participate in all classes (please contact me if you are going to be absent for a class); b) actively contribute to discussions and lectures; c) be punctual (both for class and in turning in the homework); d) be professional and honest (no copying/cheating/plagiarizing). Homework (80%) Each of the lectures contains exercises that should be completed as graded homework. The homework should be submitted through Canvas as one or more Rmd files, containing the derivations (you can use LaTex to typeset mathematics within Rmd, see here for commonly used commands), and code. The code must run and be correct to get a passing grade. Review (20%) The remaining 20% of the grade is based on a review. Take an interesting (important, provocative, etc.) published paper or preprint in theoretical community ecology, and produce a review (of the kind you would submit to a journal if solicited for comments). The review must contain two sections: a) comments to the Authors, and b) Recommendation for the Editor. You can find good advice on writing reviews here. Sources Many excellent books are available on these topics. Here are the main references I’ve used in preparing these lectures: Strogatz (2018) — a clear, concise introduction to dynamical systems. Ellner and Guckenheimer (2011) — an introduction to dynamical models focusing on biology. Hofbauer and Sigmund (1998) — a great resource for models of population dynamics and evolutionary game theory. Szederkenyi, Magyar, and Hangos (2018) — an introduction to quasi-polynomial systems and reaction networks. Hadeler, Mackey, and Stevens (2017) — a more mathematically-focused reading. Hirsch, Smale, and Devaney (2012) — an extensive, clearly written and rigorous introduction to dynamical systems. References "],
["models-for-a-single-population.html", "Lecture 1 Models for a single population 1.1 Types of dynamical systems 1.2 Initial-value problems 1.3 Solvable model: Exponential growth 1.4 Solvable model: Logistic growth 1.5 Qualitative analysis of models for a single population 1.6 Bifurcations 1.7 Long term behavior of 1-D systems 1.8 Lyapunov functions", " Lecture 1 Models for a single population Lesson plan: We start by discussing what it means to solve an initial-value problem: the solution is an expression that allows us to calculate \\(x(t)\\) for any \\(t\\). A few ecologically-relevant models can be solved explicitly, for example the exponential and logistic growth models. Because, on the other hand, solving differential equations is a laborious process, and in many cases writing the solution is impossible or does not give us any insight on the dynamics, we introduce a graphical model that allows to effortlessly sketch the dynamics of any first-order ODE (i.e., models with a single equation). This allows us to introduce essential concepts such as the notion of an equilibrium and its stability. We show that determining stability using this graphical method is equivalent to performing stability analysis via linearization around an equilibrium, a method that will be extended to systems of multiple ODEs in the next chapter. We briefly discuss the idea of bifurcation points — i.e., particular choices of parameters for which the dynamics of the system change qualitatively. We conclude by introducing the idea of Lyapunov functions, allowing us to determine global stability of an equilibrium without the need to explicitly solve the model. We will see a lot of these functions when we study larger systems. 1.1 Types of dynamical systems Dynamical systems describe the change of certain variables, typically in time, space or a combination of the two. They have found applications in all scientific disciplines, and were introduced in ecology and evolutionary biology at the beginning of the twentieth century. Broadly, dynamical systems can be divided into continuous (described by differential equations), or discrete (described by maps, or difference equations) models. Many models for population dynamics can be written as (systems of) first-order ordinary differential equations, i.e. equations containing functions of one (or more) independent variables and their derivatives (typically, with respect to time). Ordinary means we’re not dealing with partial differential equations (used in ecology for example for reaction-diffusion equations, or spatial models). First-order, mean that they contain only the first derivative with respect to time. Here we will concentrate on autonomous systems, meaning that it they are time-invariant (e.g., coefficients do not change in time). We can write these systems as: \\[ \\dfrac{d x(t)}{d t} = f(x(t)) \\] In general, we will examine cases in which \\(f(x(t))\\) is a nonlinear function of \\(x(t)\\). We typically deal with deterministic systems, in which randomness plays no role in determining future states. Stochastic differential equations, on the other hand, include random components. 1.2 Initial-value problems Typically, we would like to track the evolution of the system in time, starting from known initial conditions. For example, \\[ \\dfrac{d x(t)}{d t} = f(x(t)), \\;\\; x(0) = x_0 \\] where the independent variable \\(t\\) denotes time and is considered non-negative. \\(x(t)\\) is the state of the system (e.g., the density of the species) at time \\(t\\), \\(x(t) \\in \\mathbb{R}^n\\), and the function \\(f\\) models the evolution of the system, mapping \\(\\mathbb{R}^n \\to \\mathbb{R}^n\\). The vector \\(x_0 = x(0) \\in \\mathbb{R}^n\\) marks the initial conditions of the system. The simplest and most common case in ecology is that in which \\(f\\) is (infinitely) many times continuously differentiable, a.k.a. smooth. If this is the case, then the solution \\(x(t)\\) exists and is unique. In ecological models, dynamics are invariant with respect to the non-negative orthant \\(\\mathbb{R}^n_{0+}\\), i.e., the vector \\(x(t)\\) remains non-negative whenever initialized at non-negative initial conditions \\(x_0 \\in \\mathbb{R}^n_{0+}\\). The function \\(f\\) is essentially non-negative if whenever \\(x_i = 0\\), then \\(f_i(x) \\geq 0\\) for all \\(x \\in \\mathbb{R}^n_{0+}\\). A dynamical system is non-negative only if \\(f\\) is essentially non-negative. We can solve the (system of) ODE(s) if we can write an explicit equation for \\(x(t)\\) given the parameters and the initial conditions. In practice, we rarely can solve the equations we’re interested in. We can however prove that, if \\(f(x(t))\\) is sufficiently well-behaved (technically, if \\(f(x)\\) is Lipschitz continuous, for example, if it has bounded derivatives), then the initial-value problem above has a solution, the solution is unique, and depends continuously on the intial conditions and the parameters. This means that if we start the system at any point \\(x(t)= x_t\\), we cannot have multiple trajectories intersecting. 1.3 Solvable model: Exponential growth History: Pierre-François Verhulst (1804-1849) Pierre-François Verhulst was born in 1804 in Brussels, Belgium. In 1835 became professor of mathematics at the newly-instituded Free University of Brussels. In 1838, inspired by the work of Malthus and Quetelet, he wrote a Note on the law of population growth, where he argued that the geometric progression imagined by Malthus would be unfeasible to sustain. He therefore introduced an unknown function that would slow down growth for large populations\" “The simplest hypothesis one can make on the form of this function is to suppose that” the unknown function would be quadratic in the size of the population. He went on to solve what is now known as the “logistic growth” model and contrasted it with data for the growth of populations in various countries. An model of ecological interest that has an explicit solution is that for the exponential growth: \\[ \\dfrac{d x(t)}{dt} = \\rho \\, x(t), \\;\\; x(0) = 0 \\] This is a separable differential equation, meaning that we can formally write: \\[ \\dfrac{1}{x(t)} dx(t) = \\rho\\, dt \\] Integrate both sides (the left in \\(d x(t)\\), the right in \\(dt\\)): \\[ \\begin{aligned} \\int \\dfrac{1}{x(t)} d x(t) = \\rho \\int dt \\end{aligned} \\] Obtaining (\\(C_i\\) are constants of integration): \\[ \\begin{aligned} \\log x(t) + C_1= \\rho\\, t + C_2\\\\ \\log x(t) = \\rho\\, t + C_3\\\\ x(t) = e^{\\rho\\,t + C_3}\\\\ x(t) = C_4 e^{\\rho\\, t} \\end{aligned} \\] Substituting the initial condition \\(x(0) = x_0\\) we find that \\(C_4 = x_0\\): \\[ x(t) = x_0 e^{\\rho\\, t} \\] which is our solution. If we know the value of \\(\\rho\\) and the initial density \\(x_0\\), we can directly write the population density \\(x(t)\\) for any \\(t\\). 1.4 Solvable model: Logistic growth Another model that can be solved explicitly is that of the logistic growth: \\[ \\dfrac{d x(t)}{dt} = \\rho\\, x(t) (1 - \\alpha\\, x(t)), \\;\\; x(0) = 0 \\] again, we can separate the equation: \\[ \\dfrac{1}{x(t) (1 - \\alpha\\, x(t))} d x(t) = \\rho\\, dt \\] the r.h.s. is trivial to integrate, but the l.h.s. is trickier. We can transform it into a simpler expression by using partial fractions. We want to write: \\[ \\dfrac{1}{x(t) (1 - \\alpha\\, x(t))} = \\dfrac{A}{x(t)} + \\dfrac{B}{1 - \\alpha\\, x(t)} \\] where \\(A\\) and \\(B\\) are appropriate constants. Multiplying both sides by \\(x(t) (1 - \\alpha\\, x(t))\\), we obtain: \\[ 1 = A (1 - \\alpha\\, x(t)) + B \\, x(t) = A + x(t)\\, (B - A\\, \\alpha) \\] The l.h.s. does not contain \\(x(t)\\), and therefore we want to set \\(x(t)\\, (B - A\\, \\alpha) = 0\\), choosing \\(B = A\\, \\alpha\\), and therefore \\(A = 1\\). We can integrate the simpler form: \\[ \\int \\dfrac{1}{x(t)} \\,d x(t) + \\int \\dfrac{\\alpha}{(1 - \\alpha\\, x(t))}\\, d x(t) = \\rho\\, dt \\] obtaining: \\[ \\begin{aligned} \\log x(t) - \\log (1 - \\alpha\\, x(t)) = \\rho\\, t + C_1\\\\ \\log \\dfrac{x(t)}{1 - \\alpha\\, x(t)} = \\rho\\, t + C_1\\\\ \\dfrac{x(t)}{1 - \\alpha\\, x(t)} = e^{\\rho\\, t + C_1}\\\\ x(t) = \\dfrac{e^{\\rho\\, t + C_1}}{1 + \\alpha\\, e^{\\rho\\, t + C_1}}\\\\ x(t) = \\dfrac{1}{\\alpha + e^{-(\\rho\\, t + C_1)}} \\end{aligned} \\] To find the value of \\(C_1\\), substitute the initial condition \\(x(0) = x_0\\), and solve for \\(C_1\\): \\[ \\begin{aligned} x_0 = \\dfrac{1}{\\alpha + e^{-C_1}}\\\\ C_1 = \\log \\dfrac{x_0}{1 - \\alpha \\, x_0} \\end{aligned} \\] Finally, substituting, we find: \\[ x(t) = \\dfrac{x_0 \\, e^{\\rho\\, t}}{1 + \\alpha\\, x_0 \\, (e^{\\rho\\, t} - 1)} \\] which provides an explicit solution for this (very simple) model. Homework 1a Find the solution for the logistic growth with harvesting: \\[ \\dfrac{d x(t)}{dt} = \\rho\\, x(t) (1 - \\alpha\\, x(t)) - \\eta\\, x(t) \\] where \\(1 &gt; \\eta &gt; 0\\) is the proportion of individuals being harvested. 1.5 Qualitative analysis of models for a single population Because in general we cannot write an explicit solution for our models of interest, we attempt a qualitative analysis by: a) finding fixed points (equilibria); b) provide a qualitative description of the dynamics; c) probe the stability of fixed points; d) gain an understanding of the system (nature of attractors, changes of behavior for different parameters) without deriving an explicit solution. When we are dealing with a single population, we can use a graphical method. Simply, plot \\(dx(t) /dt\\) against \\(x(t)\\). We think of \\(x(t)\\) as moving along the \\(x\\) axis, at a velocity determined by the \\(y\\) coordinate. For the exponential growth function: \\[ \\dfrac{d x(t)}{dt} = \\rho \\, x(t) \\] the graph becomes: The only point where the curve intercepts the \\(x\\) axis is the point \\(x^\\star = 0\\). A point \\(x^\\star\\) for which \\(\\left . \\dfrac{d x(t)}{dt} \\right|_{x^\\star} = 0\\) is an equilibrium (or fixed-point) for the system, meaning that if we initialize the system at \\(x^\\star\\), it will remain there unless perturbed. Whenever we apply a (small) perturbation to a stable equilibrium, the system returns to it; when we perturb an unstable equilibrium, on the other hand, the system moves away from it. Now think of a perturbation: if we were to perturb \\(x^\\star = 0\\) by introducing a few individuals, we would find that the population starts growing (i.e., \\(dx(t) / dt &gt; 0\\)), meaning that the point is unstable. Thus, using the graphical method introduced above, we can easily identify equilibria (i.e., where the curve intercepts the x-axis), and their stability (i.e., by determining whether the curve around the equilibrium is above or below \\(d x(t)/dt = 0\\)). Next, let’s consider the logistic growth equation: \\[ \\dfrac{d x(t)}{dt} = \\rho\\, x(t) (1 - \\alpha\\, x(t)) \\] We can draw the graph (note the quadratic term—we’re describing a parabola): Now we have two equilibria, at \\(x^\\star = 0\\) and \\(x^\\star = 1 / \\alpha\\). If we perturb \\(x^\\star = 0\\), the system moves away from it (unstable), while if we perturb \\(x^\\star = 1 / \\alpha\\) the system goes back to it (stable). History: Warder Clyde Allee (1885-1955) Born in Indiana, Allee received his in 1912 PhD from the University of Chicago, where he returned in 1921. He was the Dean in the College of Arts, Literature, and Science (1924-1926) and Secretary of the Department of Zoology (1927-1934). He stayed at U. Chicago until his retirement (1950). He performed a series of studies on animal aggregation, finding that goldfish growing in a tank laced with colloidal silver would grow faster when more individuals were present. Today, the Allee effect applies to any population that grows faster when a certain threshold population is surpassed. Now a more complex model, in which the population experiences an Allee effect: \\[ \\dfrac{d x(t)}{dt} = \\rho\\, x(t) (x(t) - \\gamma) (1 - \\alpha\\, x(t)) \\] where \\(0&lt;\\gamma&lt;1 / \\alpha\\). Plotting, In this model, there are two stable equilibria (\\(x^\\star = 0\\) and \\(x^\\star = 1 / \\alpha\\)), separated by an unstable equilibrium (\\(x^\\star= \\gamma\\)). Depending on the initial condition, we might end up with either—we call this situation bistability. Note that bistability makes it clear that we can only apply small perturbations to the equilibrium to probe its stability—for example, imagine being at \\(x^\\star = 1 / \\alpha\\) and perturbing the population by bringing it below \\(\\gamma\\); then we would find that the population goes extinct, suggesting that \\(x^\\star = 1 / \\alpha\\) is “somewhat unstable”. 1.5.1 Stability using derivatives You might have noticed in the previous graphs that whenever the curve \\(dx(t) /dt\\) is negative on the left of a point and positive on its right we find that the point is unstable, while conversely a point for which \\(dx(t) /dt\\) is positive on the left and negative on the right is stable. We can formalize this by taking the derivative of \\(dx(t) /d t\\) with respect to \\(x(t)\\), and evaluating this function at different equilibria. For example, for the exponential growth model, we have: \\[ \\dfrac{\\partial}{\\partial x} \\dfrac{dx}{dt} = \\dfrac{\\partial f(x)}{\\partial x} = \\dfrac{\\partial (r x)}{\\partial x} = \\rho \\] This is always posive when \\(\\rho &gt; 0\\), and as such the only equilibrium (\\(x^\\star = 0\\)) is unstable. For the logistic growth, we find: \\[ \\dfrac{\\partial f(x)}{\\partial x} = \\dfrac{\\partial (\\rho\\, x - \\rho\\, \\alpha\\, x^2)}{\\partial x} = \\rho - 2 \\rho\\, \\alpha\\, x \\] When we evaluate this function at the equilibrium \\(x^\\star = 0\\), we obtain \\(\\rho &gt; 0\\), and as such the equilibrium is unstable. Conversely, when we evaluate the fuction at \\(x^\\star = 1 / \\alpha\\), we obtain \\(\\rho - 2 \\rho \\to -\\rho\\) and therefore the equilibrium is stable. Finally, for the model with Allee effect, we have: \\[ \\dfrac{\\partial (\\rho\\, x (x-\\gamma)(1-\\alpha\\, x))}{\\partial x} = - \\rho\\, \\gamma + 2 \\rho\\, x(1 + \\alpha) - 3 \\rho\\, \\alpha\\, x^2 \\] At \\(x^\\star = 0\\), we find \\(-\\rho\\, \\gamma\\) which is always negative, and as such \\(x^\\star = 0\\) is stable. At \\(x^\\star = \\gamma\\) we have \\(\\rho\\, \\gamma\\, (1- \\gamma\\, \\alpha)\\) which is positive (as \\(\\gamma\\, \\alpha &lt; 1\\)) and as such is an unstable equilibrium. Finally, for \\(x^\\star = 1/\\alpha\\) we have \\(\\rho (\\gamma - 1/\\alpha)\\) which is always negative. 1.5.2 What are we doing when probing stability using derivatives? More formally, we can think of describing the dynamics of a perturbation around the equilibrium. Call \\(\\Delta x(0) = x(0) - x^\\star\\), and approximate the dynamics around the equilibrium. We want to write the dynamics of \\(\\Delta x(t)\\). By chain rule, \\(\\frac{d \\Delta x(t)}{dt} = \\frac{d \\Delta x(t)}{d x(t)} \\frac{d x(t)}{dt}\\), and as such \\[ \\frac{d \\Delta x(t)}{dt} = f(\\Delta x(t) + x^\\star) \\] If we think of the perturbation as infinitesimally small, we can Taylor expand around \\(x^\\star\\): \\[ f(\\Delta x(t) + x^\\star) = f(x^\\star) + \\left . \\frac{df(x)}{dx} \\right |_{x^\\star} \\Delta x(t) + \\frac{1}{2}\\left . \\frac{d^2 f(x)}{dx^2} \\right |_{x^\\star} (\\Delta x(t))^2 + \\ldots \\] Taking only the linear term, and noticing that \\(f(x^\\star) = 0\\) by definition, we have: \\[ \\frac{d \\Delta x(t)}{dt} \\approx \\left . \\frac{d f(x)}{dx} \\right |_{x^\\star} \\Delta x(t) = \\rho\\, \\Delta x(t) \\] which is the equation for the exponential growth we have seen above. If \\(\\left . \\frac{d f(x)}{d x}\\right |_{x^\\star} &lt; 0\\) the perturbation \\(\\Delta x(t)\\) will die out, while if it is positive it will increase fast. 1.6 Bifurcations The shape of the graphs above might depend on the value of parameters. When a small change in one or several parameters causes a qualitative change in the behavior of the system, we say the system has crossed a bifurcation point (the term “bifurcation” was introduced by Henri Poincaré in 1885). At a bifurcation point, equilibria could disappear or be created, change their stability, the system could start cycling, etc. In low-dimensional system, there are a variety of different behaviors, each of which has its own name (e.g., saddle-node, pitchfork, transcritical, Hopf, period-doubling, …, bifurcation). The codimension of a bifurcation is the number of parameters we need to change the behavior of the system. Clearly, codimension-1 and -2 bifurcations are the simplest and most studied. Here we just show the main idea using a simple example. For a detailed and accessible introduction, see Strogatz (2018) and Seydel (2009). Consider the model: \\[ \\dfrac{d x}{dt} = \\rho + x^2 \\] The equilibria of the system, when they exist, are given by \\(x^\\star = \\pm \\sqrt{-\\rho}\\). It is clear that, when \\(\\rho &lt; 0\\) we will have two equilibria, when \\(\\rho = 0\\) a single equilibrium \\(x^\\star = 0\\), and that when \\(\\rho &gt; 0\\) no (real) equilibrium exists. As such, the shape of the diagrams we have sketched above depend on \\(\\rho\\). For example, when \\(\\rho = -4\\), we have: The equilibrium on the left is stable, while the one on the right is unstable. The graph is qualitatively the same for any \\(\\rho &lt; 0\\). When \\(\\rho = 0\\), however, the two equilibria “collide”, and merge into the single “half-stable” equilibrium: The equilibrium \\(x^\\star = 0\\) is stable if we approach it from the left, while unstable if we are reaching it from the right. When we cross the bifurcation \\(\\rho_c = 0\\), the equilibrium disappears altogether, leading to unbounded growth: We can summarize the behavior of the system for different values of \\(\\rho\\) in a bifurcation diagram: on the x-axis we have the parameter we are varying (in this case \\(\\rho\\)), and on the y-axis we report \\(x(t)\\), marking the position of all the equilibria, with a solid line indicating stable equilibria and a dashed line the unstable ones: Note that the rate at which the system approaches (moves away from) the stable (unstable) equilibrium depends on \\(\\rho\\). When \\(\\rho \\ll 0\\) the system moves fast, while when \\(\\rho \\to \\rho_c = 0\\) the system moves more slowly. This phenomenon is called “critical slowing down” and has been proposed as a generic indicator that a system is approaching a bifurcation point. Homework 1b Draw the bifurcation diagram for logistic growth model with harvesting: \\[ \\dfrac{d x(t)}{dt} = \\rho\\, x(t) (1 - \\alpha\\, x(t)) - \\eta\\, x(t) \\] where \\(1 &gt; \\eta &gt; 0\\) is the proportion of individuals being harvested. Details take \\(\\rho = 1\\), \\(\\alpha = 1\\) and vary \\(\\eta\\) between 0 and 1. write code to solve the initial value problem from a random initial condition \\(x(0) \\sim \\mathcal U[0, 2]\\) (i.e., sampled independently from a uniform distribution between 0 and 2); document the possible outcomes. write code to plot the bifurcation diagram—for each value of \\(\\eta\\), mark stable and unstable equilibria. what is the critical \\(\\eta_c\\) where a bifurcation occurs? A few interesting references on detecting the approaching of a bifurcation in experimental systems: Key paper: Scheffer et al. (2009) Starting in the early 2000s, much work went into trying to anticipate dramatic changes in natural and man-made systems (e.g., lakes turning eutrophic, fisheries collapsing). In this review, Scheffer et al. summarize previous work and present an accessible introduction to the problem. Key paper: Dai et al. (2012) Dai et al. grew populations of Saccharomyces cerevisiae on sucrose. Because sucrose is split outside the cell, it creates an Allee effect: when the population density is high, it is energetically convenient to produce the enzyme to spit the sucrose, as the different cells pool their efforts; when population density is low, the gain is not sufficient to balance the cost. By tuning the mortality (dilution), they were able to experimentally recreate the bifurcation diagram of the exercise above. The data from the experiments are here. 1.7 Long term behavior of 1-D systems First-order (i.e., single-equation) ODEs can produce a very limited variety of long-terms behaviors: for \\(t \\to \\infty\\) we can only have \\(x(t) \\to \\pm \\infty\\) or \\(x(t) \\to x^\\star\\). For population models, this means that either growth is unbounded (e.g., exponential growth model), or the population will reach an equilibrium point (possibly, out of many). This is a direct consequence of the uniqueness of trajectories: because we are moving in a 1-dimensional space, the fact that trajectories cannot cross means that if we are at a certain point \\(x(t) = x_t\\), then either \\(dx(t)/dt &gt;0\\), \\(dx(t)/dt &lt;0\\), or \\(dx(t)/dt =0\\), but can take only one value, preventing more complex behaviors such as cycles or chaos. For smooth functions and autonomous systems, one needs at least two equations to produce cycles and three equations to produce chaos. This is in stark contrast with difference equations—a single, innocent-looking difference equation can give rise to all sorts of dynamics. Key paper: May (1976) May takes a possible model for the logistic growth in discrete time, and shows how this very simple model can give rise to equilibria, cycles and chaos. This is one of the papers that launched an all-out effort to explore chaotic dynamics that lasted for all of the 1980s. 1.8 Lyapunov functions While in many cases we cannot write an explicit solution for a (system of) differential equation(s), we might be able to determine the stability of equilibria and their basin of attraction (i.e., the set of initial conditions eventually leading to the equilibrium \\(x^\\star\\)) by considering functions that change monotonically through the dynamics. Suppose that \\(\\dfrac{d x(t)}{dt} =f(x(t))\\), and that \\(x^\\star\\) is an equilibrium. Let \\(V(x)\\) be a function defined in an open set \\(\\mathcal O\\) containing \\(x^\\star\\), such that a) \\(V(x^\\star) = 0\\) and \\(V(x) &gt; 0\\) for any \\(x \\neq x^\\star\\), and b) \\(d V /dt \\leq 0\\) for all \\(x \\in \\mathcal O - x^\\star\\). Then \\(V\\) is a Lyapunov function for the model, and \\(x^\\star\\) is stable. The Lyapunov function is called strict, and the equilibrium \\(x^\\star\\) asymptotically stable if \\(d V /dt &lt; 0\\). While Lyapunov functions are great, because we can prove stability without the need to solve the system, there is no general rule to construct such a function. Often, “candidate” Lyapunov functions are available, but the process of finding the right function typically requires a lot of ingenuity and trial and errors. Fortunately, for system with a single state a quadratic function is guaranteed to solve the problem. Take the model for logistic growth (with \\(\\rho &gt; 0\\) and \\(\\alpha &gt; 0\\), and the candidate Lyapunov function: \\[ V(x(t)) = (x(t) - x^\\star)^2 \\] with \\(x^\\star = 1 / \\alpha\\). The function is positive for any \\(x(t) \\neq x^\\star\\). Next, we derive with respect to \\(t\\): \\[ \\dfrac{d V(x(t))}{d t} = \\dfrac{d V(x(t))}{d x(t)}\\dfrac{d x(t)}{d t} = 2 \\left(x(t) - \\dfrac{1}{\\alpha}\\right)\\rho\\, x(t) (1 - \\alpha\\, x(t)) \\] The derivative is negative whenever \\(x(t) &gt; 0\\) and \\(x(t) \\neq x^\\star\\): \\[ \\dfrac{d V(x(t))}{d t} = 2 \\rho\\, x(t) \\left(x(t) - \\dfrac{1}{\\alpha}\\right) (1 - \\alpha\\, x(t))= -\\dfrac{\\rho\\, x(t)}{\\alpha}\\left(x(t) - \\dfrac{1}{\\alpha}\\right)^2 \\] and as such \\(x^\\star\\) is asymptotically stable. The basin of attraction (i.e., where the Lyapunov function has the desired properties) is \\(x \\in \\mathbb{R}_+\\). There can be several alternative Lyapunov functions. For example, consider: \\[ V(x(t)) = x(t) - x^\\star - x^\\star \\log \\dfrac{x(t)}{x^\\star} \\] which is positive for \\(x(t) &gt; 0\\) and \\(x(t) \\neq x^\\star\\), taking the derivative w.r.t. time, we find: \\[ \\dfrac{d V(x(t))}{d t} = \\left(1 - \\dfrac{x^\\star}{x(t)}\\right)\\rho\\, x(t) (1 - \\alpha\\, x(t)) = -\\rho\\, x^\\star (x(t) - x^\\star)^2 \\] which again is negative whenever \\(x^\\star &gt; 0\\), \\(\\rho &gt;0\\) and \\(x(t) \\neq x^\\star\\). References "],
["models-for-two-populations.html", "Lecture 2 Models for two populations 2.1 Qualitative analysis of models for two populations 2.2 Local stability analysis 2.3 Stability analysis of the Lotka-Volterra Predator-Prey model", " Lecture 2 Models for two populations Lesson plan: We discuss the concepts introduced in the previous chapter in the context of two-dimensional (“planar”) systems of differential equation. We summarize important concepts from linear algebra: eigenvalues and eigenvectors, the matrix exponential. We show how these concepts can be used to solve linear systems of differential equations. We introduce the “community matrix”, allowing us to determine the local asymptotic stability of equilibria. We analyze in detail the classic Lotka-Volterra predator-prey model, and a version of the model in which the prey grows logistically. 2.1 Qualitative analysis of models for two populations In this section, we extend the qualitative analysis we’ve performed for a single populations to models with two populations. Many of the methods introduced below extend to the case of multiple populations. 2.1.1 Isoclines of null growth Take a two-dimensional model. For each equation, we can write the solution of \\(dx/dt = 0\\) as a function of \\(y\\), thereby defining the curve in the \\((x, y)\\) plane (the “phase plane”) for which the growth of species \\(x\\) is zero. For a concrete example, take the classic predator-prey Lotka-Volterra system: \\[ \\begin{cases} \\dfrac{d x(t)}{dt} = \\rho\\, x(t) - \\alpha\\, x(t)\\, y(t)\\\\ \\dfrac{d y(t)}{dt} = -\\delta\\, y(t) + \\beta\\, x(t)\\, y(t) \\end{cases} \\] where \\(x(t)\\) is the density of the prey species at time \\(t\\) and \\(y(t)\\) that of the predator. We can interpret \\(\\rho\\) as the intrinsic growth rate of the prey (i.e., the growth when the predator is absent), \\(\\delta\\) as the death rate of the predator, and \\(\\alpha\\) and \\(\\beta\\) as the loss of (gain in) growth due to predation. History: Alfred J. Lotka (1880-1949) Alfred Lotka was born to French-speaking American parents in Lemberg (then part of the Habsburg empire, now Lviv, Ukraine). He studied in France, Germany and England, receiving a BSc in 1901 and a DSc in 1912 from Birmingham university. He moved to the US in 1902, and worked at the US Patent office, as an editor of Scientific American, and as a statistician at the Metropolitan Life Insturance Company in NYC. He wrote more than a hundred papers and five books, spanning a large range of topics. He’s best known for the book Elements of Physical Biology, his contributions to demography, and one of the first studies dealing with bibliometrics (Lotka 1926). Starting in 1910 (reprinted as Lotka (2002)) he investigated coupled differential equations relating to chemical as well as ecological dynamics. In Lotka (1920) he studied a system of two ODEs that gave rise to perpetual oscillations: “It was, therefore, with considerable surprise that the writer, on applying his method to certain special cases, found these to lead to undamped, and hence indefinitely continued, oscillations.” He went on to describe “1. A species of organism \\(S_1\\), a plant species, say, deriving its nourishment from a source presented in such large excess that the mass of the source may be considered constant during the period of time with which we are concerned. 2. A species \\(S_2\\), for example a herbivorous animal species, feeding on \\(S_1\\).” The equations he had derived (and then studied later in more detail) are now termed Lotka-Volterra equations. Let’s look at a possible trajectory for the system, to gain an intuition of what can happen: You can see that the population densities, when drawn in the “phase plane” cycle counterclockwise. Let’s try to understand why. The equation for the prey is zero either when \\(x(t) = 0\\) or when \\(\\rho - \\alpha\\,y(t) = 0\\), yielding \\(y(t) = \\rho / \\alpha\\). Whenever the density of the predator \\(y(t) &lt; \\rho / \\alpha\\), prey will grow; conversely, whenever \\(y(t) &gt; \\rho / \\alpha\\), prey will decline. Graphically: Similarly, the equation for the predator is zero either when \\(y(t) = 0\\) or when \\(-\\delta + \\beta\\, x(t) = 0\\), yielding \\(x(t) = \\delta / \\beta\\). Whenever the density of the prey \\(x(t) &lt; \\delta / \\beta\\), predators will decline; conversely, whenever \\(x(t) &gt; x(t) = \\delta / \\beta\\), predators will grow. Graphically: Now let’s put the two graphs together: Clearly, a possible equilibrium of the system is \\((x^\\star, y^\\star)^T = (0, 0)^T\\) (often called the “trivial” equilibrium). You can see that there is another equilibrium where the two isoclines meet \\((x^\\star, y^\\star)^T = (\\delta / \\beta, \\rho / \\alpha)^T\\), and that the dynamics will tend to cycle around the equilibrium. But how do we know whether dynamics will cycle toward the equilibrium, spiral away from it, or describe closed orbits? To answer this question, we can try to extend our linear analysis by Taylor-expanding the dynamics around the equilibrium. 2.2 Local stability analysis Suppose that a feasible (i.e., positive) equilibrium \\(x^\\star\\) exists for a given model. Then we can ask whether it is attractive, i.e. if trajectories started at initial condition \\(x(0)\\) will eventually reach \\(x^\\star\\). This problem is in general difficult to solve (but see below); as an alternative, we can test for local asymptotic stability, i.e., ask whether the system will return to the equilibrium if perturbed infinitesimally away from it. In general, whenever we describe an ecological community as a system of nonlinear, autonomous ODEs: \\[ \\frac{d x_i (t)}{d t} = f_i (x(t)) \\;, \\] we define an equilibrium \\(x^\\star\\) as a vector of densities such that: \\[ \\left. \\frac{d x_i}{d t} \\right|_{{x}^\\star} = f_i ({x}^\\star) = 0 \\quad \\forall i \\] A given system might have a multitude of equilibria. When the system is resting at an equilibrium point, it will remain there unless it is perturbed away from it. Local stability analysis is a method to probe whether a system that is perturbed infinitesimally away from an equilibrium will eventually return to it, or rather move away from it. Taylor series Single-variable: suppose function \\(f\\) infinitely differentiable around a point \\(x = a\\). Then \\[ f(x) = \\sum_{k = 0}^\\infty \\dfrac{D^{k} f(a)}{k!} (x-a)^k = f(a) + \\left. \\dfrac{d f}{d x} \\right|_{a} (x-a)+ \\dfrac{1}{2}\\left. \\dfrac{d^2 f}{d x^2} \\right|_{a} (x-a)^2 + \\cdots \\] where \\(D^{k} f(a)\\) is the \\(k\\)-th derivative of \\(f(x)\\) w.r.t. \\(x\\), evaluated at \\(a\\). Vector-valued functions: now \\(f(x)\\) is a vector-valued function, and \\(x\\) a vector. To expand around the point \\(a\\), we need to define the Jacobian matrix \\[ J = Df(x) \\] with elements: \\[ J_{ij} = \\dfrac{\\partial f_i({x})}{\\partial x_j} \\] Next, we define the Hessian tensor (in this case, a three-dimensional tensor): \\[ H_{ijk} = \\dfrac{\\partial^2 f_i(x)}{\\partial x_j\\, \\partial x_k} \\] It is convenient to write the Taylor expansion in component form: \\[ f_i(x) \\approx f_i(a) + \\sum_j \\left . J_{ij} \\right|_{a} (x_j - a_j) +\\dfrac{1}{2} \\sum_j \\sum_k \\left. H_{ijk} \\right|_a (x_j-a_j)(x_k-a_k) \\] Example Consider the vector-valued function: \\[ f(x) = \\begin{pmatrix} x_1^3 + 2 x_2^2\\\\ x_1 - x_2^3 \\end{pmatrix} \\] Approximate the function around a generic point \\(a = (a_1,a_2)^T\\). The Jacobian is: \\[ J = \\begin{pmatrix} 3 x_1^2 &amp; 4 x_2\\\\ 1 &amp; -3 x_2^2 \\end{pmatrix} \\] and the two slices of the Hessian tensor are: \\[ H_1 = \\begin{pmatrix} 6 x_1 &amp; 0 \\\\ 0 &amp; 4 \\end{pmatrix} \\] and \\[ H_2 = \\begin{pmatrix} 0 &amp; 0 \\\\ 0 &amp; -6 x_2 \\end{pmatrix} \\] as such: \\[ f(x) \\approx \\begin{pmatrix} a_1^3 + 2a_2^2 + 3 a_1^2 (x_1 - a_1)+ 4 a_2 (x_2-a_2) + 3 a_1 (x1-a_1)^2 + 2 (x_2 - a2)^2\\\\ a_1 - a_2^3+x_1-a_1-3 a_2^2 (x_2-a_2)-3 a_2 (x_2 - a_2)^2 \\end{pmatrix} \\] For example, expanding around \\(a = (0, 0)^T\\), we obtain: \\[ f(x) \\approx \\begin{pmatrix} 2 x_2^2\\\\ x_1 \\end{pmatrix} \\] while around \\(a = (2, 1)^T\\), we find: \\[ f(x) \\approx \\begin{pmatrix} 2 (x_2^2 + 3 x_1 (x_1-2) + 4)\\\\ x_1 + 3 x_2(x_2 - 3) + 5 \\end{pmatrix} \\] Note that considering the first two terms of the Taylor expansion results in second-degree polynomials; adding a cubic terms would in general yield a better approximation, etc. Suppose that a system is resting at an equilibrium \\(x^\\star\\), and that it is slightly perturbed away from it. \\(\\Delta x(0) = x(0)-x^\\star\\) is the state of the system immediately after the perturbation. Taylor-expanding around \\(x^\\star\\) and taking only the linear term, we have: \\[ f(\\Delta x(0)) = f(x^\\star)+ \\left. J \\right|_{x^\\star} \\Delta x(0) = \\left. J \\right|_{x^\\star} \\Delta x(0) \\] Where \\(J\\) is the Jacobian matrix of the system, whose elements are defined as: \\[ J_{ij} = \\frac{\\partial f_i({x})}{\\partial x_j} \\] Each element of this matrix is therefore a function, whose value depends on \\(x\\). When we evaluate the Jacobian matrix at an equilibrium point \\(x^\\star\\), we obtain the so-called “community matrix” \\(M\\): \\[ M = \\left. {J} \\right|_{ {x}^\\star} \\] Note that, although each system has a unique Jacobian matrix, there are as many community matrices as there are equilibria. The community matrix details the effect of increasing the density of one species on any other species around the equilibrium point. We can therefore write the differential equation: \\[ \\frac{d \\Delta x(t)}{dt} \\approx M \\Delta x(t) \\] which is a system of linear differential equations—i.e., the simplest type of system of ODEs, which can be solved in full generality. To solve the system, we need to recap a few important concepts from linear algebra. Eigenvalues and eigenvectors For a matrix \\(M\\), we have that if \\(M v = \\lambda v\\) with \\(v\\) different from the zero vector, then \\(\\lambda\\) is an eigenvalue and \\(v\\) the corresponding eigenvector. Practically, you can think of a matrix as an operator that turns a vector into another vector. If the resulting vector is a rescaled version of the initial vector, then you’ve found an eigenvector of the matrix, and the rescaling factor is the associated eigenvalue. For example, show that \\((1, 1)^t\\) is an eigenvector of the matrix: \\[ A = \\begin{pmatrix} 1 + a &amp; 1-a\\\\ 2a + 2 &amp; -2a \\end{pmatrix} \\] We have: \\[ Av = \\begin{pmatrix} (1 + a) v_1 + (1-a) v_2\\\\ (2a + 2) v_1 - 2a v_2 \\end{pmatrix} \\] if \\(v = (1, 1)^t\\), we have: \\[ Av = \\begin{pmatrix} 2\\\\ 2 \\end{pmatrix} = 2\\, v \\] and as such \\(v\\) is an eigenvector of \\(M\\), with associated eigenvalue \\(\\lambda = 2\\). Finding eigenvalues The eigenvalues of a matrix \\(M\\) are the roots (zeros) of the chacteristic polynomial: \\[ p(\\lambda) = \\det(\\lambda I - M) = 0 \\] Where does this equation come from? We write: \\[ \\begin{aligned} A v = \\lambda v\\\\ \\lambda v - Av = 0\\\\ (\\lambda I - A)v = 0 \\end{aligned} \\] if \\(v\\) is nonzero, then the matrix \\(\\lambda I - A\\) must be singular (i.e., have at least one eigenvalue equal to zero). Because the determinant is the product of the eigenvalues, then the determinant must also be zero. For a \\(2 \\times 2\\) matrix, we have: \\[ \\begin{aligned} \\det \\begin{pmatrix} \\lambda - a_{11} &amp; -a_{12}\\\\ -a_{21} &amp; \\lambda -a_{22} \\end{pmatrix} &amp;= (\\lambda - a_{11}) (\\lambda - a_{22}) - a_{12} a_{21}\\\\ &amp;= \\lambda^2 - \\lambda (a_{11} + a_{22}) + a_{11} a_{22} - a_{12} a_{21} \\end{aligned} \\] More compactly, \\[ p(\\lambda) = \\lambda^2 - \\lambda\\, \\text{tr}(A) + \\det(A) \\] where \\(\\text{tr}(M) = \\sum_i M_{ii} = \\sum_i \\lambda_i\\), and \\(\\det(M) = \\prod_i \\lambda_i\\). We therefore find: \\[ \\lambda = \\frac{\\text{tr}(M) \\pm \\sqrt{(\\text{tr}(M))^2 - 4 \\det(M)}}{2} \\] Find the eigenvalues for the matrix \\(A\\) above: \\[ \\begin{aligned} \\lambda &amp;= \\frac{1-a \\pm \\sqrt{(1-a)^2+8(1+a)}}{2}\\\\ &amp;= \\frac{1-a \\pm \\sqrt{(1+a^2 -2 a + 8 a + 8)}}{2} \\\\ &amp;= \\frac{1-a \\pm (a+ 3)}{2} \\end{aligned} \\] The eigenvalues are therefore \\(\\lambda_1 = 2\\) and \\(\\lambda_2 = -(1+a)\\). Facts about eigenvalues and eigenvectors Given a matrix \\(A\\), of size \\(n \\times n\\), a complex number \\(\\lambda\\) is an eigenvalue of \\(A\\) if there is a nonzero (complex) vector \\(v\\) such that \\(A v = \\lambda v\\). The vector \\(v\\) is called the eigenvector of \\(A\\) associated with \\(\\lambda\\). Note that eigenvectors are defined up to multiplication: if \\(v\\) is an eigenvector, then \\(\\alpha\\, v\\), with \\(\\alpha\\) real is also an eigenvector. Often, we choose \\(v\\) such that its norm \\(\\sqrt{\\sum_i v_i^2} = 1\\) (called “unit” eigenvector). A matrix of size \\(n\\) has at most \\(n\\) distinct eigenvalues. If all eigenvalues are distinct then the eigenvectors are linearly independent. This means that if we build the matrix \\(V = (v_1, v_2, \\ldots, v_n)\\), then \\(V\\) is invertible. Because of the fact above, and diagonalizable matrix (e.g., a sufficient condition is to have all eigenvalues distinct), then we can write: \\[ A = V \\Lambda V^{-1} \\] where \\(V\\) is the matrix of eigenvectors, and \\(\\Lambda\\) a diagonal matrix with the eigenvalues of \\(A\\) on the diagonal. As such, \\(V^{-1} A V = \\Lambda\\). This is a “similarity transformation”, meaning that the eigenvalues of \\(A\\) and \\(\\Lambda\\) are (obviously) the same. If the matrix \\(A\\) contains only real numbers (as always the case in population models), then the eigenvalues of \\(A\\) are either real, or form pairs of complex conjugate eigenvalues of form \\(\\alpha \\pm i\\, \\beta\\). This means for example that all odd-sized real matrices have at least one real eigenvalue. If \\(A\\) is real and symmetric, all eigenvalues are real, and all eigenvectors are orthogonal. A diagonal matrix \\(A\\) has eigenvalues \\(\\lambda_i = A_{ii}\\) If \\(A\\) has eigenvalues \\(\\lambda\\), \\(B = \\beta\\, A\\) has eigenvalues \\(\\beta\\, \\lambda\\), and \\(C = A + \\gamma\\, I\\) has eigenvalues \\(\\lambda + \\gamma\\). The eigenvalues of \\(A^2 = A \\times A\\) are \\(\\lambda^2\\), and the eigenvalues of \\(A^{-1}\\) are \\(\\lambda^{-1}\\). The eigenvalues of \\(A^T\\) are the same as those of \\(A\\) (but the eigenvectors are not the same in general). \\(A + A^T\\) (this matrix is symmetric) has only real eigenvalues, and \\(A - A^T\\) (this matrix is skew-symmetric) has purely imaginary eigenvalues. A matrix is positive definite if all its eigenvalues are real and positive. It is positive semi-definite if eigenvalues can be zero. The matrices \\(AA^T\\) and \\(A^T A\\) are positive semi-definite, and have the same eigenvalues up to some zeros (used in PCA). Correlation and covariance matrices have these forms. Provided that some mild conditions are satisfied, a matrix with non-negative entries has a unique largest real eigenvalue with a corresponding eigenvector that can be chosen to have strictly positive components (Perron-Frobenius). A matrix with constant row sums \\(\\theta\\) has \\(\\theta\\) as the largest eigenvalue, and \\(v = 1\\) as the corresponding eigenvector (e.g., Markov Chains). Homework 2a Show that a matrix \\(A\\) with sign-pattern: \\[ S(A) = \\begin{pmatrix} - &amp; +\\\\ - &amp; 0 \\end{pmatrix} \\] has eigenvalues with negative real part. When a matrix is stable due to its sign-pattern (rather than specific values of the coefficients), it is called qualitatively stable. Key paper: May (1973) The idea of “sign-stability” was first introduced in economics. May borrowed the idea to analyze simple food webs. Analysis of ecological models based on sign (rather than magnitude) of coefficients was further developed by Richard Levins and collaborators. A good modern summary, along with a few new results, are provided by Dambacher et al. (2003). We can now analyze systems of linear ODEs. Solution of linear systems of ODEs Matrix exponential In analogy with the power series \\[ e^x = \\sum_{n=0}^{\\infty} \\dfrac{x^n}{n!} = 1 + x + \\dfrac{x^2}{2} + \\dfrac{x^3}{6} + \\dfrac{x^4}{24} + \\ldots \\] we define the matrix exponential \\[ e^X = \\sum_{n=0}^{\\infty} \\dfrac{1}{n!}X^n = I + X + \\dfrac{1}{2}X^2 + \\dfrac{1}{6}X^3 + \\dfrac{1}{24}X^4 + \\ldots \\] where \\(X^2 = X \\times X\\) and so on. Solution of systems of linear ODEs This allows us to solve the system of linear differential equations \\[ \\dfrac{d x(t)}{dt} = A x(t) \\] with \\(x(0) = x_0\\). When the determinant of \\(A\\), \\(\\det A \\neq 0\\), the only equilibrium of the system is \\(x^\\star = 0\\). If \\(\\det A = 0\\) (and \\(A \\neq 0\\)), on the other hand, there are infinitely many equilibria, all belonging to the same line (in 2-d). By writing the solution we can determine whether trajectories will approach or move away from an equilibrium. We write the solution as: \\[ x(t) = e^{A t} x_0 \\] Importantly, we have that, if \\(A\\) is diagonalizable, \\[ e^{A t} = V e^{\\Lambda t}V^{-1} \\] where \\(\\Lambda\\) is the diagonal matrix containing the eigenvalues of \\(A\\). Because \\(\\Lambda\\) is diagonal, we can solve the exponential explicitly: \\[ e^{\\Lambda t} = \\begin{pmatrix}e^{\\lambda_{1}t} &amp; 0 &amp; \\ldots &amp; 0\\\\0&amp; e^{\\lambda_{2}t} &amp; \\ldots &amp; 0\\\\\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\0&amp; 0&amp; \\ldots &amp; e^{\\lambda_{n}t} \\end{pmatrix} \\] Now we want to study the dynamics of the system. To keep the complexity to a minimum, we define \\(y(t) = V^{-1} x(t)\\), meaning that we are choosing the most appropriate coordinates to study our trajectories. Our equation becomes: \\[ \\begin{aligned} x(t) &amp;= V e^{\\Lambda t} V^{-1} x_0\\\\ V^{-1}x(t) &amp;= V^{-1}V e^{\\Lambda t} V^{-1} x_0\\\\ y(t) = e^{\\Lambda t} y_0 \\end{aligned} \\] And therefore \\(y_j(t) = e^{(\\lambda_j)t} y_j(0)\\). Clealry, if all \\(\\lambda_j\\) are real and negative, the trajectories will die out, and the origin \\(y^\\star = 0\\) is stable. Similarly, if any eigenvalue is real and positive, then the perturbation will amplify in at least one direction. Next, we consider \\(\\lambda_j\\) to be complex. In this case, \\(\\lambda_j = \\alpha + i\\, \\beta\\). Using Euler’s formula, we have \\[ y_j(t) = y_j(0)\\, e^{(\\alpha + i\\, \\beta) t} = y_j(0)\\, e^{\\alpha\\, t} (\\cos(\\beta\\, t) + i \\sin(\\beta\\, t)) \\] As such, the solution will oscillate, with damped oscillations whenever \\(a &lt; 0\\) and increasing oscillations when \\(a &gt; 0\\). For example, a case of damped oscillations: and of increasing oscillations: In fact, all the possible trajectories in planar systems can be classified using only the determinant (product of eigenvalues) and the trace (sum of the eigenvalues) of the matrix \\(A\\): Now we can solve the system of ODEs: \\[ \\frac{d \\Delta x(t)}{dt} \\approx M \\Delta x(t) \\] obtaining: \\[ \\Delta x(t) = \\Delta x(0) e^{Mt} = \\Delta x(0) Q e^{\\Lambda t} Q^{-1} \\] Where \\(Q\\) is the matrix containing the (unit) eigenvectors of \\(M\\), and \\(\\Lambda\\) is a diagonal matrix containing the eigenvalues of \\(M\\). As such, the eigenvalues of \\(M\\) determine the stability of the equilibrium \\({x}^\\star\\): if all the eigenvalues have negative real part, then the system will eventually return to the equilibrium after sufficiently small perturbations; conversely, if any of the eigenvalues have positive real part, the system will move away from the equilibrium whenever perturbed. Therefore, depending on the sign of the “rightmost” eigenvalue of \\({M}\\), \\(\\lambda_1\\), we can determine the stability of \\({x}^\\star\\): \\[ \\text{Re}(\\lambda_1) \\begin{cases} &lt; 0 \\to {x}^\\star \\quad \\text{is stable}\\\\ &gt; 0 \\to {x}^\\star \\quad \\text{is unstable} \\end{cases} \\] 2.3 Stability analysis of the Lotka-Volterra Predator-Prey model We still haven’t figured out whether the coexistence equilibrium for the model \\[ \\begin{cases} \\dfrac{d x(t)}{dt} = \\rho\\, x(t) - \\alpha\\, x(t)\\, y(t)\\\\ \\dfrac{d y(t)}{dt} = -\\delta\\, y(t) + \\beta\\, x(t)\\, y(t) \\end{cases} \\] is stable or not. The Jacobian becomes: \\[ J = \\begin{pmatrix} \\rho - \\alpha\\, y &amp; -\\alpha\\, x\\\\ \\beta\\, y &amp; -\\delta + \\beta\\, x \\end{pmatrix} \\] The community matrix for the equilibrium \\((x^\\star, y^\\star)^T = (0, 0)^T\\) is: \\[ M_0 = \\left . J \\right|_{(0, 0)^T} = \\begin{pmatrix} \\rho &amp; 0\\\\ 0 &amp; -\\delta \\end{pmatrix} \\] which has eigenvalues \\(\\rho &gt; 0\\) amd \\(-\\delta &lt; 0\\) — the equilibrium is unstable. The coexistence equilibrium \\((x^\\star, y^\\star)^T = (\\delta / \\beta, \\rho / \\alpha)^T\\) yields the community matrix: \\[ M_c = \\left . J \\right|_{(\\delta / \\beta, \\rho / \\alpha)^T} = \\begin{pmatrix} 0 &amp; \\dfrac{\\alpha\\, \\delta}{\\beta} \\\\ -\\dfrac{\\beta\\, \\rho}{\\alpha} &amp; 0 \\end{pmatrix} \\] which has purely imaginary eigenvalues \\(\\lambda = \\pm i \\sqrt{\\rho \\, \\delta}\\). As such the equilibrium is not attractive nor unstable. In fact, Lotka and Volterra were (independently) able to prove that the system cycles neutrally around the equilibrium. Vito Volterra (1860-1940) Vito Volterra was born in Ancona (then part of the Papal State) in a poor jewish family. The financial situation precipitated with the death of his father, when Vito was two. Vito and his mother went to live with relatives in Turin and then Florence. Volterra showed amazing mathematical talent at a very young age. Antonio Roiti, professor of physics in Florence, noticed the budding mathematician and hired him as his assistant, so that he could continue his studies. He went on to enroll at the Scuola Normale in Pisa, receiving a degree in Physics in 1882. At age 23 he was made full professor of Rational Mechanics in Pisa, and then in 1900 of Mathematical Physics in Rome. For thirty years, he contributed important studies in mathematics, and enriched academic life in Italy (for example, he was the first director of the National Center for Research). In 1931 he refused to take an oath of loyalty to the fascist regime (only 12 professors out of 1250 refused), and was therefore forced to resign (his take on the fascist enterprise: “Empires die, but Euclid’s theorems keep their youth forever”). His interest in mathematical ecology is due to Umberto D’Ancona (his son-in-law), who had studied the trends in fisheries in the Adriatic sea before and immediately after WWI. In 1914-1918 fisheries in the Adriatic had stopped completely because of the conflict. D’Ancona had noticed that, while herbivorous fish had remained about constant, the piscivorous fish had increased dramatically in numbers. The problem piqued Volterra who immediately published a sophisticated study, proposing the same equations studied by Lotka. In a short letter to Nature (Volterra 1926a), he stated the so-called “Volterra’s Effect” (which he termed “Law III”): “a complete closure of the fishery was a form of ‘protection’ under which the voracious fishes were much the better and prospered accordingly, but the ordinary food-fishes, on which these are accustomed to prey, were worse off than before.” This brief paper was a summary of a much more extensive article (Volterra 1926b). Lotka-Volterra interactions In 1927, Lotka wrote to Nature to raise the issue that the equations studied by Volterra and the figures presented in Volterra’s brief article were identical to those found in Elements of Physical Biology (published in 1925). He concluded: “It would be gratifying if Prof. Volterra’s publication should direct attention to a field and method of inquiry which apparently has hitherto passed almost unnoticed.” Volterra graciously conceded “I recognize his priority, and am sorry not to have known his work, and therefore not have been able to mention it.” He however listed a few points in which the two authors had pursued different directions, and concluded “Working independently the one from the other, we have found some common results, and this confirms the exactitude and the interest in the position of the problem. I agree with him in his conclusions that these studies and these methods of research deserve to receive greated attention from scholars, and should give rise to important applications.” 2.3.1 Constant of motion for Lotka-Volterra Predator-Prey Volterra wrote: \\[ \\dfrac{d x(t)}{d y(t)} = \\dfrac{\\rho\\, x(t) - \\alpha\\, x(t)\\, y(t)}{-\\delta\\, y(t) + \\beta\\, x(t)\\, y(t)} \\] As such: \\[ (-\\delta\\, y + \\beta\\, x\\, y)\\, d x = (\\rho\\, x - \\alpha\\, x\\, y)\\, d y \\] dividing both sides by \\(x\\, y\\), we obtain: \\[ \\left(-\\dfrac{\\delta}{x} + \\beta \\right)\\, d x = \\left(\\dfrac{\\rho}{y} - \\alpha \\right)\\, d y \\] Integrating both sides: \\[ \\beta\\, x - \\delta\\, \\log x = - \\alpha\\, y + \\rho\\, \\log y + C \\] where \\(C\\) is a constant of integration. Rearranging, and substituting \\(x^\\star = \\delta / \\beta\\) and \\(y^\\star = \\rho / \\alpha\\), we obtain: \\[ \\beta (x - x^\\star \\log x) + \\alpha (y - y^\\star \\log y) = C \\] This means that the system has a constant of motion (a.k.a. “first integral”): the value of \\(C\\) depends on the initial conditions, and then the system will cycle around the equilibrium in closed orbits. Note that a) \\(C&gt;0\\) if the initial conditions are different from the equilibrium; b) \\(C = C_m &gt; 0\\) if we are at equilibrium; and therefore c) \\(C \\geq C_m\\) for all (positive) initial conditions. We can use \\(C\\) as a Lyapunov function: \\[ V(x,y) = \\beta (x - x^\\star \\log x) + \\alpha (y - y^\\star \\log y) \\] \\[ \\dfrac{d V(x,y)}{dt} = \\left(\\beta - \\dfrac{\\delta}{x} \\right) \\dfrac{dx}{dt}+\\left(\\alpha - \\dfrac{\\rho}{y} \\right) \\dfrac{dy}{dt} = 0 \\] As such, the dynamics are such that \\(V(x,y)\\) remains constant. 2.3.2 Analysis of Predator-Prey model with logistic growth for the prey In the classic Lotka-Volterra model, the local stability analysis of the coexistence equilibrium is inconclusive. When however the prey grows logistically it is easy to show that the equilibrium is now stable. For example, consider the system \\[ \\begin{cases} \\dfrac{dx}{dt} = x (1 - x/2 -y)\\\\ \\dfrac{dy}{dt} = y (x - 1) \\end{cases} \\] First, we find the equilibria. From the first equation, we have \\(x^\\star = 0\\), or \\(y^\\star = 1 - x^\\star /2\\); from the second equation, we have \\(y^\\star = 0\\) or \\(x^\\star = 1\\). Combining them, we find that either \\((x^\\star, y^\\star) = (0, 0)\\) (trival), \\((x^\\star, y^\\star) = (2, 0)\\) (boundary), or \\((x^\\star, y^\\star) = (1, 1/2)\\) (coexistence). The isoclines of zero growth are \\(y = 1 - x/2\\) for the prey, and \\(x = 1\\) for the predator. The Jacobian for the system is \\[ J = \\begin{pmatrix} 1 - x - y &amp; -x\\\\ y &amp; x -1 \\end{pmatrix} \\] At the equilibrium \\((x^\\star, y^\\star) = (1, 1/2)\\), we have: \\[ M = \\begin{pmatrix} - \\frac{1}{2} &amp; -1\\\\ \\frac{1}{2} &amp; 0 \\end{pmatrix} \\] The trace is \\(-1/2\\) and the determinant \\(1/2\\), as such the equilibrium is stable. The eigenvalues are given by: \\[ p(\\lambda) = \\lambda^2 + \\frac{1}{2} \\lambda + \\frac{1}{2} \\] Obtaining: \\[ \\lambda = \\dfrac{-\\frac{1}{2} \\pm \\sqrt{\\frac{1}{4} - 2}}{2} = \\dfrac{-1 \\pm i \\sqrt{7}}{4} \\] And as such small perturbations will oscillate back to equilibrium. Numerically: 2.3.2.1 Global stability We can write a Lyapunov function for the system above. Take: \\[ V(x,y) = \\left(x - x^\\star - x^\\star \\log \\dfrac{x}{x^\\star} \\right) + \\left(y - y^\\star - y^\\star \\log \\dfrac{y}{y^\\star} \\right) = (x - 1 - \\log x) + \\left(y - \\dfrac{1}{2} - \\dfrac{1}{2} \\log 2y \\right) \\] Derive with respect to time to obtain: \\[ \\dfrac{d V(x,y)}{dt} = -\\dfrac{1}{2}(1-x)^2 &lt; 0 \\] As such, the equilibrium \\((x^\\star, y^\\star) = (1, 1/2)\\) is globally stable. Homework 1b Take the competitive Lotka-Volterra model: \\[ \\dfrac{dx}{dt} = D(x) (r - Ax) \\] with the coefficients of \\(r = (r_1, r_2)^T\\) and \\(A\\) all positive. Discuss the existence of a coexistence equilibrium and its stability. Write a Lyapunov function for the case in which \\(A_{11} = A_{22} &gt; A_{12} = A_{21}\\). References "],
["generalized-lotka-volterra-model.html", "Lecture 3 Generalized Lotka-Volterra model 3.1 A single population 3.2 Multi-species dynamics 3.3 MacArthur’s consumer-resource model 3.4 Further readings", " Lecture 3 Generalized Lotka-Volterra model We can write the Generalized Lotka-Volterra model in a compact form as: \\[ \\dfrac{dx(t)}{dt} = D(x(t))(r + A x(t)) = X(r + Ax) \\] where \\(x(t)\\) is a (column) vector of length \\(n\\) containing the densities of all populations \\(1, \\ldots, n\\) at time \\(t\\), \\(r\\) is a vector of “intrinsic growth rates” (or death rates, when negative), measuring the growth (decline) of population \\(i\\) when grown alone at low density, and \\(A\\) is a \\(n \\times n\\) matrix of interaction coefficients. We use \\(D(x)\\) to denote the diagonal matrix with \\(x\\) on the diagonal. 3.1 A single population The simplest case to study is that of a single population, in which case the equation becomes that of the logistic growth: \\[ \\dfrac{dx(t)}{dt} = x(t)(\\rho + \\alpha x(t)) \\] As we’ve seen before, this is a separable ODE, with solution: \\[ x(t) = \\frac{\\rho\\, {x_0}\\, e^{\\rho t}}{\\rho- \\alpha\\, {x_0} \\left(e^{\\rho t}-1\\right)} \\] 3.1.1 Metapopulation dynamics Consider a fragmented landscape in which habitable patches are connected by dispersal (for simplicity, suppose that all patches are reachable from any other). Call \\(p(t)\\) the proportion of patches occupied by the species of interest at time \\(t\\), and assume that a) an empty patch (the proportion of empty patches is \\(1 - p(t)\\)) is colonized by the species with rate \\(\\gamma\\, p(t)\\), where \\(\\gamma\\) is the “colonization rate”, and b) that occupied patches become empty at rate \\(\\epsilon\\, p(t)\\) (“extinction rate”). We want to model the proportion of patches occupied by the population at time \\(t\\) (Levins 1969): \\[ \\dfrac{d p(t)}{dt} = \\gamma\\, p(t)(1 - p(t)) - \\epsilon\\, p(t) = p(t) ((\\gamma - \\epsilon) - \\gamma\\, p(t)) \\] which is equivalent to the logistic equation above with \\(\\rho = \\gamma -\\epsilon\\) and \\(\\alpha = -\\gamma\\). As such, asymptotically the proportion of patches occupied by the population will be \\(-\\rho/\\alpha = (\\gamma -\\epsilon) / \\gamma\\). 3.1.2 S-I-S model Consider a population of individuals, each of which can be in one of two states: susceptible to a disease, or infective/infected. Call \\(S(t)\\) the proportion of susceptible individuals at time \\(t\\), and \\(I(t)\\) the proportion of infected individuals, with \\(S(t) + I(t) = 1\\). When individuals meet, an infected individual can transmit the disease to susceptibles with rate \\(\\beta\\); infected individuals recover from the disease with rate \\(\\gamma\\), and return susceptible. We can write the system of equations: \\[ \\begin{cases} \\dfrac{d S(t)}{dt} = -\\beta S(t) I(t) + \\gamma I(t)\\\\ \\dfrac{d I(t)}{dt} = \\beta S(t) I(t) - \\gamma I(t) \\end{cases} \\] take the second equation, and substitute \\(S(t) = 1 - I(t)\\); rearranging: \\[ \\dfrac{d I(t)}{dt} = \\beta (1-I(t)) I(t) - \\gamma I(t) = I(t)(\\beta - \\gamma -\\beta I(t)) \\] which is again the equation for the logistic growth with \\(\\rho = \\beta - \\gamma\\) and \\(\\alpha = -\\beta\\). As such, provided that \\(\\beta -\\gamma &gt; 0\\), asymptotically a fraction \\((\\beta - \\gamma) / \\beta\\) of individuals will be infected. The condition \\(\\beta -\\gamma &gt; 0 \\to \\beta &gt; \\gamma \\to \\beta/ \\gamma &gt; 1\\) is often written as \\(\\mathcal R_0 = \\beta/ \\gamma &gt; 1\\). 3.2 Multi-species dynamics 3.2.1 Existence of an equilibrium Returning to the multi-species system, and in analogy with the single species, we can look for stationary points (equilibria). If the matrix \\(A\\) is not singular, then we can look for a solution of \\(r + Ax\\) that has positive components (called a feasible equilibrium). If such point exists, it is unique and is the solution of \\(Ax^\\star = -r\\), \\(x^\\star = -A^{-1}r\\). Suppose that the GLV has no feasible equilibrium. Then all trajectories (if bounded; some could grow to infinity) reach the boundary of \\(\\mathbb R^n_{0+}\\). Practically, this means that to ensure coexistence of all species, it is necessary to have an equilibrium in the interior \\(\\mathbb R^n_{+}\\). For a proof, see Theorem 5.2.1 in Hofbauer and Sigmund (1998). 3.2.2 Stability of the coexistence equilibrium Suppose that a feasible equilibrium \\(x^\\star\\) exists. For the GLV model, the Jacobian is easy to compute: \\[ J_{ij} = \\frac{\\partial f_i}{\\partial x_j} = A_{ij} x_i \\] and \\[ J_{ii} = \\frac{\\partial f_i}{\\partial x_i} = r_i + \\sum_j A_{ij} x_j + A_{ii} x_i \\] At equilibrium \\(r_i + \\sum_j A_{ij} x_j = 0\\), and therefore: \\[ M = \\left. {J} \\right|_{ {x}^\\star} = D(x^\\star)A \\] If the eigenvalues of \\(M\\) have all negative real part, then \\(x^\\star\\) is locally asymptotically stable. D-stability and Lyapunov-Diagonal Stability A matrix \\(A\\) is called stable if all its eigenvalues have negative real part. A matrix \\(A\\) is called D-stable if \\(D(x) A\\) is stable for every choice of \\(x\\) such \\(x_i &gt; 0\\; \\forall i\\). While conditions for D-stability are not known for matrices of size greater than 3, a sufficient condtion for D-stability is that there exists a diagonal matrix \\(D\\) with positive elements on the diagonal such that \\(DA + A^T D\\) is negative definite (i.e., has negative eigenvalues). Consequences for Lotka-Volterra dynamics If a matrix \\(A\\) is stable and symmetric, it is D-stable (just take \\(D = I\\)). Take a stable, non symmetric matrix \\(A\\) such that \\(A + A^T\\) is negative definite. Then any feasible equilibrium is stable: we have \\(M = D(x^\\star)A\\), but if \\(A\\) is D-stable then \\(M\\) is stable. 3.2.3 Types of dynamics As we’ve seen before, for a single population, there are only three types of dynamics that can be displayed by a GLV model: either the population grows to infinity, shrinks to zero, or asymptotically reaches a steady state. Smale (1976) and Hirsch (1982) showed that limit cylces are possible for three or more species, and that any dynamics can be found for competitive GLV systems with five or more species. A few examples taken from Barabás, J. Michalska-Smith, and Allesina (2016). First, a competitive system in which a feasible equilibrium does not exist, leading to the extinction of a species. For example, take \\[ r = \\begin{pmatrix} 1\\\\ 1\\\\ 1 \\end{pmatrix}\\;\\;A = -\\begin{pmatrix} 10 &amp; 9 &amp; 5 \\\\ 9 &amp; 10 &amp; 9\\\\ 5 &amp; 9 &amp; 10 \\end{pmatrix} \\] The coexistence equilibrium is not feasible: \\[ -A^{-1}r = \\begin{pmatrix} -\\dfrac{1}{12}\\\\ \\dfrac{1}{4}\\\\ -\\dfrac{1}{12}\\\\ \\end{pmatrix} \\] and as such dynamics will lead to a boundary equilibrium: Showing that species 2 goes extinct. Then, a case in which the equilibrium exists, and is attractive (stable). Take: \\[ r = \\begin{pmatrix} 10\\\\ 10\\\\ 10 \\end{pmatrix}\\;\\;A = -\\begin{pmatrix} 10 &amp; 7 &amp; 12 \\\\ 15 &amp; 10 &amp; 8\\\\ 7 &amp; 11 &amp; 10 \\end{pmatrix} \\] Now the coexistence equilibrium is feasible: \\[ -A^{-1}r = \\dfrac{1}{301}\\begin{pmatrix} 50\\\\ 110\\\\ 145\\\\ \\end{pmatrix} \\] and locally stable (the eigenvalues of \\(D(x^\\star) A)\\) have negative real part). For a symmetric matrix, local stability implies global stability. Hence, starting from positive initial conditions for all species, we will eventually converge to the equilibrium: With three competitors we can find stable limit cycles (this requires a feasible, unstable equilibrium): And with four or more species we can have chaos (also here we need a feasible, unstable coexistence equilibrium): 3.2.4 The equilibrium is the time-average Suppose that \\(x(t)\\) has a periodic orbit of period \\(T\\) (i.e., we assume \\(x(0) = x(T)\\)). Further, assume that the GLV has a feasible, interior equilibrium \\(x^\\star\\). We want to calculate the average density for each species: \\[ \\frac{1}{T} \\int_0^T x(t) dt \\] First, we assume that \\(x(t) &gt; 0\\) and write the dynamics of its logarithm: \\[ \\dfrac{d \\log(x_i(t))}{dt} = \\dfrac{1}{x_i(t)}\\dfrac{d x_i(t)}{dt} = r_i + \\sum_j A_{ij} x_j(t) \\] In vector form: \\[ \\dfrac{d \\log x(t)}{d t} = r + A x(t) \\] Compute the average on both sides: \\[ \\frac{1}{T}\\int_0^T \\frac{d \\log(x(t))}{dt} dt= \\frac{1}{T}\\int_0^T \\left(r + Ax \\right) dt \\] yielding: \\[ \\frac{1}{T}(\\log(x(T)) - \\log(x(0))) = 0 = r + A \\left( \\frac{1}{T} \\int_0^T x(t) dt \\right) \\] Note that the l.h.s. is zero because \\(x(0) = x(T)\\). Multiplying by the matrix inverse and rearranging: \\[ -A^{-1} r = x^\\star = \\frac{1}{T} \\int_0^T x(t) dt \\] showing that the average density is in fact the equilibrium. With a similar argument, one can prove that if the trajectory stays in a compact space (i.e., in case of chaotic attractors), then long-time average is still \\(x^\\star\\). 3.2.5 Lyapunov diagonal stability and global stability Suppose that there is a positive diagonal matrix \\(C\\) such that \\(C A + A^T C\\) is negative definite (i.e., has only negative eigenvalues; the eigenvalues are real because the matrix is symmetric). Then \\(A\\) is Lyapunov-diagonally stable. If this is the case, then \\(A\\) is stable, and any \\(D A\\) with \\(D\\) positive is also stable (called \\(D-\\)stability). Further, suppose that the GLV system with parameters \\(A\\) and \\(r\\) has a feasible equilibrium point \\(x^\\star\\). Then the function: \\[ V(x(t)) = 1^T C \\left( x(t) -D(x^\\star) \\log x(t)\\right) \\] is a Lyapunov function for the GLV system. To prove this point, we start from \\(r = -Ax^\\star\\). Substituting, we can write the GLV system as \\(dx(t)/dt = D(x)A(x - x^\\star)\\); similarly, we can write \\(d \\log x(t)/dt = A(x - x^\\star)\\). Taking the derivative of \\(V\\) with respect to time: \\[ \\begin{aligned} \\frac{d V(x(t))}{dt} &amp;= 1^T C \\left(\\frac{d x(t)}{dt} + D(x^*) \\frac{d \\log x(t)}{dt} \\right)\\\\ &amp;= 1^T C \\left(A (x - x^\\star) + D(x^*) A (x - x^\\star) \\right)\\\\ &amp;= 1^T C \\left(D(x - x^\\star) A (x - x^\\star) \\right)\\\\ &amp;= 1^T \\left(D(x - x^\\star) C A (x - x^\\star) \\right)\\\\ &amp;= (x - x^\\star)^T CA (x - x^\\star)\\\\ &amp;= \\frac{1}{2}(x - x^\\star)^T (CA + A^T C) (x - x^\\star)\\\\ \\end{aligned} \\] A matrix \\(B\\) is negative definite if \\(y^T B y &lt; 0\\) for all \\(y \\neq 0\\). As such \\(\\frac{d V(x(t))}{dt} \\leq 0\\), i.e., will decrease in time (starting from any \\(x(0)\\)) until the equilibrium \\(x^\\star\\) is reached. The results above show that if \\(A\\) is Lyapunov diagonally-stable and a feasible equilibrium \\(x^\\star\\) exists, than all trajectories starting at a positive density will converge to the equilibrium. This property is often used to prove global stability. EXERCISE ON TYPE OF DYNAMICS 3.3 MacArthur’s consumer-resource model History: Robert H. MacArthur (1930-1972) Robert MacArthur was born in Toronto, and moved to Vermont when his father (a geneticist) became a professor at Marlboro College. He studied mathematics first at Marlboro College and then at Brown University. He enrolled as a PhD student in mathematics at Yale, but quickly switched to studying ecology with George Evelyn Hutchinson. He was a professor first at the University of Pennsylvania and then at Princeton University. In his brief career (he died at age 45) he revolutionized ecology, by making it into a rigorous, predictive science based on general principles. He is recognized for developing the Theory of Island Biogeography (with E. O. Wilson, MacArthur and Wilson (2001)), the investigation of limiting similarity (with R. Levins, MacArthur and Levins (1967)), the contributions to the complexity-stability debate (MacArthur (1955), see next lecture). The consumer-resource model he proposed in 1969 now bears his name (published also in MacArthur (1970) in a longer form—the first paper in the journal Theoretical Population Biology!). Consumer-resource; separation of time-scales; turn into symmetric Lotka-Volterra; Lyapunov function 3.4 Further readings On the theory of GLV: Strogatz (2018) is a simple introduction to dynamical systems and bifurcation theory. Hofbauer and Sigmund (1998) is a wonderful introduction to dynamical systems in ecology and population genetics, with a nice introduction to evolutionary game theory. Hadeler, Mackey, and Stevens (2017) contains a more mathematically-oriented treatment of the material covered in the first part of this lecture. Baigent (2016) is a mathematical introduction to Lotka-Volterra dynamics. References "],
["stability-of-large-ecological-communities.html", "Lecture 4 Stability of large ecological communities 4.1 Further readings", " Lecture 4 Stability of large ecological communities As we have seen before, an equilibrium \\(x^\\star\\) is stable if the community matrix for the equilibrium has all eigenvalues with negative real part. In general, to determine the equilibrium and its stability, we would need to specify all the growth rates (\\(r\\), \\(n\\) values), as well as the matrix of interactions (\\(A\\), \\(n^2\\) values). This is impractical to do for large systems (though we will try this out later). But can something quite general be said about the limit in which many species are in the community? May (1972) attempted to answer this question by considering a random community matrix. In a GLV system, the diagonal elements \\(m_{ii} = a_{ii} x_i^\\star\\) are influenced by self-regulation (i.e., as in a carrying capacity), while the off-diagonal elements \\(m_{ij} = a_{ij} x_i^\\star\\) model the effect of species \\(j\\) on the equilibrium of species \\(i\\). May considered the following algorithm to build a random community matrix. Take a large community, resting at an unspecified, feasible equilibrium; we build the community matrix by setting: \\(m_{ij} = 0\\) with probability \\((1-C)\\); with probability \\(C\\) we draw \\(m_{ij}\\) from a distribution with mean zero and variance \\(\\sigma^2\\). \\(C\\) is the proportion of realized connections, termed the “connectance” of the system. the diagonal elements are set to \\(-d\\), modeling self-regulation. For example, the code uses a normal distribution: build_May_normal &lt;- function(n, C, d, sigma){ # fill the whole matrix M &lt;- matrix(rnorm(n * n, mean = 0, sd = sigma), n, n) # remove connections M &lt;- M * matrix(runif(n * n) &lt;= C, n, n) # set diagonals diag(M) &lt;- -d return(M) } Note that the average of the eigenvalues of a matrix \\(A\\) is given by the average of its diagonal elements \\(\\frac{1}{n}\\sum_i \\lambda_i = \\frac{1}{n} \\text{Tr}(A) = \\frac{1}{n} \\sum_i A_{ii}\\). As such, if \\(A = dI + B\\), the eigenvalues of \\(A\\) will be those of \\(B\\) shifted by \\(d\\). We want to determine whether the equilibrium will be stable, given \\(n\\), \\(C\\), \\(d\\) and \\(\\sigma^2\\). To do so, we need to find the location of the “rightmost” eigenvalue of \\(M\\). For example, let’s plot the eigenvalues of a large matrix: plot_eigenvalues &lt;- function(M, prediction = NULL){ eig &lt;- eigen(M, only.values = TRUE)$values dt &lt;- tibble(Real = Re(eig), Imaginary = Im(eig)) pl &lt;- ggplot(dt) + aes(x = Real, y = Imaginary) + geom_point() + coord_equal() + geom_vline(xintercept = 0, colour = &quot;red&quot;, linetype = 2) if (is.null(prediction) == FALSE) { pl &lt;- pl + geom_vline(xintercept = prediction, colour = &quot;black&quot;, linetype = 2) } show(pl) } set.seed(100) # for reproducibility # parameters n &lt;- 500 C &lt;- 0.5 d &lt;- 10 sigma &lt;- 1 M &lt;- build_May_normal(n, C, d, sigma) plot_eigenvalues(M) The eigenvalues fall into an almost perfect circle! Turns out, that this is the behavior we should expect, as stated by the so-called “Circular Law”, one of the most beautiful results in random matrix theory. Circular law: Take a non-symmetric, \\(S \\times S\\) random matrix in which all coefficients \\(X_{ij}\\) are i.i.d. random variables with \\(\\mathbb E[X_{ij}] = 0\\) and \\(\\mathbb E[X_{ij}] = 1\\). Then, as \\(S \\to \\infty\\), the e.s.d. of \\({X} / \\sqrt{S}\\) converges to the circular law: \\[ \\mu(\\lambda) = \\begin{cases} \\frac{1}{\\pi} \\; \\; \\; \\text{if} \\; (\\text{Re}(\\lambda))^2 + (\\text{Im}(\\lambda))^2 \\leq 1\\\\ 0 \\; \\; \\;\\text{ otherwise}. \\end{cases} \\] This result can be used to calculate the radius of the eigenvalue distribution of the matrices studied by May: when the off-diagonal coefficients \\(M_{ij}\\) are 0 with probability \\(1-C\\) and are sampled independently from a distribution with mean \\(0\\) and variance \\(\\sigma^2\\) with probability \\(C\\), we have that \\(\\mathbb E[M_{ij}] = 0\\) and \\(\\mathbb E[M_{ij}^2] = C \\sigma^2\\). This means that if we were to divide the coefficients of \\({M}\\) by \\(\\sqrt{C \\sigma^2}\\) we would recover the unit variance, and the matrix would follow the circular law when \\(S\\) is large. Armed with this, we can calculate the radius: if the radius of \\({M} / \\sqrt{S C \\sigma^2}\\) converges to 1 when the matrix is large, then the radius of \\({M}\\) is approximately \\(\\sqrt{S C \\sigma^2}\\). For stability, we need a sufficiently negative diagonal (setting the center of the circle), yielding May’s stability criterion: \\[ \\sqrt{S C \\sigma^2} &lt; d \\] We can try this on our matrix: prediction &lt;- sqrt(n * C * sigma^2) - d plot_eigenvalues(M, prediction) Showing that we accurately approximate the location of the rightmost eigenvalue. Note that, in the case of large \\(n\\), whenever the circle crosses zero, some eigenvalues will be positive, determining the instability of the equilibrium. Importantly, the distribution from which the coefficients are sampled does not matter—only that the mean is zero and that the variance is \\(\\sigma^2\\). For example, build the matrix using coefficients from a uniform distribution: build_May_uniform &lt;- function(n, C, d, sigma){ # fill the whole matrix (sqrt(3) to ensure var = sigma^2) M &lt;- matrix(runif(n * n, min = -sqrt(3) * sigma, max = sqrt(3) * sigma), n, n) # remove connections M &lt;- M * matrix(runif(n * n) &lt;= C, n, n) # set diagonals diag(M) &lt;- -d return(M) } # parameters n &lt;- 500 C &lt;- 0.5 d &lt;- 10 sigma &lt;- 1 M &lt;- build_May_uniform(n, C, d, sigma) prediction &lt;- sqrt(n * C * sigma^2) - d plot_eigenvalues(M, prediction) This property is called universality in random matrix theory. In ecological communities, the effect of species \\(i\\) on \\(j\\) and that of \\(j\\) on \\(i\\) are typically not independent (as assumed above): in the case of competition between species, we expect them both to be negative; for consumption, if one is positive, the other is negative, and so forth. A more refined model of a random matrix would therefore sample interactions in pairs from a bivariate distribution. The elliptic law can deal with this case: Elliptic law: Take a non-symmetric, \\(S \\times S\\) random matrix in which the pairs of coefficients \\((X_{ij}, X_{ji})\\) are sampled independently from a bivariate distribution defined by a vector of means \\(m = (0,0)^t\\) and a covariance matrix \\(\\Sigma = \\begin{pmatrix} 1 &amp; \\rho\\\\ \\rho &amp; 1 \\end{pmatrix}\\). Then, as \\(S \\to \\infty\\), the e.s.d. of \\({X} / \\sqrt{S}\\) converges to the elliptic law: \\[ \\mu(\\lambda) = \\begin{cases} \\frac{1}{\\pi (1 - \\rho^2) } \\quad \\text{if} \\; \\frac{(\\text{Re}(\\lambda))^2}{(1 + \\rho)^2} + \\frac{(\\text{Im}(\\lambda))^2}{(1 -\\rho)^2} \\leq 1\\\\ 0 \\quad \\quad \\quad \\text{ otherwise} \\end{cases} \\] Note that when \\(\\rho = 0\\), the elliptic law reduces to the circular law. Using the elliptic law, Allesina and Tang (2012) were able to extend May’s criterion to ecological networks with different mixtures of interaction types. In particular, the stability criterion becomes: \\[ \\sqrt{S C \\sigma^2}(1 + \\rho) &lt; d \\] To see the elliptic law in action, we can build matrices in which we sample the coefficients in pairs from a bivariate normal distribution: build_Allesina_Tang_normal &lt;- function(n, C, d, sigma, rho){ # sample coefficients in pairs pairs &lt;- MASS::mvrnorm(n = n * (n-1) / 2, mu = c(0, 0), Sigma = sigma^2 * matrix(c(1, rho, rho, 1), 2, 2)) # build a completely filled matrix M &lt;- matrix(0, n, n) M[upper.tri(M)] &lt;- pairs[,1] M &lt;- t(M) M[upper.tri(M)] &lt;- pairs[,2] # determine which connections to retain Connections &lt;- (matrix(runif(n * n), n, n) &lt;= C) * 1 Connections[lower.tri(Connections)] &lt;- 0 diag(Connections) &lt;- 0 Connections &lt;- Connections + t(Connections) M &lt;- M * Connections diag(M) &lt;- -d return(M) } We can see that a positive connectance leads to an eigenvalue distribution that describes an horizontally-stretched ellipse (and hence, more difficult to stabilize than the circle): # parameters n &lt;- 500 C &lt;- 0.5 d &lt;- 10 sigma &lt;- 1 rho &lt;- 0.4 M &lt;- build_Allesina_Tang_normal(n, C, d, sigma, rho) prediction &lt;- sqrt(n * C * sigma^2) * (1 + rho) - d plot_eigenvalues(M, prediction) Similarly, a negative correlation (e.g., as in predator-prey) would make the system easier to stabilize: # parameters n &lt;- 500 C &lt;- 0.5 d &lt;- 10 sigma &lt;- 1 rho &lt;- -0.4 M &lt;- build_Allesina_Tang_normal(n, C, d, sigma, rho) prediction &lt;- sqrt(n * C * sigma^2) * (1 + rho) - d plot_eigenvalues(M, prediction) 4.1 Further readings On random matrices and stability: Allesina and Tang (2015) is an opinionated review on applications of random matrices in ecology. References "],
["ecological-assembly.html", "Lecture 5 Ecological assembly", " Lecture 5 Ecological assembly "],
["game-theory-and-replicator-dynamics.html", "Lecture 6 Game theory and replicator dynamics", " Lecture 6 Game theory and replicator dynamics "],
["quasi-polynomial-systems.html", "Lecture 7 Quasi-polynomial systems", " Lecture 7 Quasi-polynomial systems "],
["predicting-coexistence-in-ecological-communities.html", "Lecture 8 Predicting coexistence in ecological communities", " Lecture 8 Predicting coexistence in ecological communities "],
["references.html", "References", " References "],
["random-bits-and-pieces.html", "Lecture 9 Random bits and pieces 9.1 Stability of larger matrices 9.2 Exercise", " Lecture 9 Random bits and pieces 9.1 Stability of larger matrices There are a number of techniques that can be used to prove the stability of larger systems. 9.1.1 Descartes’ rule of signs For a single-variable polynomial with real coefficients are ordered by descending variable exponent, then the number of positive roots of the polynomial is either equal to the number of sign differences between consecutive nonzero coefficients, or is less than it by an even number. Multiple roots of the same value are counted separately. As such, if a polynomial has all coefficients of the same sign, it has no positive roots. By considering \\(p(-\\lambda)\\) we can find the maximum number of negative roots. For example, for the Lotka-Volterra predator-prey model, we have \\[ M = \\begin{pmatrix} 0 &amp; -\\dfrac{ad}{b}\\\\ \\dfrac{bg}{d} &amp; 0 \\end{pmatrix} \\] The characteristic polynomial is \\[ p(\\lambda) = \\lambda^2 + \\dfrac{g}{d} \\] Meaning that the number of positve roots is zero. Taking \\(p(-\\lambda) = (-\\lambda)^2 + \\dfrac{g}{d}\\) which again has only positive coefficients, meaning that the number of negative roots is also zero. As such, the eigenvalues are purely imaginary (center), \\(\\lambda = \\pm i \\sqrt{g / d}\\). 9.1.2 Routh-Hurwitz criterion You can use the coefficients of the polynomial to determine stability. The polynomial \\[ p(\\lambda) = \\lambda^2 + a_1 \\lambda + a_0 \\] has all roots in the left half-plane (stable equilibrium) if \\(a_0 &gt; 0\\) and \\(a_1 &gt; 0\\). Note that, in this case \\(a_0 = \\det(A)\\) and \\(a_1 = -\\text{tr}(A)\\). Similarly, the polynomial \\[ p(\\lambda) = \\lambda^3 + a_2 \\lambda^2 + a_1 \\lambda + a_0 \\] has roots in the left half-plane if \\(a_2 &gt; 0\\), \\(a_0 &gt; 0\\), and \\(a_2 a_1 &gt; a_0\\). These conditions can be extended to larger matrices, but they become increasingly involved. 9.1.3 Bounding eigenvalues using the symmetric part Call \\(\\lambda_1 (A)\\) the eigenvalue of \\(A\\) with the largest real part (i.e., the “rightmost” eigenvalue). Then \\[ \\Re (\\lambda_1 (A)) \\leq \\lambda_1 ((A + A^T ) / 2) \\] if \\(\\lambda_1 ((A + A^T ) / 2) &lt; 0\\), then \\(A\\) is stable, and any matrix \\(DA\\) with \\(D\\) diagonal and positive is stable (\\(D-\\)stability). 9.2 Exercise To make sure you can work with stability, consider the following model that Carlos and I are studying. We consider a simple variation on the LV predator-prey system, in which predators are divided into two classes, linked by reproduction (e.g., males and females), and each class has a different mortality rate: \\[ \\begin{cases} \\dfrac{d x(t)}{d t} = x(t) \\left(r - a \\left(y^{(1)}(t) + y^{(2)}(t) \\right) )\\right)\\\\ \\dfrac{d y^{(1)}(t)}{d t} = -d^{(1)}y^{(1)}(t) + \\dfrac{e a x(t)}{2}\\left(y^{(1)}(t) + y^{(2)}(t) \\right) \\\\ \\dfrac{d y^{(2)}(t)}{d t} = -d^{(2)}y^{(2)}(t) + \\dfrac{e a x(t)}{2}\\left(y^{(1)}(t) + y^{(2)}(t) \\right) \\end{cases}\\quad. \\] where we take \\(d^{(1)} = d (1 + \\epsilon)\\) and \\(d^{(2)} = d (1 - \\epsilon)\\), with \\(|\\epsilon| &lt; 1\\) to ensure that predators cannot grow by themselves. Each class of predators has its own mortality, but the reproduction term is pooled and divided equally. The analysis of the model is simplified by considering the variables \\(y(t) = y^{(1)}(t) + y^{(2)}(t)\\) (i.e., the total density for the predator), and \\(z(t) = y^{(2)}(t) - y^{(1)}(t)\\) (i.e., the difference between the densities of the predator classes), yielding: \\[ \\begin{cases} \\dfrac{d x(t)}{d t} = x(t) \\left(r - a y(t))\\right)\\\\ \\dfrac{d y(t)}{d t} = y(t) \\left( -d + e a x(t) \\right) + d \\epsilon z(t)\\\\ \\dfrac{d z(t)}{d t} = -d z(t) + d \\epsilon y(t) \\end{cases}\\quad. \\] Find the two equilibria of the system, and perform the stability analysis. We describe our methods in this chapter. "]
]
